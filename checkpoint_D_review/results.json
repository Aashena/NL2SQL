{
  "run_config": {
    "provider": "gemini",
    "model_fast": "gemini-2.5-flash",
    "model_powerful": "gemini-2.5-pro",
    "model_reasoning": "gemini-2.5-flash",
    "cache_enabled": true,
    "n_questions": 33,
    "sampling": "stratified 3-per-DB (1s/1m/1c), random.seed(42)",
    "total_elapsed_seconds": 1891.0670239925385
  },
  "summary": {
    "oracle_upper_bound": 0.6666666666666666,
    "oracle_count": 22,
    "question_count": 33,
    "total_candidates": 363,
    "unique_candidates": 215,
    "duplicate_candidates": 148,
    "gen_stats": {
      "A_reasoning": {
        "total": 132,
        "non_empty": 132,
        "exec_ok": 130,
        "oracle_match": 61
      },
      "B1_standard": {
        "total": 66,
        "non_empty": 66,
        "exec_ok": 60,
        "oracle_match": 29
      },
      "B2_complex": {
        "total": 66,
        "non_empty": 66,
        "exec_ok": 46,
        "oracle_match": 25
      },
      "C_icl": {
        "total": 99,
        "non_empty": 99,
        "exec_ok": 88,
        "oracle_match": 45
      }
    }
  },
  "questions": [
    {
      "question_id": 64,
      "db_id": "california_schools",
      "difficulty": "simple",
      "question": "What is the total number of schools with a mailing city in Hickman belonging to the charter number 00D4?",
      "evidence": "",
      "ground_truth_sql": "SELECT COUNT(*) FROM schools WHERE CharterNum = '00D4' AND MailCity = 'Hickman'",
      "s1_fields": [
        [
          "schools",
          "CDSCode"
        ],
        [
          "schools",
          "CharterNum"
        ],
        [
          "schools",
          "MailCity"
        ]
      ],
      "s2_fields": [
        [
          "frpm",
          "CDSCode"
        ],
        [
          "frpm",
          "Charter School Number"
        ],
        [
          "schools",
          "CDSCode"
        ],
        [
          "schools",
          "CharterNum"
        ],
        [
          "schools",
          "MailCity"
        ],
        [
          "schools",
          "NCESSchool"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(CDSCode) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(CDSCode) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(CDSCode) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(CDSCode) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(CDSCode) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(CDSCode) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(CDSCode) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(*) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(*) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(CDSCode) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(*) FROM table_name WHERE column1 = 'value1' AND column2 = 'value2'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "no such table: table_name",
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 42.63993287086487,
      "matched_cells": [
        {
          "table": "schools",
          "column": "City",
          "value": "Hickman",
          "sim": 1.0
        },
        {
          "table": "schools",
          "column": "AdmLName1",
          "value": "Hickman",
          "sim": 1.0
        },
        {
          "table": "schools",
          "column": "MailCity",
          "value": "Hickman",
          "sim": 1.0
        },
        {
          "table": "schools",
          "column": "School",
          "value": "Hickman Middle",
          "sim": 0.46875
        },
        {
          "table": "frpm",
          "column": "School Name",
          "value": "Hickman Middle",
          "sim": 0.46875
        },
        {
          "table": "frpm",
          "column": "Charter School Number",
          "value": "00D4",
          "sim": 1.0
        },
        {
          "table": "schools",
          "column": "CharterNum",
          "value": "00D4",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "schools",
        "mailing city",
        "charter number"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "schools.MailCity: The user is asking to filter by schools with a mailing city in 'Hickman'.\nschools.CharterNum: The user is asking to filter by schools with the charter number '00D4'.\nschools.MailCity: The user is asking for schools with a mailing city of 'Hickman'.\nfrpm.Charter School Number: The user is asking for schools with the charter number '00D4'.\nschools.NCESSchool: This is a school identifier that can be used to count the number of schools.",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 3
    },
    {
      "question_id": 23,
      "db_id": "california_schools",
      "difficulty": "moderate",
      "question": "List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools.",
      "evidence": "Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`",
      "ground_truth_sql": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30",
      "s1_fields": [
        [
          "frpm",
          "CDSCode"
        ],
        [
          "frpm",
          "Enrollment (Ages 5-17)"
        ],
        [
          "frpm",
          "Enrollment (K-12)"
        ],
        [
          "frpm",
          "School Name"
        ],
        [
          "schools",
          "CDSCode"
        ],
        [
          "schools",
          "Street"
        ]
      ],
      "s2_fields": [
        [
          "frpm",
          "CDSCode"
        ],
        [
          "frpm",
          "Enrollment (Ages 5-17)"
        ],
        [
          "frpm",
          "Enrollment (K-12)"
        ],
        [
          "frpm",
          "Free Meal Count (Ages 5-17)"
        ],
        [
          "frpm",
          "Free Meal Count (K-12)"
        ],
        [
          "frpm",
          "School Name"
        ],
        [
          "schools",
          "CDSCode"
        ],
        [
          "schools",
          "City"
        ],
        [
          "schools",
          "School"
        ],
        [
          "schools",
          "Street"
        ],
        [
          "schools",
          "Zip"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.\"School Name\", T2.Street FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE ABS(T1.\"Enrollment (K-12)\" - T1.\"Enrollment (Ages 5-17)\") > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.\"School Name\", T2.Street FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE ABS(T1.\"Enrollment (K-12)\" - T1.\"Enrollment (Ages 5-17)\") > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.\"School Name\", T2.Street FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE ABS(T1.\"Enrollment (K-12)\" - T1.\"Enrollment (Ages 5-17)\") > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE ABS(T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\") > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.`School Name`, T2.Street FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE ( T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)` ) > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.\"School Name\", T2.Street FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE ABS(T1.\"Enrollment (K-12)\" - T1.\"Enrollment (Ages 5-17)\") > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH SchoolEnrollmentDiff AS ( SELECT \"School Name\", CDSCode, (\"Enrollment (K-12)\" - \"Enrollment (Ages 5-17)\") AS EnrollmentDifference FROM frpm ) SELECT T1.\"School Name\", T2.Street FROM SchoolEnrollmentDiff AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.EnrollmentDifference > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH EnrollmentDifferences AS ( SELECT CDSCode, \"School Name\", (\"Enrollment (K-12)\" - \"Enrollment (Ages 5-17)\") AS EnrollmentDiff FROM frpm ) SELECT T1.\"School Name\", T2.Street FROM EnrollmentDifferences AS T1 JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.EnrollmentDiff > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.School, T2.Street FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE ABS( T1.\"Enrollment (K-12)\" - T1.\"Enrollment (Ages 5-17)\" ) > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.School, T2.Street FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE abs(T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.School, T2.Street FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE ABS(T1.\"Enrollment (K-12)\" - T1.\"Enrollment (Ages 5-17)\") > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 33.51644015312195,
      "matched_cells": [
        {
          "table": "frpm",
          "column": "County Code",
          "value": "30",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "names of schools",
        "full street adress",
        "Enrollment (K-12)",
        "Enrollment (Ages 5-17)"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "frpm.School Name: To retrieve the names of the schools that meet the specified enrollment difference criteria.\nfrpm.Enrollment (K-12): To calculate the difference in enrollment numbers, as required by the question.\nfrpm.Enrollment (Ages 5-17): To calculate the difference in enrollment numbers, as required by the question.\nschools.Street: To provide the full street address for each qualifying school, as requested.\nschools.School: The user is asking for the names of the schools.\nfrpm.Free Meal Cou",
      "gt_executed_ok": true,
      "gt_row_count": 1239,
      "oracle_match": true,
      "unique_sql_count": 8
    },
    {
      "question_id": 28,
      "db_id": "california_schools",
      "difficulty": "challenging",
      "question": "Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average.",
      "evidence": "Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`",
      "ground_truth_sql": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')",
      "s1_fields": [
        [
          "frpm",
          "CDSCode"
        ],
        [
          "frpm",
          "Enrollment (Ages 5-17)"
        ],
        [
          "frpm",
          "Enrollment (K-12)"
        ],
        [
          "schools",
          "CDSCode"
        ],
        [
          "schools",
          "FundingType"
        ],
        [
          "schools",
          "SOCType"
        ],
        [
          "schools",
          "School"
        ]
      ],
      "s2_fields": [
        [
          "frpm",
          "CDSCode"
        ],
        [
          "frpm",
          "Charter Funding Type"
        ],
        [
          "frpm",
          "Educational Option Type"
        ],
        [
          "frpm",
          "Enrollment (Ages 5-17)"
        ],
        [
          "frpm",
          "Enrollment (K-12)"
        ],
        [
          "frpm",
          "FRPM Count (Ages 5-17)"
        ],
        [
          "frpm",
          "FRPM Count (K-12)"
        ],
        [
          "frpm",
          "School Name"
        ],
        [
          "schools",
          "CDSCode"
        ],
        [
          "schools",
          "FundingType"
        ],
        [
          "schools",
          "SOCType"
        ],
        [
          "schools",
          "School"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT S.School, S.SOCType FROM schools AS S JOIN frpm AS F ON S.CDSCode = F.CDSCode WHERE S.FundingType = 'Locally funded' AND (F.\"Enrollment (K-12)\" - F.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(F2.\"Enrollment (K-12)\" - F2.\"Enrollment (Ages 5-17)\") FROM schools AS S2 JOIN frpm AS F2 ON S2.CDSCode = F2.CDSCode WHERE S2.FundingType = 'Locally funded' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 57,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.School, T1.SOCType FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Locally funded' AND ( T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\" ) > ( SELECT AVG(T4.\"Enrollment (K-12)\" - T4.\"Enrollment (Ages 5-17)\") FROM schools AS T3 INNER JOIN frpm AS T4 ON T3.CDSCode = T4.CDSCode WHERE T3.FundingType = 'Locally funded' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 57,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T2.School, T2.SOCType FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.\"Enrollment (K-12)\" - T1.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(T1_inner.\"Enrollment (K-12)\" - T1_inner.\"Enrollment (Ages 5-17)\") FROM frpm AS T1_inner INNER JOIN schools AS T2_inner ON T1_inner.CDSCode = T2_inner.CDSCode WHERE T2_inner.FundingType = 'Locally funded' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 57,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.\"School Name\", T2.SOCType FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND ( T1.\"Enrollment (K-12)\" - T1.\"Enrollment (Ages 5-17)\" ) > ( SELECT AVG(T3.\"Enrollment (K-12)\" - T3.\"Enrollment (Ages 5-17)\") FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 57,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT s.School, s.SOCType FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE s.FundingType = 'Locally funded' AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(f_sub.\"Enrollment (K-12)\" - f_sub.\"Enrollment (Ages 5-17)\") FROM schools AS s_sub JOIN frpm AS f_sub ON s_sub.CDSCode = f_sub.CDSCode WHERE s_sub.FundingType = 'Locally funded' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 57,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH LocallyFundedDifferences AS ( SELECT T1.CDSCode, T1.\"School Name\", T2.SOCType, (T1.\"Enrollment (K-12)\" - T1.\"Enrollment (Ages 5-17)\") AS K12_5_17_Difference FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.\"Charter Funding Type\" = 'Locally funded' ), AverageDifference AS ( SELECT AVG(K12_5_17_Difference) AS AvgDiff FROM LocallyFundedDifferences ) SELECT T1.\"School Name\", T1.SOCType FROM LocallyFundedDifferences AS T1, AverageDifference AS T2 WHERE T1.K12_5_17_Difference > T2.AvgDiff",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 49,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH LocallyFundedAvgDiff AS ( -- First, calculate the average difference in enrollment for all 'Locally funded' schools. SELECT AVG(T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\") AS avg_diff FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Locally funded' ) -- Then, select schools where their enrollment difference exceeds this calculated average. SELECT T1.School, T1.SOCType FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE (T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\") > ( SELECT avg_diff FROM LocallyFundedAvgDiff )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH LocallyFundedAverage AS ( SELECT AVG(T1.\"Enrollment (K-12)\" - T1.\"Enrollment (Ages 5-17)\") AS avg_enrollment_diff FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' ) SELECT T2.School, T2.SOCType FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE ( T1.\"Enrollment (K-12)\" - T1.\"Enrollment (Ages 5-17)\" ) > ( SELECT avg_enrollment_diff FROM LocallyFundedAverage )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2541,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.School, T2.SOCType FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)` > (SELECT avg(T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 57,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.\"School Name\", T2.SOCType FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.\"Enrollment (K-12)\" - T1.\"Enrollment (Ages 5-17)\" > ( SELECT AVG(\"Enrollment (K-12)\" - \"Enrollment (Ages 5-17)\") FROM frpm WHERE \"Charter Funding Type\" = 'Locally funded' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2313,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT column_1, column_2 FROM some_table WHERE value_to_compare > ( SELECT AGGREGATE_FUNCTION(value_to_compare) FROM some_table WHERE -- Condition to define the subset for the aggregate calculation subset_condition )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 49.15304112434387,
      "matched_cells": [],
      "schema_hints": [],
      "few_shot_count": 8,
      "selection_reasoning": "frpm.Enrollment (K-12): To compute the difference between K-12 enrollment and 5-17 enrollment.\nfrpm.Enrollment (Ages 5-17): To compute the difference between K-12 enrollment and 5-17 enrollment.\nschools.FundingType: To filter for schools that are locally funded.\nschools.School: To list the names of the schools that meet the criteria.\nschools.SOCType: To list the 'DOC type' of the schools.\nfrpm.FRPM Count (K-12): To compute the difference between K-12 and 5-17 enrollment.\nfrpm.FRPM Count (Ages 5-",
      "gt_executed_ok": true,
      "gt_row_count": 57,
      "oracle_match": false,
      "unique_sql_count": 11
    },
    {
      "question_id": 463,
      "db_id": "card_games",
      "difficulty": "simple",
      "question": "How many translations are there for the set of cards with \"Angel of Mercy\" in it?",
      "evidence": "set of cards with \"Angel of Mercy\" in it refers to name = 'Angel of Mercy'",
      "ground_truth_sql": "SELECT COUNT(DISTINCT translation) FROM set_translations WHERE setCode IN ( SELECT setCode FROM cards WHERE name = 'Angel of Mercy' ) AND translation IS NOT NULL",
      "s1_fields": [
        [
          "cards",
          "asciiName"
        ],
        [
          "cards",
          "id"
        ],
        [
          "cards",
          "setCode"
        ],
        [
          "set_translations",
          "id"
        ],
        [
          "set_translations",
          "setCode"
        ],
        [
          "set_translations",
          "translation"
        ]
      ],
      "s2_fields": [
        [
          "cards",
          "asciiName"
        ],
        [
          "cards",
          "id"
        ],
        [
          "cards",
          "name"
        ],
        [
          "cards",
          "setCode"
        ],
        [
          "foreign_data",
          "id"
        ],
        [
          "foreign_data",
          "language"
        ],
        [
          "foreign_data",
          "name"
        ],
        [
          "foreign_data",
          "uuid"
        ],
        [
          "set_translations",
          "id"
        ],
        [
          "set_translations",
          "language"
        ],
        [
          "set_translations",
          "setCode"
        ],
        [
          "set_translations",
          "translation"
        ],
        [
          "sets",
          "code"
        ],
        [
          "sets",
          "id"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T2.translation) FROM cards AS T1 INNER JOIN set_translations AS T2 ON T1.setCode = T2.setCode WHERE T1.asciiName = 'Angel of Mercy'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T2.translation) FROM cards AS T1 INNER JOIN set_translations AS T2 ON T1.setCode = T2.setCode WHERE T1.asciiName = 'Angel of Mercy'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T2.translation) FROM cards AS T1 INNER JOIN set_translations AS T2 ON T1.setCode = T2.setCode WHERE T1.name = 'Angel of Mercy'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T2.translation) FROM cards AS T1 INNER JOIN set_translations AS T2 ON T1.setCode = T2.setCode WHERE T1.name = 'Angel of Mercy'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.id) FROM set_translations AS T1 INNER JOIN cards AS T2 ON T1.setCode = T2.setCode WHERE T2.asciiName = 'Angel of Mercy'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T2.translation) FROM cards AS T1 INNER JOIN set_translations AS T2 ON T1.setCode = T2.setCode WHERE T1.name = 'Angel of Mercy'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH AngelSets AS ( SELECT DISTINCT setCode FROM cards WHERE asciiName = 'Angel of Mercy' ) SELECT COUNT(T2.id) FROM AngelSets AS T1 INNER JOIN set_translations AS T2 ON T1.setCode = T2.setCode",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH AngelCardSets AS ( SELECT DISTINCT setCode FROM cards WHERE name = 'Angel of Mercy' ) SELECT COUNT(T1.id) FROM set_translations AS T1 INNER JOIN AngelCardSets AS T2 ON T1.setCode = T2.setCode",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T2.id) FROM cards AS T1 INNER JOIN set_translations AS T2 ON T1.setCode = T2.setCode WHERE T1.name = 'Angel of Mercy'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(*) FROM set_translations AS T1 JOIN cards AS T2 ON T1.setCode = T2.setCode WHERE T2.name = 'Angel of Mercy'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.id) FROM set_translations AS T1 INNER JOIN cards AS T2 ON T1.setCode = T2.setCode WHERE T2.name = 'Angel of Mercy'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 46.30809497833252,
      "matched_cells": [
        {
          "table": "cards",
          "column": "name",
          "value": "Angel of Mercy",
          "sim": 1.0
        },
        {
          "table": "cards",
          "column": "subtypes",
          "value": "Angel",
          "sim": 1.0
        },
        {
          "table": "cards",
          "column": "keywords",
          "value": "Changeling",
          "sim": 0.4140625
        }
      ],
      "schema_hints": [
        "translations"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "cards.asciiName: To identify the card 'Angel of Mercy'.\ncards.setCode: To find the set that the card 'Angel of Mercy' belongs to.\nset_translations.translation: To count the number of translations for the set.\nset_translations.setCode: To link the set of the card to its translations.\ncards.name: To filter the cards to only include those named 'Angel of Mercy'.\nsets.code: To identify the specific set that the card 'Angel of Mercy' belongs to.\nset_translations.language: To count the number of langu",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": false,
      "unique_sql_count": 8
    },
    {
      "question_id": 427,
      "db_id": "card_games",
      "difficulty": "moderate",
      "question": "What languages are available in the set known as Archenemy on the magic card market and having the code ARC?",
      "evidence": "known as Archenemy refers to mcmName = 'Archenemy'; having the code ARC refers to setCode = 'ARC'",
      "ground_truth_sql": "SELECT T2.language FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.mcmName = 'Archenemy' AND T2.setCode = 'ARC'",
      "s1_fields": [
        [
          "set_translations",
          "id"
        ],
        [
          "set_translations",
          "language"
        ],
        [
          "set_translations",
          "setCode"
        ],
        [
          "sets",
          "code"
        ],
        [
          "sets",
          "id"
        ],
        [
          "sets",
          "mcmName"
        ]
      ],
      "s2_fields": [
        [
          "set_translations",
          "id"
        ],
        [
          "set_translations",
          "language"
        ],
        [
          "set_translations",
          "setCode"
        ],
        [
          "sets",
          "code"
        ],
        [
          "sets",
          "id"
        ],
        [
          "sets",
          "mcmName"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.language FROM set_translations AS T1 INNER JOIN sets AS T2 ON T1.setCode = T2.code WHERE T2.mcmName = 'Archenemy' AND T2.code = 'ARC'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T2.language FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.mcmName = 'Archenemy' AND T1.code = 'ARC'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T2.language FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.mcmName = 'Archenemy' AND T1.code = 'ARC'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T2.language FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.mcmName = 'Archenemy' AND T1.code = 'ARC'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T1.language FROM set_translations AS T1 INNER JOIN sets AS T2 ON T1.setCode = T2.code WHERE T2.mcmName = 'Archenemy' AND T2.code = 'ARC'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.language FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.mcmName = 'Archenemy' AND T1.code = 'ARC'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH TargetSet AS ( SELECT code FROM sets WHERE mcmName = 'Archenemy' AND code = 'ARC' ) SELECT T1.language FROM set_translations AS T1 JOIN TargetSet AS T2 ON T1.setCode = T2.code",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT language FROM set_translations WHERE setCode IN ( SELECT code FROM sets WHERE mcmName = 'Archenemy' AND code = 'ARC' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.language FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.mcmName = 'Archenemy' AND T1.code = 'ARC'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.language FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.mcmName = 'Archenemy' AND T1.code = 'ARC'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.desired_column FROM table_with_desired_column AS T1 INNER JOIN table_with_filter_conditions AS T2 ON T1.foreign_key = T2.primary_key WHERE T2.condition_column1 = 'value1' AND T2.condition_column2 = 'value2'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "no such table: table_with_desired_column",
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 50.66390514373779,
      "matched_cells": [
        {
          "table": "set_translations",
          "column": "translation",
          "value": "Archenemy",
          "sim": 1.0
        },
        {
          "table": "sets",
          "column": "name",
          "value": "Archenemy",
          "sim": 1.0
        },
        {
          "table": "sets",
          "column": "type",
          "value": "archenemy",
          "sim": 1.0
        },
        {
          "table": "sets",
          "column": "mcmName",
          "value": "Archenemy",
          "sim": 1.0
        },
        {
          "table": "set_translations",
          "column": "setCode",
          "value": "ARC",
          "sim": 1.0
        },
        {
          "table": "cards",
          "column": "setCode",
          "value": "ARC",
          "sim": 1.0
        },
        {
          "table": "sets",
          "column": "code",
          "value": "ARC",
          "sim": 1.0
        },
        {
          "table": "sets",
          "column": "parentCode",
          "value": "ARC",
          "sim": 1.0
        },
        {
          "table": "sets",
          "column": "keyruneCode",
          "value": "ARC",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "mcmName",
        "setCode",
        "languages"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "sets.mcmName: To filter for sets named 'Archenemy' on the Magic Card Market.\nsets.code: To filter for the set with the code 'ARC' and to join with the set_translations table.\nset_translations.setCode: To join with the sets table on the set code 'ARC'.\nset_translations.language: To retrieve the available languages for the specified set.",
      "gt_executed_ok": true,
      "gt_row_count": 10,
      "oracle_match": true,
      "unique_sql_count": 7
    },
    {
      "question_id": 431,
      "db_id": "card_games",
      "difficulty": "challenging",
      "question": "Which set is not available outside of the United States and has foil cards with Japanese writing on them? Please include the set ID in your response.",
      "evidence": "available outside of the United States refers to isForeignOnly = 1; has foil cards refers to isFoilOnly = 1; with Japanese writing on them refers to language = 'Japanese'",
      "ground_truth_sql": "SELECT T1.name, T1.id FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T2.language = 'Japanese' AND T1.isFoilOnly = 1 AND T1.isForeignOnly = 0",
      "s1_fields": [
        [
          "set_translations",
          "id"
        ],
        [
          "set_translations",
          "language"
        ],
        [
          "set_translations",
          "setCode"
        ],
        [
          "sets",
          "code"
        ],
        [
          "sets",
          "id"
        ],
        [
          "sets",
          "isFoilOnly"
        ],
        [
          "sets",
          "isForeignOnly"
        ],
        [
          "sets",
          "name"
        ]
      ],
      "s2_fields": [
        [
          "cards",
          "hasFoil"
        ],
        [
          "cards",
          "id"
        ],
        [
          "cards",
          "setCode"
        ],
        [
          "foreign_data",
          "id"
        ],
        [
          "foreign_data",
          "language"
        ],
        [
          "foreign_data",
          "uuid"
        ],
        [
          "set_translations",
          "id"
        ],
        [
          "set_translations",
          "language"
        ],
        [
          "set_translations",
          "setCode"
        ],
        [
          "sets",
          "code"
        ],
        [
          "sets",
          "id"
        ],
        [
          "sets",
          "isFoilOnly"
        ],
        [
          "sets",
          "isForeignOnly"
        ],
        [
          "sets",
          "name"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.id FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.isForeignOnly = 0 AND T1.isFoilOnly = 1 AND T2.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T1.id, T1.name FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.isForeignOnly = 1 AND T1.isFoilOnly = 1 AND T2.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.id FROM sets AS T1 INNER JOIN cards AS T2 ON T1.code = T2.setCode INNER JOIN foreign_data AS T3 ON T2.uuid = T3.uuid WHERE T1.isForeignOnly = 0 AND T2.hasFoil = 1 AND T3.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 22863,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T1.id FROM sets AS T1 INNER JOIN cards AS T2 ON T1.code = T2.setCode INNER JOIN foreign_data AS T3 ON T2.uuid = T3.uuid WHERE T1.isForeignOnly = 1 AND T1.isFoilOnly = 1 AND T3.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.id FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.isForeignOnly = 1 AND T1.isFoilOnly = 1 AND T2.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.id FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.isForeignOnly = 0 AND T1.isFoilOnly = 1 AND T2.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.id FROM sets AS T1 WHERE T1.isForeignOnly = 0 AND T1.isFoilOnly = 1 AND T1.code IN ( SELECT setCode FROM set_translations WHERE language = 'Japanese' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH JapaneseTranslatedSets AS ( -- Identify sets that have a Japanese translation, which indicates Japanese writing SELECT setCode FROM set_translations WHERE language = 'Japanese' ) SELECT s.id, s.name FROM sets AS s JOIN JapaneseTranslatedSets AS jts ON s.code = jts.setCode WHERE -- Filter for sets that are not foreign-only (i.e., available in the US) s.isForeignOnly = 0 -- And are exclusively composed of foil cards AND s.isFoilOnly = 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.id FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.isFoilOnly = 1 AND T1.isForeignOnly = 0 AND T2.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.id FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.isForeignOnly = 0 AND T1.isFoilOnly = 1 AND T2.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.id FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.isForeignOnly = 0 AND T1.isFoilOnly = 1 AND T2.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 56.91085696220398,
      "matched_cells": [
        {
          "table": "cards",
          "column": "life",
          "value": "1",
          "sim": 1.0
        },
        {
          "table": "cards",
          "column": "multiverseId",
          "value": "1",
          "sim": 1.0
        },
        {
          "table": "cards",
          "column": "number",
          "value": "1",
          "sim": 1.0
        },
        {
          "table": "cards",
          "column": "toughness",
          "value": "1",
          "sim": 1.0
        },
        {
          "table": "cards",
          "column": "power",
          "value": "1",
          "sim": 1.0
        },
        {
          "table": "set_translations",
          "column": "language",
          "value": "Japanese",
          "sim": 1.0
        },
        {
          "table": "foreign_data",
          "column": "language",
          "value": "Japanese",
          "sim": 1.0
        },
        {
          "table": "cards",
          "column": "flavorText",
          "value": "Japan",
          "sim": 0.578125
        },
        {
          "table": "cards",
          "column": "watermark",
          "value": "japanjunior",
          "sim": 0.3046875
        },
        {
          "table": "cards",
          "column": "artist",
          "value": "Cristi Balanescu",
          "sim": 0.078125
        }
      ],
      "schema_hints": [
        "isForeignOnly",
        "isFoilOnly",
        "language",
        "set ID"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "sets.isForeignOnly: To identify sets that are not available outside of the United States.\nsets.isFoilOnly: To identify sets that contain only foil cards.\nset_translations.language: To filter for sets that have Japanese writing.\nsets.id: The user explicitly requested the set ID in the response.\nsets.name: To identify the name of the set that meets the criteria.\nsets.code: To link the sets table with the set_translations table.\nset_translations.setCode: To link the set_translations table with the ",
      "gt_executed_ok": true,
      "gt_row_count": 10,
      "oracle_match": false,
      "unique_sql_count": 8
    },
    {
      "question_id": 601,
      "db_id": "codebase_community",
      "difficulty": "simple",
      "question": "What is the score and the link type ID for post ID 395?",
      "evidence": "",
      "ground_truth_sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 INNER JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T2.PostId = 395",
      "s1_fields": [
        [
          "postLinks",
          "Id"
        ],
        [
          "postLinks",
          "LinkTypeId"
        ],
        [
          "postLinks",
          "PostId"
        ],
        [
          "postLinks",
          "RelatedPostId"
        ],
        [
          "posts",
          "Id"
        ],
        [
          "posts",
          "LastEditorUserId"
        ],
        [
          "posts",
          "OwnerUserId"
        ],
        [
          "posts",
          "ParentId"
        ],
        [
          "posts",
          "Score"
        ]
      ],
      "s2_fields": [
        [
          "comments",
          "Id"
        ],
        [
          "comments",
          "PostId"
        ],
        [
          "comments",
          "Score"
        ],
        [
          "postHistory",
          "Id"
        ],
        [
          "postHistory",
          "PostHistoryTypeId"
        ],
        [
          "postHistory",
          "PostId"
        ],
        [
          "postHistory",
          "UserId"
        ],
        [
          "postLinks",
          "Id"
        ],
        [
          "postLinks",
          "LinkTypeId"
        ],
        [
          "postLinks",
          "PostId"
        ],
        [
          "postLinks",
          "RelatedPostId"
        ],
        [
          "posts",
          "Id"
        ],
        [
          "posts",
          "LastEditorUserId"
        ],
        [
          "posts",
          "OwnerUserId"
        ],
        [
          "posts",
          "ParentId"
        ],
        [
          "posts",
          "Score"
        ],
        [
          "votes",
          "Id"
        ],
        [
          "votes",
          "PostId"
        ],
        [
          "votes",
          "UserId"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 INNER JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT p.Score, pl.LinkTypeId FROM posts AS p LEFT JOIN postLinks AS pl ON p.Id = pl.PostId WHERE p.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 LEFT JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 INNER JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 LEFT JOIN postLinks AS T2 ON T1.Id = T2.PostId OR T1.Id = T2.RelatedPostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 LEFT JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 INNER JOIN postLinks AS T2 ON T1.Id = T2.PostId OR T1.Id = T2.RelatedPostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT p.Score, pl.LinkTypeId FROM posts AS p JOIN postLinks AS pl ON p.Id = pl.PostId WHERE p.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 INNER JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 INNER JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 59.82052779197693,
      "matched_cells": [
        {
          "table": "postHistory",
          "column": "Comment",
          "value": "395",
          "sim": 1.0
        },
        {
          "table": "users",
          "column": "DisplayName",
          "value": "user239501",
          "sim": 0.171875
        },
        {
          "table": "postHistory",
          "column": "UserDisplayName",
          "value": "user3959",
          "sim": 0.15625
        },
        {
          "table": "posts",
          "column": "OwnerDisplayName",
          "value": "user3959",
          "sim": 0.15625
        }
      ],
      "schema_hints": [
        "score",
        "link type ID",
        "post ID"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "postLinks.PostId: To filter by the post ID mentioned in the question.\npostLinks.LinkTypeId: To get the link type ID as requested by the user.\nposts.Score: To find the score of the post, which is part of the user's question.\nposts.Id: To identify the post by its ID to retrieve its score.\nvotes.PostId: To filter the votes for the specific post ID 395.\nvotes.VoteTypeId: This could be the 'link type ID' the user is asking for, and it's necessary to calculate the post's score.\ncomments.PostId: To ide",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 7
    },
    {
      "question_id": 571,
      "db_id": "codebase_community",
      "difficulty": "moderate",
      "question": "For the user No.24, how many times is the number of his/her posts compared to his/her votes?",
      "evidence": "user no. 24 refers to UserId = OwnerUserId = '24'; times of his/her post than votes = Divide (Count(post.Id), Count(votes.Id))",
      "ground_truth_sql": "SELECT CAST(COUNT(T2.Id) AS REAL) / COUNT(DISTINCT T1.Id) FROM votes AS T1 INNER JOIN posts AS T2 ON T1.UserId = T2.OwnerUserId WHERE T1.UserId = 24",
      "s1_fields": [
        [
          "posts",
          "Id"
        ],
        [
          "posts",
          "LastEditorUserId"
        ],
        [
          "posts",
          "OwnerUserId"
        ],
        [
          "posts",
          "ParentId"
        ],
        [
          "votes",
          "Id"
        ],
        [
          "votes",
          "PostId"
        ],
        [
          "votes",
          "UserId"
        ]
      ],
      "s2_fields": [
        [
          "postHistory",
          "Id"
        ],
        [
          "postHistory",
          "PostId"
        ],
        [
          "postHistory",
          "UserId"
        ],
        [
          "posts",
          "Id"
        ],
        [
          "posts",
          "LastEditorUserId"
        ],
        [
          "posts",
          "OwnerUserId"
        ],
        [
          "posts",
          "ParentId"
        ],
        [
          "users",
          "Id"
        ],
        [
          "votes",
          "CreationDate"
        ],
        [
          "votes",
          "Id"
        ],
        [
          "votes",
          "PostId"
        ],
        [
          "votes",
          "UserId"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT CAST(COUNT(DISTINCT T1.Id) AS REAL) / COUNT(DISTINCT T2.Id) FROM posts AS T1 INNER JOIN votes AS T2 ON T1.OwnerUserId = T2.UserId WHERE T1.OwnerUserId = 24",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT CAST(COUNT(T1.Id) AS REAL) / COUNT(T2.Id) FROM posts AS T1 INNER JOIN votes AS T2 ON T1.OwnerUserId = T2.UserId WHERE T1.OwnerUserId = 24",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT CAST(COUNT(DISTINCT T1.Id) AS REAL) / COUNT(DISTINCT T2.Id) FROM posts AS T1 INNER JOIN votes AS T2 ON T1.OwnerUserId = T2.UserId WHERE T1.OwnerUserId = 24",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT CAST( ( SELECT COUNT(Id) FROM posts WHERE OwnerUserId = 24 ) AS REAL ) / CAST( ( SELECT COUNT(Id) FROM votes WHERE UserId = 24 ) AS REAL )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT CAST(COUNT(DISTINCT T1.Id) AS REAL) / COUNT(DISTINCT T2.Id) FROM posts AS T1 INNER JOIN votes AS T2 ON T1.OwnerUserId = T2.UserId WHERE T1.OwnerUserId = 24",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT CAST(SUM(CASE WHEN T1.Id IS NOT NULL THEN 1 ELSE 0 END) AS REAL) / SUM(CASE WHEN T2.Id IS NOT NULL THEN 1 ELSE 0 END) FROM posts AS T1 INNER JOIN votes AS T2 ON T1.OwnerUserId = T2.UserId WHERE T1.OwnerUserId = 24",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH PostCount AS ( SELECT COUNT(Id) AS total_posts FROM posts WHERE OwnerUserId = 24 ), VoteCount AS ( SELECT COUNT(Id) AS total_votes FROM votes WHERE UserId = 24 ) SELECT CAST(T1.total_posts AS REAL) / T2.total_votes FROM PostCount AS T1, VoteCount AS T2",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH UserPosts AS ( SELECT CAST(COUNT(Id) AS REAL) AS PostCount FROM posts WHERE OwnerUserId = 24 ), UserVotes AS ( SELECT COUNT(Id) AS VoteCount FROM votes WHERE UserId = 24 ) SELECT T1.PostCount / T2.VoteCount FROM UserPosts AS T1, UserVotes AS T2",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT CAST((SELECT count(*) FROM posts WHERE OwnerUserId = 24) AS REAL) / (SELECT count(*) FROM votes WHERE UserId = 24)",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT CAST(T1.c AS REAL) / T2.c FROM ( SELECT COUNT(*) AS c FROM posts WHERE OwnerUserId = 24 ) AS T1, ( SELECT COUNT(*) AS c FROM votes WHERE UserId = 24 ) AS T2",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT CAST((SELECT count(*) FROM posts WHERE OwnerUserId = 24) AS REAL) / (SELECT count(*) FROM votes WHERE UserId = 24)",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 67.08536314964294,
      "matched_cells": [
        {
          "table": "postHistory",
          "column": "Comment",
          "value": "24",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "UserId",
        "OwnerUserId",
        "post.Id",
        "votes.Id"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "posts.Id: To count the number of posts by the user.\nposts.OwnerUserId: To identify the user who created the post and filter for user '24'.\nvotes.Id: To count the number of votes cast by the user.\nvotes.UserId: To identify the user who cast the vote and filter for user '24'.\nusers.Id: To identify and filter for user No. 24.\npostHistory.UserId: To count the number of posts associated with the user.\nvotes.CreationDate: To count the number of votes cast by the user.",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": false,
      "unique_sql_count": 8
    },
    {
      "question_id": 586,
      "db_id": "codebase_community",
      "difficulty": "challenging",
      "question": "Which user added a bounty amount of 50 to the post title mentioning variance?",
      "evidence": "bounty amount of 50 refers to BountyAmount = 50; user refers to DisplayName; title mentioning variance refers to Title include 'variance'",
      "ground_truth_sql": "SELECT T3.DisplayName, T1.Title FROM posts AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.PostId INNER JOIN users AS T3 ON T3.Id = T2.UserId WHERE T2.BountyAmount = 50 AND T1.Title LIKE '%variance%'",
      "s1_fields": [
        [
          "posts",
          "Id"
        ],
        [
          "posts",
          "LastEditorUserId"
        ],
        [
          "posts",
          "OwnerUserId"
        ],
        [
          "posts",
          "ParentId"
        ],
        [
          "posts",
          "Title"
        ],
        [
          "users",
          "AccountId"
        ],
        [
          "users",
          "DisplayName"
        ],
        [
          "users",
          "Id"
        ],
        [
          "votes",
          "BountyAmount"
        ],
        [
          "votes",
          "Id"
        ],
        [
          "votes",
          "PostId"
        ],
        [
          "votes",
          "UserId"
        ]
      ],
      "s2_fields": [
        [
          "postHistory",
          "Comment"
        ],
        [
          "postHistory",
          "Id"
        ],
        [
          "postHistory",
          "PostId"
        ],
        [
          "postHistory",
          "UserDisplayName"
        ],
        [
          "postHistory",
          "UserId"
        ],
        [
          "posts",
          "Id"
        ],
        [
          "posts",
          "LastEditorUserId"
        ],
        [
          "posts",
          "OwnerUserId"
        ],
        [
          "posts",
          "ParentId"
        ],
        [
          "posts",
          "Tags"
        ],
        [
          "posts",
          "Title"
        ],
        [
          "users",
          "AccountId"
        ],
        [
          "users",
          "DisplayName"
        ],
        [
          "users",
          "Id"
        ],
        [
          "votes",
          "BountyAmount"
        ],
        [
          "votes",
          "Id"
        ],
        [
          "votes",
          "PostId"
        ],
        [
          "votes",
          "UserId"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T3.DisplayName FROM votes AS T1 INNER JOIN posts AS T2 ON T1.PostId = T2.Id INNER JOIN users AS T3 ON T1.UserId = T3.Id WHERE T1.BountyAmount = 50 AND T2.Title LIKE '%variance%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.UserId INNER JOIN posts AS T3 ON T2.PostId = T3.Id WHERE T2.BountyAmount = 50 AND T3.Title LIKE '%variance%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T3.DisplayName FROM votes AS T1 INNER JOIN posts AS T2 ON T1.PostId = T2.Id INNER JOIN users AS T3 ON T1.UserId = T3.Id WHERE T1.BountyAmount = 50 AND T2.Title LIKE '%variance%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T3.DisplayName FROM votes AS T1 INNER JOIN posts AS T2 ON T1.PostId = T2.Id INNER JOIN users AS T3 ON T1.UserId = T3.Id WHERE T1.BountyAmount = 50 AND T2.Title LIKE '%variance%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.UserId INNER JOIN posts AS T3 ON T2.PostId = T3.Id WHERE T2.BountyAmount = 50 AND T3.Title LIKE '%variance%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.UserId INNER JOIN posts AS T3 ON T2.PostId = T3.Id WHERE T2.BountyAmount = 50 AND T3.Title LIKE '%variance%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH PostWithVariance AS ( SELECT Id FROM posts WHERE Title LIKE '%variance%' ), UserWithBounty AS ( SELECT PostId, UserId FROM votes WHERE BountyAmount = 50 ) SELECT T3.DisplayName FROM PostWithVariance AS T1 INNER JOIN UserWithBounty AS T2 ON T1.Id = T2.PostId INNER JOIN users AS T3 ON T2.UserId = T3.Id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH PostWithVariance AS ( SELECT Id FROM posts WHERE Title LIKE '%variance%' ), BountyOnPost AS ( SELECT UserId, PostId FROM votes WHERE BountyAmount = 50 ) SELECT T3.DisplayName FROM PostWithVariance AS T1 INNER JOIN BountyOnPost AS T2 ON T1.Id = T2.PostId INNER JOIN users AS T3 ON T2.UserId = T3.Id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T3.DisplayName FROM posts AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.PostId INNER JOIN users AS T3 ON T2.UserId = T3.Id WHERE T1.Title LIKE '%variance%' AND T2.BountyAmount = 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.UserId INNER JOIN posts AS T3 ON T2.PostId = T3.Id WHERE T2.BountyAmount = 50 AND T3.Title LIKE '%variance%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.UserId INNER JOIN posts AS T3 ON T2.PostId = T3.Id WHERE T2.BountyAmount = 50 AND T3.Title LIKE '%variance%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 40.15298295021057,
      "matched_cells": [
        {
          "table": "badges",
          "column": "Name",
          "value": "variance",
          "sim": 1.0
        },
        {
          "table": "tags",
          "column": "TagName",
          "value": "variance",
          "sim": 1.0
        },
        {
          "table": "postHistory",
          "column": "Comment",
          "value": "variance",
          "sim": 1.0
        },
        {
          "table": "posts",
          "column": "Tags",
          "value": "<variance>",
          "sim": 0.6875
        }
      ],
      "schema_hints": [
        "BountyAmount",
        "DisplayName",
        "Title"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "votes.BountyAmount: To filter for votes with a bounty amount of 50.\nvotes.PostId: To link the vote to the corresponding post.\nvotes.UserId: To identify the user who added the bounty.\nposts.Title: To filter for posts with 'variance' in the title.\nposts.Id: To join with the 'votes' table on PostId.\nusers.DisplayName: To display the name of the user who added the bounty.\nusers.AccountId: To join with the 'votes' table on UserId to identify the user.\npostHistory.UserId: To identify the user who adde",
      "gt_executed_ok": true,
      "gt_row_count": 2,
      "oracle_match": false,
      "unique_sql_count": 6
    },
    {
      "question_id": 1519,
      "db_id": "debit_card_specializing",
      "difficulty": "simple",
      "question": "What was the product id of the transaction happened at 2012/8/23 21:20:00?",
      "evidence": "'2012/8/23 21:20:00' can refer to date = '2012-08-23' AND T1.time = '21:20:00' in the database",
      "ground_truth_sql": "SELECT T1.ProductID FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T1.Date = '2012-08-23' AND T1.Time = '21:20:00'",
      "s1_fields": [
        [
          "transactions_1k",
          "Date"
        ],
        [
          "transactions_1k",
          "ProductID"
        ],
        [
          "transactions_1k",
          "Time"
        ],
        [
          "transactions_1k",
          "TransactionID"
        ]
      ],
      "s2_fields": [
        [
          "products",
          "ProductID"
        ],
        [
          "transactions_1k",
          "Date"
        ],
        [
          "transactions_1k",
          "ProductID"
        ],
        [
          "transactions_1k",
          "Time"
        ],
        [
          "transactions_1k",
          "TransactionID"
        ],
        [
          "yearmonth",
          "CustomerID"
        ],
        [
          "yearmonth",
          "Date"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT column_to_return FROM table_name WHERE condition1 = 'value1' AND condition2 = 'value2'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "no such table: table_name",
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 36.83662390708923,
      "matched_cells": [
        {
          "table": "transactions_1k",
          "column": "Date",
          "value": "2012-08-23",
          "sim": 1.0
        },
        {
          "table": "transactions_1k",
          "column": "Time",
          "value": "21:20:00",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "product id",
        "date",
        "T1.time"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "transactions_1k.ProductID: To identify the product involved in the transaction, which is what the user is asking for.\ntransactions_1k.Date: To filter the transactions based on the specified date '2012/8/23'.\ntransactions_1k.Time: To filter the transactions based on the specified time '21:20:00'.\nproducts.ProductID: The user is asking for the product ID of the transaction.\nyearmonth.Date: To filter the transactions to the specified date '2012/8/23'.",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 2
    },
    {
      "question_id": 1474,
      "db_id": "debit_card_specializing",
      "difficulty": "moderate",
      "question": "Which customers, paying in CZK, consumed the most gas in 2011?",
      "evidence": "Year 2011 can be presented as Between 201101 And 201112, which means between January and December in 2011",
      "ground_truth_sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN 201101 AND 201112 GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) DESC LIMIT 1",
      "s1_fields": [
        [
          "customers",
          "Currency"
        ],
        [
          "customers",
          "CustomerID"
        ],
        [
          "yearmonth",
          "Consumption"
        ],
        [
          "yearmonth",
          "CustomerID"
        ],
        [
          "yearmonth",
          "Date"
        ]
      ],
      "s2_fields": [
        [
          "customers",
          "Currency"
        ],
        [
          "customers",
          "CustomerID"
        ],
        [
          "products",
          "Description"
        ],
        [
          "products",
          "ProductID"
        ],
        [
          "transactions_1k",
          "Amount"
        ],
        [
          "transactions_1k",
          "CustomerID"
        ],
        [
          "transactions_1k",
          "Date"
        ],
        [
          "transactions_1k",
          "ProductID"
        ],
        [
          "transactions_1k",
          "TransactionID"
        ],
        [
          "yearmonth",
          "Consumption"
        ],
        [
          "yearmonth",
          "CustomerID"
        ],
        [
          "yearmonth",
          "Date"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.CustomerID FROM yearmonth AS T1 INNER JOIN customers AS T2 ON T1.CustomerID = T2.CustomerID WHERE T2.Currency = 'CZK' AND T1.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID ORDER BY SUM(T1.Consumption) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID HAVING SUM(T2.Consumption) = ( SELECT MAX(TotalConsumption) FROM ( SELECT SUM(T4.Consumption) AS TotalConsumption FROM customers AS T3 INNER JOIN yearmonth AS T4 ON T3.CustomerID = T4.CustomerID WHERE T3.Currency = 'CZK' AND T4.Date BETWEEN '201101' AND '201112' GROUP BY T3.CustomerID ) AS MaxConsumptionPerCustomer )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH CustomerTotalConsumption AS ( SELECT T1.CustomerID, SUM(T1.Consumption) AS TotalConsumption FROM yearmonth AS T1 INNER JOIN customers AS T2 ON T1.CustomerID = T2.CustomerID WHERE T2.Currency = 'CZK' AND T1.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID ), RankedConsumption AS ( SELECT CustomerID, RANK() OVER (ORDER BY TotalConsumption DESC) AS Rank FROM CustomerTotalConsumption ) SELECT CustomerID FROM RankedConsumption WHERE Rank = 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH CzkCustomers AS ( -- First, select customers who pay in CZK SELECT CustomerID FROM customers WHERE Currency = 'CZK' ), TotalConsumption2011 AS ( -- Next, calculate the total consumption for each customer in the year 2011 SELECT CustomerID, SUM(Consumption) AS TotalConsumption FROM yearmonth WHERE Date BETWEEN '201101' AND '201112' GROUP BY CustomerID ) -- Finally, join the two sets to find the top CZK customers by their 2011 consumption SELECT T1.CustomerID, T2.TotalConsumption FROM CzkCustomers AS T1 JOIN TotalConsumption2011 AS T2 ON T1.CustomerID = T2.CustomerID ORDER BY T2.TotalConsumption DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.CustomerID FROM yearmonth AS T1 INNER JOIN customers AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Date BETWEEN 201101 AND 201112 AND T2.Currency = 'CZK' GROUP BY T1.CustomerID ORDER BY SUM(T1.Consumption) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN 201101 AND 201112 GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 66.96766066551208,
      "matched_cells": [
        {
          "table": "customers",
          "column": "Currency",
          "value": "CZK",
          "sim": 1.0
        },
        {
          "table": "yearmonth",
          "column": "Date",
          "value": "201112",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "customers",
        "gas",
        "paying",
        "consumed"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "yearmonth.CustomerID: To identify and group customers to find out who consumed the most.\nyearmonth.Consumption: To calculate the total gas consumption for each customer.\nyearmonth.Date: To filter the transactions for the year 2011.\ncustomers.CustomerID: Needed to join with the yearmonth table to link customers to their consumption.\ncustomers.Currency: To filter for customers who pay in CZK.\ntransactions_1k.CustomerID: To identify and group transactions by customer to determine which customer con",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 7
    },
    {
      "question_id": 1526,
      "db_id": "debit_card_specializing",
      "difficulty": "challenging",
      "question": "For the customer who paid 634.8 in 2012/8/25, what was the consumption decrease rate from Year 2012 to 2013?",
      "evidence": "'2012/8/24' can be represented by '2012-08-24'; Consumption decrease rate = (consumption_2012 - consumption_2013) / consumption_2012",
      "ground_truth_sql": "SELECT CAST(SUM(IIF(SUBSTR(Date, 1, 4) = '2012', Consumption, 0)) - SUM(IIF(SUBSTR(Date, 1, 4) = '2013', Consumption, 0)) AS FLOAT) / SUM(IIF(SUBSTR(Date, 1, 4) = '2012', Consumption, 0)) FROM yearmonth WHERE CustomerID = ( SELECT T1.CustomerID FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T1.Date = '2012-08-25' AND T1.Price = 634.8 )",
      "s1_fields": [
        [
          "transactions_1k",
          "CustomerID"
        ],
        [
          "transactions_1k",
          "Date"
        ],
        [
          "transactions_1k",
          "Price"
        ],
        [
          "transactions_1k",
          "TransactionID"
        ],
        [
          "yearmonth",
          "Consumption"
        ],
        [
          "yearmonth",
          "CustomerID"
        ],
        [
          "yearmonth",
          "Date"
        ]
      ],
      "s2_fields": [
        [
          "customers",
          "CustomerID"
        ],
        [
          "transactions_1k",
          "Amount"
        ],
        [
          "transactions_1k",
          "CardID"
        ],
        [
          "transactions_1k",
          "CustomerID"
        ],
        [
          "transactions_1k",
          "Date"
        ],
        [
          "transactions_1k",
          "Price"
        ],
        [
          "transactions_1k",
          "Time"
        ],
        [
          "transactions_1k",
          "TransactionID"
        ],
        [
          "yearmonth",
          "Consumption"
        ],
        [
          "yearmonth",
          "CustomerID"
        ],
        [
          "yearmonth",
          "Date"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "WITH TargetCustomer AS ( -- Find the CustomerID for the transaction specified SELECT CustomerID FROM transactions_1k WHERE Price = 634.8 AND Date = '2012-08-25' LIMIT 1 -- Assuming there's only one such customer or we take the first one if multiple exist ) SELECT -- Calculate the consumption decrease rate -- Formula: (consumption_2012 - consumption_2013) / consumption_2012 CAST( (COALESCE(SUM(CASE WHEN SUBSTR(ym.Date, 1, 4) = '2012' THEN ym.Consumption END), 0.0) - COALESCE(SUM(CASE WHEN SUBSTR(ym.Date, 1, 4) = '2013' THEN ym.Consumption END), 0.0)) AS REAL ) / NULLIF(COALESCE(SUM(CASE WHEN SUBSTR(ym.Date, 1, 4) = '2012' THEN ym.Consumption END), 0.0), 0.0) AS decrease_rate FROM yearmonth AS ym WHERE ym.CustomerID = ( SELECT CustomerID FROM TargetCustomer ) AND SUBSTR(ym.Date, 1, 4) IN ('2012', '2013')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "WITH TargetCustomer AS ( -- Step 1: Identify the CustomerID based on transaction details SELECT CustomerID FROM transactions_1k WHERE Price = 634.8 AND Date = '2012-08-25' ), CustomerYearlyConsumption AS ( -- Steps 2 & 3: Calculate total consumption for 2012 and 2013 for the target customer SELECT tc.CustomerID, SUM(CASE WHEN SUBSTR(ym.Date, 1, 4) = '2012' THEN ym.Consumption ELSE 0 END) AS Consumption_2012, SUM(CASE WHEN SUBSTR(ym.Date, 1, 4) = '2013' THEN ym.Consumption ELSE 0 END) AS Consumption_2013 FROM yearmonth AS ym JOIN TargetCustomer AS tc ON ym.CustomerID = tc.CustomerID WHERE SUBSTR(ym.Date, 1, 4) IN ('2012', '2013') GROUP BY tc.CustomerID ) -- Step 4: Calculate the consumption decrease rate SELECT (cyc.Consumption_2012 - cyc.Consumption_2013) * 1.0 / cyc.Consumption_2012 AS ConsumptionDecreaseRate FROM CustomerYearlyConsumption AS cyc WHERE cyc.Consumption_2012 IS NOT NULL AND cyc.Consumption_2012 != 0; -- Ensure consumption_2012 is not zero for a valid rate",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT ( T2.total_2012 - T3.total_2013 ) * 1.0 / T2.total_2012 FROM transactions_1k AS T1 INNER JOIN ( SELECT CustomerID, SUM(Consumption) AS total_2012 FROM yearmonth WHERE STRFTIME('%Y', Date) = '2012' GROUP BY CustomerID ) AS T2 ON T1.CustomerID = T2.CustomerID INNER JOIN ( SELECT CustomerID, SUM(Consumption) AS total_2013 FROM yearmonth WHERE STRFTIME('%Y', Date) = '2013' GROUP BY CustomerID ) AS T3 ON T1.CustomerID = T3.CustomerID WHERE T1.Price = 634.8 AND T1.Date = '2012-08-25'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT (T1.consumption_2012 - T2.consumption_2013) * 1.0 / T1.consumption_2012 FROM ( SELECT SUM(T3.Consumption) AS consumption_2012, T3.CustomerID FROM yearmonth AS T3 WHERE SUBSTR(T3.Date, 1, 4) = '2012' AND T3.CustomerID IN ( SELECT T1.CustomerID FROM transactions_1k AS T1 WHERE T1.Price = 634.8 AND T1.Date = '2012-08-25' ) GROUP BY T3.CustomerID ) AS T1 INNER JOIN ( SELECT SUM(T3.Consumption) AS consumption_2013, T3.CustomerID FROM yearmonth AS T3 WHERE SUBSTR(T3.Date, 1, 4) = '2013' AND T3.CustomerID IN ( SELECT T1.CustomerID FROM transactions_1k AS T1 WHERE T1.Price = 634.8 AND T1.Date = '2012-08-25' ) GROUP BY T3.CustomerID ) AS T2 ON T1.CustomerID = T2.CustomerID",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH CustomerTarget AS ( -- Step 1: Find the CustomerID for the transaction specified SELECT CustomerID FROM transactions_1k WHERE Price = 634.8 AND Date = '2012-08-25' ) SELECT -- Step 2 & 3",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH TargetCustomer AS ( SELECT CustomerID FROM transactions_1k WHERE Price = 634.8 AND Date = '2012-08-25' LIMIT 1 ), CustomerConsumption AS ( SELECT SUM(CASE WHEN SUBSTR(T1.Date, 1, 4) = '2012' THEN T1.Consumption ELSE 0 END) AS consumption_2012, SUM(CASE WHEN SUBSTR(T1.Date, 1, 4) = '2013' THEN T1.Consumption ELSE 0 END) AS consumption_2013 FROM yearmonth",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH Customer AS ( SELECT CustomerID FROM transactions_1k WHERE Price = 634.8 AND Date = '2012-08-25' ), YearlyConsumption AS ( SELECT SUM(CASE WHEN SUBSTR(Date, 1, 4) = '2012' THEN Consumption END) AS consumption_2012, SUM(CASE WHEN SUBSTR(Date, 1, 4) = '2013' THEN Consumption END) AS consumption_2013 FROM yearmonth WHERE CustomerID IN (SELECT CustomerID FROM Customer) ) SELECT (consumption_2012 - consumption_2013) / consumption_2012 FROM YearlyConsumption",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH CustomerInfo AS ( -- Find the CustomerID for the transaction in question SELECT CustomerID FROM transactions_1k WHERE Price = 634.8 AND Date = '2012-08-25' ), AnnualConsumption AS ( -- Calculate the total consumption for the identified customer in 2012 and 2013 SELECT SUM(CASE WHEN SUBSTR(Date, 1, 4) = '2012' THEN Consumption ELSE 0 END) AS consumption_2012, SUM(CASE WHEN SUBSTR(Date, 1, 4) = '2013' THEN Consumption ELSE 0 END) AS consumption_2013 FROM yearmonth WHERE CustomerID IN ( SELECT CustomerID FROM CustomerInfo ) ) -- Apply the formula for consumption decrease rate SELECT ( CAST(consumption_2012 AS REAL) - consumption_2013 ) / consumption_2012 FROM AnnualConsumption",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT (SUM(CASE WHEN SUBSTR(Date, 1, 4) = '2012' THEN Consumption ELSE 0 END) - SUM(CASE WHEN SUBSTR(Date, 1, 4) = '2013' THEN Consumption ELSE 0 END)) * 1.0 / SUM(CASE WHEN SUBSTR(Date, 1, 4) = '2012' THEN Consumption ELSE 0 END) FROM yearmonth WHERE CustomerID = (SELECT CustomerID FROM transactions_1k WHERE Price = 634.8 AND Date = '2012-08-25')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "First, I need to identify the tables and joins required to answer the question. 1. I'll need the `transactions_1k` table to find the `CustomerID` of the person who paid a `Price` of 634.8 on the `Date` '2012-08-25'. 2. Then, I'll use the `yearmonth` table to find the total `Consumption` for that `CustomerID` for the years 2012 and 2013. The `Date` column in this table is in 'YYYYMM' format, so I'll need to extract the year part. 3. I will use a subquery to pass the `CustomerID` from the first step to filter the `yearmonth` table. No explicit join is needed if I use a subquery in the `WHERE` clause. After identifying the necessary data, I can calculate the decrease rate using the formula: `(consumption_2012 - consumption_2013) / consumption_2012`. I will use conditional aggregation (`SUM` with `CASE`) to calculate the total consumption for each year in a single pass. ```sql SELECT (SUM(CASE WHEN SUBSTR(Date, 1, 4) = '2012' THEN Consumption ELSE 0 END) - SUM(CASE WHEN SUBSTR(Date, 1, 4) = '2013' THEN Consumption ELSE 0 END)) * 1.0 / SUM(CASE WHEN SUBSTR(Date, 1, 4) = '",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "near \"First\": syntax error",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "(SELECT EntityID FROM event_table WHERE event_attribute = 'some_value')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "near \"(\": syntax error",
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 60.65567994117737,
      "matched_cells": [],
      "schema_hints": [],
      "few_shot_count": 8,
      "selection_reasoning": "transactions_1k.Price: To identify the customer who made the transaction of 634.8.\ntransactions_1k.Date: To identify the transaction that occurred on 2012/8/25.\ntransactions_1k.CustomerID: To identify the customer who made the transaction.\nyearmonth.Consumption: To calculate the consumption for the years 2012 and 2013.\nyearmonth.Date: To filter the consumption data for the years 2012 and 2013.\nyearmonth.CustomerID: To link the customer from the transaction to their consumption data.\ntransactions",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 11
    },
    {
      "question_id": 1027,
      "db_id": "european_football_2",
      "difficulty": "simple",
      "question": "Indicate the full names of the top 10 players with the highest number of penalties.",
      "evidence": "full name refers to player_name; players with highest number of penalties refers to MAX(penalties);",
      "ground_truth_sql": "SELECT t2.player_name FROM Player_Attributes AS t1 INNER JOIN Player AS t2 ON t1.id = t2.id ORDER BY t1.penalties DESC LIMIT 10",
      "s1_fields": [
        [
          "Player",
          "id"
        ],
        [
          "Player",
          "player_name"
        ],
        [
          "Player_Attributes",
          "id"
        ],
        [
          "Player_Attributes",
          "penalties"
        ],
        [
          "Player_Attributes",
          "player_api_id"
        ],
        [
          "Player_Attributes",
          "player_fifa_api_id"
        ]
      ],
      "s2_fields": [
        [
          "Match",
          "away_player_1"
        ],
        [
          "Match",
          "away_player_10"
        ],
        [
          "Match",
          "away_player_11"
        ],
        [
          "Match",
          "away_player_3"
        ],
        [
          "Match",
          "away_player_5"
        ],
        [
          "Match",
          "away_player_7"
        ],
        [
          "Match",
          "away_player_8"
        ],
        [
          "Match",
          "away_player_9"
        ],
        [
          "Match",
          "home_player_3"
        ],
        [
          "Match",
          "home_player_5"
        ],
        [
          "Player",
          "id"
        ],
        [
          "Player",
          "player_name"
        ],
        [
          "Player_Attributes",
          "id"
        ],
        [
          "Player_Attributes",
          "penalties"
        ],
        [
          "Player_Attributes",
          "player_api_id"
        ],
        [
          "Player_Attributes",
          "player_fifa_api_id"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT P.player_name FROM Player AS P JOIN Player_Attributes AS PA ON P.id = PA.player_api_id ORDER BY PA.penalties DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT P.player_name FROM Player AS P JOIN Player_Attributes AS PA ON P.id = PA.player_api_id ORDER BY PA.penalties DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT P.player_name FROM Player AS P JOIN Player_Attributes AS PA ON P.id = PA.player_api_id ORDER BY PA.penalties DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT P.player_name FROM Player AS P JOIN Player_Attributes AS PA ON P.id = PA.player_api_id ORDER BY PA.penalties DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT P.player_name FROM Player AS P JOIN Player_Attributes AS PA ON P.id = PA.player_api_id ORDER BY PA.penalties DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT P.player_name FROM Player AS P JOIN Player_Attributes AS PA ON P.player_api_id = PA.player_api_id ORDER BY PA.penalties DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH PlayerMaxPenalties AS ( SELECT player_api_id, MAX(penalties) AS max_penalty FROM Player_Attributes GROUP BY player_api_id ) SELECT p.player_name FROM Player AS p JOIN PlayerMaxPenalties AS pmp ON p.id = pmp.player_api_id ORDER BY pmp.max_penalty DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH PlayerMaxPenalties AS ( -- First, find the maximum penalty score for each player, as their attributes can change over time. SELECT player_api_id, MAX(penalties) AS max_penalties FROM Player_Attributes GROUP BY player_api_id ) -- Then, join this aggregated data with the Player table to get the names. SELECT T1.player_name FROM Player AS T1 JOIN PlayerMaxPenalties AS T2 ON T1.id = T2.player_api_id -- Order by the maximum penalty score in descending order to find the top players. ORDER BY T2.max_penalties DESC -- Limit the result to the top 10. LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.player_name FROM Player AS T1 JOIN Player_Attributes AS T2 ON T1.id = T2.player_api_id GROUP BY T1.player_name ORDER BY max(T2.penalties) DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.player_name FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.id = T2.player_api_id GROUP BY T1.player_name ORDER BY MAX(T2.penalties) DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.name_column FROM table_with_metric AS T1 INNER JOIN table_with_name AS T2 ON T1.foreign_key = T2.primary_key GROUP BY T2.name_column -- Or the primary key to group by the entity ORDER BY AGGREGATE_FUNCTION(T1.metric_column) DESC LIMIT N",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "no such table: table_with_metric",
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 40.15986108779907,
      "matched_cells": [],
      "schema_hints": [
        "player_name",
        "penalties"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "Player.player_name: This column is needed to identify and display the full names of the players, as requested by the user.\nPlayer_Attributes.penalties: This column is necessary to determine the players with the highest number of penalties, which is the main ranking criterion for the user's question.\nPlayer.player_fifa_api_id: To identify the players.\nMatch.goal: The XML data in this column may contain information about which players scored penalties.",
      "gt_executed_ok": true,
      "gt_row_count": 10,
      "oracle_match": false,
      "unique_sql_count": 7
    },
    {
      "question_id": 1025,
      "db_id": "european_football_2",
      "difficulty": "moderate",
      "question": "Give the name of the league had the most goals in the 2016 season?",
      "evidence": "league that had the most goals refers to MAX(SUM(home_team_goal, away_team_goal)); 2016 season refers to season = '2015/2016';",
      "ground_truth_sql": "SELECT t2.name FROM Match AS t1 INNER JOIN League AS t2 ON t1.league_id = t2.id WHERE t1.season = '2015/2016' GROUP BY t2.name ORDER BY SUM(t1.home_team_goal + t1.away_team_goal) DESC LIMIT 1",
      "s1_fields": [
        [
          "League",
          "country_id"
        ],
        [
          "League",
          "id"
        ],
        [
          "League",
          "name"
        ],
        [
          "Match",
          "away_player_1"
        ],
        [
          "Match",
          "away_player_10"
        ],
        [
          "Match",
          "away_player_11"
        ],
        [
          "Match",
          "away_player_2"
        ],
        [
          "Match",
          "away_player_3"
        ],
        [
          "Match",
          "away_player_4"
        ],
        [
          "Match",
          "away_player_5"
        ],
        [
          "Match",
          "away_player_6"
        ],
        [
          "Match",
          "away_player_7"
        ],
        [
          "Match",
          "away_player_8"
        ],
        [
          "Match",
          "away_player_9"
        ],
        [
          "Match",
          "away_team_api_id"
        ],
        [
          "Match",
          "away_team_goal"
        ],
        [
          "Match",
          "country_id"
        ],
        [
          "Match",
          "home_player_1"
        ],
        [
          "Match",
          "home_player_10"
        ],
        [
          "Match",
          "home_player_11"
        ],
        [
          "Match",
          "home_player_2"
        ],
        [
          "Match",
          "home_player_3"
        ],
        [
          "Match",
          "home_player_4"
        ],
        [
          "Match",
          "home_player_5"
        ],
        [
          "Match",
          "home_player_6"
        ],
        [
          "Match",
          "home_player_7"
        ],
        [
          "Match",
          "home_player_8"
        ],
        [
          "Match",
          "home_player_9"
        ],
        [
          "Match",
          "home_team_api_id"
        ],
        [
          "Match",
          "home_team_goal"
        ],
        [
          "Match",
          "id"
        ],
        [
          "Match",
          "league_id"
        ],
        [
          "Match",
          "season"
        ]
      ],
      "s2_fields": [
        [
          "League",
          "country_id"
        ],
        [
          "League",
          "id"
        ],
        [
          "League",
          "name"
        ],
        [
          "Match",
          "away_player_1"
        ],
        [
          "Match",
          "away_player_10"
        ],
        [
          "Match",
          "away_player_11"
        ],
        [
          "Match",
          "away_player_2"
        ],
        [
          "Match",
          "away_player_3"
        ],
        [
          "Match",
          "away_player_4"
        ],
        [
          "Match",
          "away_player_5"
        ],
        [
          "Match",
          "away_player_6"
        ],
        [
          "Match",
          "away_player_7"
        ],
        [
          "Match",
          "away_player_8"
        ],
        [
          "Match",
          "away_player_9"
        ],
        [
          "Match",
          "away_team_api_id"
        ],
        [
          "Match",
          "away_team_goal"
        ],
        [
          "Match",
          "country_id"
        ],
        [
          "Match",
          "home_player_1"
        ],
        [
          "Match",
          "home_player_10"
        ],
        [
          "Match",
          "home_player_11"
        ],
        [
          "Match",
          "home_player_2"
        ],
        [
          "Match",
          "home_player_3"
        ],
        [
          "Match",
          "home_player_4"
        ],
        [
          "Match",
          "home_player_5"
        ],
        [
          "Match",
          "home_player_6"
        ],
        [
          "Match",
          "home_player_7"
        ],
        [
          "Match",
          "home_player_8"
        ],
        [
          "Match",
          "home_player_9"
        ],
        [
          "Match",
          "home_team_api_id"
        ],
        [
          "Match",
          "home_team_goal"
        ],
        [
          "Match",
          "id"
        ],
        [
          "Match",
          "league_id"
        ],
        [
          "Match",
          "season"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT L.name FROM Match AS M JOIN League AS L ON M.league_id = L.id WHERE M.season = '2015/2016' GROUP BY L.name ORDER BY SUM(M.home_team_goal + M.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T2.name FROM Match AS T1 INNER JOIN League AS T2 ON T1.league_id = T2.id WHERE T1.season = '2015/2016' GROUP BY T2.name ORDER BY SUM(T1.home_team_goal + T1.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T2.name FROM Match AS T1 INNER JOIN League AS T2 ON T1.league_id = T2.id WHERE T1.season = '2015/2016' GROUP BY T2.name ORDER BY SUM(T1.home_team_goal + T1.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T2.name FROM Match AS T1 INNER JOIN League AS T2 ON T1.league_id = T2.id WHERE T1.season = '2015/2016' GROUP BY T2.name ORDER BY SUM(T1.home_team_goal + T1.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT L.name FROM League AS L JOIN Match AS M ON L.id = M.league_id WHERE M.season = '2015/2016' GROUP BY L.name ORDER BY SUM(M.home_team_goal + M.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT L.name FROM League AS L JOIN Match AS M ON L.id = M.league_id WHERE M.season = '2015/2016' GROUP BY L.name ORDER BY SUM(M.home_team_goal + M.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH SeasonGoals AS ( SELECT league_id, SUM(home_team_goal + away_team_goal) AS total_goals FROM Match WHERE season = '2015/2016' GROUP BY league_id ) SELECT T2.name FROM SeasonGoals AS T1 JOIN League AS T2 ON T1.league_id = T2.id ORDER BY T1.total_goals DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH LeagueTotalGoals AS ( -- First, calculate the sum of goals for each league in the 2015/2016 season. -- COALESCE is used to handle potential NULLs in goal columns, treating them as 0. SELECT league_id, SUM(COALESCE(home_team_goal, 0) + COALESCE(away_team_goal, 0)) AS total_goals FROM Match WHERE season = '2015/2016' GROUP BY league_id ), RankedLeagues AS ( -- Second, use a window function to rank each league by its total goals in descending order. -- Leagues with the same number of goals will receive the same rank. SELECT league_id, RANK() OVER (ORDER BY total_goals DESC) AS ranking FROM LeagueTotalGoals ) -- Finally, select the name of the league(s) with the top rank (rank = 1). SELECT l.name FROM League AS l JOIN RankedLeagues AS rl ON l.id = rl.league_id WHERE rl.ranking = 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.name FROM Match AS T1 INNER JOIN League AS T2 ON T1.league_id = T2.id WHERE T1.season = '2015/2016' GROUP BY T2.name ORDER BY SUM(T1.home_team_goal + T1.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.name FROM Match AS T1 INNER JOIN League AS T2 ON T1.league_id = T2.id WHERE T1.season = '2015/2016' GROUP BY T2.name ORDER BY SUM(T1.home_team_goal + T1.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.name FROM Match AS T1 INNER JOIN League AS T2 ON T1.league_id = T2.id WHERE T1.season = '2015/2016' GROUP BY T2.name ORDER BY SUM(T1.home_team_goal + T1.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 91.63307309150696,
      "matched_cells": [
        {
          "table": "Match",
          "column": "season",
          "value": "2015/2016",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "home_team_goal",
        "away_team_goal",
        "season"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "Match.home_team_goal: To calculate the total number of goals in each match.\nMatch.away_team_goal: To calculate the total number of goals in each match.\nMatch.season: To filter the matches for the '2015/2016' season.\nMatch.league_id: To link matches to their respective leagues.\nLeague.name: To get the name of the league.\nLeague.id: To join with the Match table on league_id.\nMatch.goal: The 'goal' column is essential for calculating the total number of goals scored in each match, which is a primar",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 5
    },
    {
      "question_id": 1031,
      "db_id": "european_football_2",
      "difficulty": "challenging",
      "question": "At present, calculate for the player's age who have a sprint speed of no less than 97 between 2013 to 2015.",
      "evidence": "players age at present = SUBTRACT((DATETIME(), birthday)); sprint speed of no less than 97 refers to sprint_speed > = 97; between 2013 to 2015 refers to YEAR(date) > = '2013' AND YEAR(date) < = '2015'; ",
      "ground_truth_sql": "SELECT DISTINCT DATETIME() - T2.birthday age FROM Player_Attributes AS t1 INNER JOIN Player AS t2 ON t1.player_api_id = t2.player_api_id WHERE STRFTIME('%Y',t1.`date`) >= '2013' AND STRFTIME('%Y',t1.`date`) <= '2015' AND t1.sprint_speed >= 97",
      "s1_fields": [
        [
          "Player",
          "birthday"
        ],
        [
          "Player",
          "id"
        ],
        [
          "Player_Attributes",
          "date"
        ],
        [
          "Player_Attributes",
          "id"
        ],
        [
          "Player_Attributes",
          "player_api_id"
        ],
        [
          "Player_Attributes",
          "player_fifa_api_id"
        ],
        [
          "Player_Attributes",
          "sprint_speed"
        ]
      ],
      "s2_fields": [
        [
          "Player",
          "birthday"
        ],
        [
          "Player",
          "id"
        ],
        [
          "Player_Attributes",
          "acceleration"
        ],
        [
          "Player_Attributes",
          "date"
        ],
        [
          "Player_Attributes",
          "id"
        ],
        [
          "Player_Attributes",
          "player_api_id"
        ],
        [
          "Player_Attributes",
          "player_fifa_api_id"
        ],
        [
          "Player_Attributes",
          "sprint_speed"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT CAST(STRFTIME('%Y', 'now') - STRFTIME('%Y', T2.birthday) AS INTEGER) - (STRFTIME('%m-%d', 'now') < STRFTIME('%m-%d', T2.birthday)) AS current_player_age FROM Player_Attributes AS T1 INNER JOIN Player AS T2 ON T1.player_api_id = T2.id WHERE T1.sprint_speed >= 97 AND STRFTIME('%Y', T1.date) BETWEEN '2013' AND '2015' GROUP BY T2.id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT CAST(STRFTIME('%Y.%m%d', 'now') - STRFTIME('%Y.%m%d', T1.birthday) AS INTEGER) AS player_current_age FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.id = T2.player_api_id WHERE T2.sprint_speed >= 97 AND STRFTIME('%Y', T2.date) BETWEEN '2013' AND '2015'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT CAST(STRFTIME('%Y', 'now') - STRFTIME('%Y', T1.birthday) AS INTEGER) AS player_age FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.player_api_id = T2.player_api_id WHERE T2.sprint_speed >= 97 AND STRFTIME('%Y', T2.date) BETWEEN '2013' AND '2015'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT CAST(STRFTIME('%Y', 'now') - STRFTIME('%Y', T1.birthday) - (STRFTIME('%m%d', 'now') < STRFTIME('%m%d', T1.birthday)) AS INTEGER) AS player_current_age FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.id = T2.player_api_id WHERE T2.sprint_speed >= 97 AND CAST(STRFTIME('%Y', T2.date) AS INTEGER) BETWEEN 2013 AND 2015",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT CAST(STRFTIME('%Y', 'now') AS INTEGER) - CAST(STRFTIME('%Y', T1.birthday) AS INTEGER) - (CAST(STRFTIME('%m%d', 'now') AS INTEGER) < CAST(STRFTIME('%m%d', T1.birthday) AS INTEGER)) AS player_age",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "no such column: T1.birthday",
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT STRFTIME('%Y', 'now') - STRFTIME('%Y', T1.birthday) AS player_age FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.id = T2.player_api_id WHERE T2.sprint_speed >= 97 AND STRFTIME('%Y', T2.date) BETWEEN '2013' AND '2015'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH Fast_Players AS ( SELECT DISTINCT player_api_id FROM Player_Attributes WHERE sprint_speed >= 97 AND STRFTIME('%Y', date) BETWEEN '2013' AND '2015' ) SELECT STRFTIME('%Y', 'now') - STRFTIME('%Y', T2.birthday) AS age FROM Fast_Players AS T1 JOIN Player AS T2 ON T1.player_api_id = T2.id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH Fast_Players AS ( SELECT DISTINCT player_api_id FROM Player_Attributes WHERE sprint_speed >= 97 AND STRFTIME('%Y', date) BETWEEN '2013' AND '2015' ) SELECT CAST(STRFTIME('%Y', 'now') AS INTEGER) - CAST(STRFTIME('%Y', p.birthday) AS INTEGER) AS age FROM Fast_Players AS fp JOIN Player AS p ON fp.player_api_id = p.id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT STRFTIME('%Y', 'now') - STRFTIME('%Y', T2.birthday) FROM Player_Attributes AS T1 INNER JOIN Player AS T2 ON T1.player_api_id = T2.id WHERE T1.sprint_speed >= 97 AND STRFTIME('%Y', T1.date) BETWEEN '2013' AND '2015'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT STRFTIME('%Y', 'now') - STRFTIME('%Y', T2.birthday) FROM Player_Attributes AS T1 INNER JOIN Player AS T2 ON T1.player_api_id = T2.id WHERE T1.sprint_speed >= 97 AND STRFTIME('%Y', T1.date) BETWEEN '2013' AND '2015' GROUP BY T2.id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT STRFTIME('%Y', 'now') - STRFTIME('%Y', T1.birthday) FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.id = T2.player_api_id WHERE T2.sprint_speed >= 97 AND STRFTIME('%Y', T2.date) BETWEEN '2013' AND '2015' GROUP BY T1.id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 73.40938019752502,
      "matched_cells": [
        {
          "table": "Match",
          "column": "season",
          "value": "2012/2013",
          "sim": 0.3359375
        },
        {
          "table": "Match",
          "column": "date",
          "value": "2015-07-25 00:00:00",
          "sim": 0.1953125
        },
        {
          "table": "Player_Attributes",
          "column": "date",
          "value": "2015-06-05 00:00:00",
          "sim": 0.1875
        }
      ],
      "schema_hints": [
        "birthday",
        "sprint_speed",
        "date"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "Player.birthday: To calculate the player's current age.\nPlayer_Attributes.sprint_speed: To filter for players with a sprint speed of no less than 97.\nPlayer_Attributes.date: To filter the player attributes data for the years 2013 to 2015.\nPlayer_Attributes.acceleration: The user is asking for players with a \"sprint speed of no less than 97\". The 'acceleration' column in the 'Player_Attributes' table is the most relevant field to filter for players based on their speed.\nPlayer_Attributes.date: Th",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 11
    },
    {
      "question_id": 109,
      "db_id": "financial",
      "difficulty": "simple",
      "question": "How many clients opened their accounts in Jesenik branch were women?",
      "evidence": "A2 has region names; Woman and female share the same meaning; female refers to gender = 'F'",
      "ground_truth_sql": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'F' AND T2.A2 = 'Jesenik'",
      "s1_fields": [
        [
          "account",
          "account_id"
        ],
        [
          "account",
          "district_id"
        ],
        [
          "client",
          "client_id"
        ],
        [
          "client",
          "district_id"
        ],
        [
          "client",
          "gender"
        ],
        [
          "disp",
          "account_id"
        ],
        [
          "disp",
          "client_id"
        ],
        [
          "disp",
          "disp_id"
        ],
        [
          "district",
          "A2"
        ],
        [
          "district",
          "district_id"
        ]
      ],
      "s2_fields": [
        [
          "account",
          "account_id"
        ],
        [
          "account",
          "district_id"
        ],
        [
          "client",
          "client_id"
        ],
        [
          "client",
          "district_id"
        ],
        [
          "client",
          "gender"
        ],
        [
          "disp",
          "account_id"
        ],
        [
          "disp",
          "client_id"
        ],
        [
          "disp",
          "disp_id"
        ],
        [
          "district",
          "A2"
        ],
        [
          "district",
          "district_id"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A2 = 'Jesenik' AND T1.gender = 'F'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.client_id) FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN account AS T3 ON T2.account_id = T3.account_id INNER JOIN district AS T4 ON T3.district_id = T4.district_id WHERE T1.gender = 'F' AND T4.A2 = 'Jesenik'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.client_id) FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN account AS T3 ON T2.account_id = T3.account_id INNER JOIN district AS T4 ON T3.district_id = T4.district_id WHERE T1.gender = 'F' AND T4.A2 = 'Jesenik'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.client_id) FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN account AS T3 ON T2.account_id = T3.account_id INNER JOIN district AS T4 ON T3.district_id = T4.district_id WHERE T1.gender = 'F' AND T4.A2 = 'Jesenik'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.client_id) FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN account AS T3 ON T2.account_id = T3.account_id INNER JOIN district AS T4 ON T3.district_id = T4.district_id WHERE T1.gender = 'F' AND T4.A2 = 'Jesenik'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.client_id) FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN account AS T3 ON T2.account_id = T3.account_id INNER JOIN district AS T4 ON T3.district_id = T4.district_id WHERE T1.gender = 'F' AND T4.A2 = 'Jesenik'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH JesenikAccounts AS ( -- Step 1: Identify all accounts that are in the 'Jesenik' district. SELECT a.account_id FROM account AS a JOIN district AS d ON a.district_id = d.district_id WHERE d.A2 = 'Jesenik' ) -- Step 2: Join clients to these accounts, filter for women, and count the unique clients. SELECT COUNT(DISTINCT c.client_id) FROM client AS c JOIN disp AS d ON c.client_id = d.client_id JOIN JesenikAccounts AS ja ON d.account_id = ja.account_id WHERE c.gender = 'F'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH JesenikAccounts AS ( -- Step 1: Isolate all account IDs that are in the 'Jesenik' district. -- This creates a temporary, focused subset of data. SELECT a.account_id FROM account AS a INNER JOIN district AS d ON a.district_id = d.district_id WHERE d.A2 = 'Jesenik' ), FemaleClientsInJesenik AS ( -- Step 2: Find clients associated with the accounts from Step 1 -- and filter for only those who are female ('F'). -- Using DISTINCT is crucial to count each client only once, even if she -- has multiple accounts or dispositions in the Jesenik branch. SELECT DISTINCT c.client_id FROM client AS c INNER JOIN disp AS dp ON c.client_id = dp.client_id INNER JOIN JesenikAccounts AS ja ON dp.account_id = ja.account_id WHERE c.gender = 'F' ) -- Final Step: Count the unique female clients identified in the previous step. SELECT COUNT(client_id) AS number_of_female_clients FROM FemaleClientsInJesenik",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.client_id) FROM client AS T1 JOIN disp AS T2 ON T1.client_id = T2.client_id JOIN account AS T3 ON T2.account_id = T3.account_id JOIN district AS T4 ON T3.district_id = T4.district_id WHERE T1.gender = 'F' AND T4.A2 = 'Jesenik'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(T1.client_id) FROM client AS T1 JOIN disp AS T2 ON T1.client_id = T2.client_id JOIN account AS T3 ON T2.account_id = T3.account_id JOIN district AS T4 ON T3.district_id = T4.district_id WHERE T4.A2 = 'Jesenik' AND T1.gender = 'F'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(T1.client_id) FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN account AS T3 ON T2.account_id = T3.account_id INNER JOIN district AS T4 ON T3.district_id = T4.district_id WHERE T4.A2 = 'Jesenik' AND T1.gender = 'F'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 108.400230884552,
      "matched_cells": [
        {
          "table": "district",
          "column": "A2",
          "value": "Jesenik",
          "sim": 1.0
        },
        {
          "table": "client",
          "column": "gender",
          "value": "F",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "gender",
        "A2"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "client.client_id: To count the number of clients.\nclient.gender: To filter the clients for women.\ndisp.client_id: To link clients to their dispositions.\ndisp.account_id: To link dispositions to accounts.\naccount.district_id: To link accounts to their districts.\ndistrict.A2: To filter for the 'Jesenik' branch.",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 7
    },
    {
      "question_id": 135,
      "db_id": "financial",
      "difficulty": "moderate",
      "question": "After making a credit card withdrawal, how many account/s with monthly issuance has a negative balance?",
      "evidence": "Negative balance means balance < 0; Operation = 'VYBER KARTOU' stands for credit card withdraw. Frequency = 'POPLATEK MESICNE' stands for monthly issurance",
      "ground_truth_sql": "SELECT COUNT(T1.account_id) FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T1.balance < 0 AND T1.operation = 'VYBER KARTOU' AND T2.frequency = 'POPLATEK MESICNE'",
      "s1_fields": [
        [
          "account",
          "account_id"
        ],
        [
          "account",
          "district_id"
        ],
        [
          "account",
          "frequency"
        ],
        [
          "trans",
          "account_id"
        ],
        [
          "trans",
          "balance"
        ],
        [
          "trans",
          "operation"
        ],
        [
          "trans",
          "trans_id"
        ]
      ],
      "s2_fields": [
        [
          "account",
          "account_id"
        ],
        [
          "account",
          "district_id"
        ],
        [
          "account",
          "frequency"
        ],
        [
          "trans",
          "account_id"
        ],
        [
          "trans",
          "balance"
        ],
        [
          "trans",
          "operation"
        ],
        [
          "trans",
          "trans_id"
        ],
        [
          "trans",
          "type"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.account_id) FROM account AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T2.operation = 'VYBER KARTOU' AND T2.balance < 0 AND T1.frequency = 'POPLATEK MESICNE'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.account_id) FROM account AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T2.operation = 'VYBER KARTOU' AND T2.balance < 0 AND T1.frequency = 'POPLATEK MESICNE'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.account_id) FROM account AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T2.operation = 'VYBER KARTOU' AND T2.balance < 0 AND T1.frequency = 'POPLATEK MESICNE'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.account_id) FROM account AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T1.frequency = 'POPLATEK MESICNE' AND T2.operation = 'VYBER KARTOU' AND T2.balance < 0",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.account_id) FROM account AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T2.operation = 'VYBER KARTOU' AND T1.frequency = 'POPLATEK MESICNE' AND T2.balance < 0",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.account_id) FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T1.operation = 'VYBER KARTOU' AND T2.frequency = 'POPLATEK MESICNE' AND T1.balance < 0",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH CreditCardWithdrawals_NegativeBalance AS ( -- Step 1: Identify unique accounts that have had a credit card withdrawal ('VYBER KARTOU') -- which resulted in a negative balance (balance < 0). SELECT DISTINCT account_id FROM trans WHERE operation = 'VYBER KARTOU' AND balance < 0 ) -- Step 2: From the accounts identified in Step 1, count how many have a -- monthly issuance frequency ('POPLATEK MESICNE'). SELECT count(T1.account_id) FROM account AS T1 JOIN CreditCardWithdrawals_NegativeBalance AS T2 ON T1.account_id = T2.account_id WHERE T1.frequency = 'POPLATEK MESICNE'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH CreditCardWithdrawals AS ( -- First, identify all transactions that are credit card withdrawals -- and resulted in a negative balance for the account. -- We select the account_id to link back to the account details. SELECT account_id FROM trans WHERE operation = 'VYBER KARTOU' AND balance < 0 ) -- Then, join these transactions with the account table to filter -- for accounts with a monthly issuance frequency. SELECT -- Count the unique accounts that meet all criteria. COUNT(DISTINCT T1.account_id) FROM account AS T1 JOIN CreditCardWithdrawals AS T2 ON T1.account_id = T2.account_id WHERE T1.frequency = 'POPLATEK MESICNE'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(T1.account_id) FROM trans AS T1 JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T1.operation = 'VYBER KARTOU' AND T2.frequency = 'POPLATEK MESICNE' AND T1.balance < 0",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T2.operation = 'VYBER KARTOU' AND T1.frequency = 'POPLATEK MESICNE' AND T2.balance < 0",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.account_id) FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T1.operation = 'VYBER KARTOU' AND T2.frequency = 'POPLATEK MESICNE' AND T1.balance < 0",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 53.95595073699951,
      "matched_cells": [
        {
          "table": "trans",
          "column": "operation",
          "value": "VYBER KARTOU",
          "sim": 1.0
        },
        {
          "table": "district",
          "column": "A2",
          "value": "Karvina",
          "sim": 0.1796875
        },
        {
          "table": "trans",
          "column": "type",
          "value": "VYBER",
          "sim": 1.0
        },
        {
          "table": "account",
          "column": "frequency",
          "value": "POPLATEK MESICNE",
          "sim": 1.0
        },
        {
          "table": "district",
          "column": "A7",
          "value": "0",
          "sim": 1.0
        },
        {
          "table": "district",
          "column": "A6",
          "value": "0",
          "sim": 1.0
        },
        {
          "table": "district",
          "column": "A5",
          "value": "0",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "Operation",
        "Frequency",
        "balance",
        "account"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "trans.operation: To filter for transactions that are 'credit card withdrawal' as specified in the evidence ('VYBER KARTOU').\ntrans.balance: To check for accounts with a negative balance as per the user's question.\naccount.frequency: To filter for accounts with 'monthly issuance' as specified in the evidence ('POPLATEK MESICNE').\ntrans.account_id: To join the trans and account tables to link transactions to account frequencies.\naccount.account_id: To count the number of unique accounts that meet ",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 8
    },
    {
      "question_id": 149,
      "db_id": "financial",
      "difficulty": "challenging",
      "question": "Please list the account types that are not eligible for loans, and the average income of residents in the district where the account is located exceeds $8000 but is no more than $9000.",
      "evidence": "A11 represents the average salary; Salary and income share the similar meanings; when the account type = 'OWNER', it's eligible for loans",
      "ground_truth_sql": "SELECT T3.type FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T3 ON T2.account_id = T3.account_id WHERE T3.type != 'OWNER' AND T1.A11 BETWEEN 8000 AND 9000",
      "s1_fields": [
        [
          "account",
          "account_id"
        ],
        [
          "account",
          "district_id"
        ],
        [
          "disp",
          "account_id"
        ],
        [
          "disp",
          "client_id"
        ],
        [
          "disp",
          "disp_id"
        ],
        [
          "disp",
          "type"
        ],
        [
          "district",
          "A11"
        ],
        [
          "district",
          "district_id"
        ]
      ],
      "s2_fields": [
        [
          "account",
          "account_id"
        ],
        [
          "account",
          "district_id"
        ],
        [
          "disp",
          "account_id"
        ],
        [
          "disp",
          "client_id"
        ],
        [
          "disp",
          "disp_id"
        ],
        [
          "disp",
          "type"
        ],
        [
          "district",
          "A11"
        ],
        [
          "district",
          "district_id"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.type <> 'OWNER' AND T3.A11 > 8000 AND T3.A11 <= 9000",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.type != 'OWNER' AND T3.A11 > 8000 AND T3.A11 <= 9000",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.type != 'OWNER' AND T3.A11 > 8000 AND T3.A11 <= 9000",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.type <> 'OWNER' AND T3.A11 > 8000 AND T3.A11 <= 9000",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.type <> 'OWNER' AND T3.A11 > 8000 AND T3.A11 <= 9000",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.type = 'DISPONENT' AND T3.A11 > 8000 AND T3.A11 <= 9000",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH DistrictIncome AS ( -- First, select districts where the average income is within the specified range. -- A11 represents the average salary (income). SELECT district_id FROM district WHERE A11 > 8000 AND A11 <= 9000 ), LoanIneligibleDispositions AS ( -- Second, identify dispositions that are not eligible for loans. -- According to the evidence, 'OWNER' type is eligible, so any other type is not. SELECT account_id, type FROM disp WHERE type <> 'OWNER' ) -- Finally, join the filtered dispositions with accounts located in the selected districts -- and list the distinct account types that meet all criteria. SELECT DISTINCT T3.type FROM account AS T1 JOIN DistrictIncome AS T2 ON T1.district_id = T2.district_id JOIN LoanIneligibleDispositions AS T3 ON T1.account_id = T3.account_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH AccountsInTargetDistricts AS ( -- Step 1: Identify all accounts located in districts that meet the specified -- average income criteria (> $8000 and <= $9000). SELECT a.account_id FROM account AS a JOIN district AS d ON a.district_id = d.district_id WHERE d.A11 > 8000 AND d.A11 <= 9000 ) -- Step 2: From the disposition records, select the unique account types that are -- not eligible for loans ('OWNER') and belong to the accounts found in Step 1. SELECT DISTINCT d.type FROM disp AS d WHERE d.type <> 'OWNER' AND d.account_id IN ( SELECT account_id FROM AccountsInTargetDistricts )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T3.A11 > 8000 AND T3.A11 <= 9000 AND T1.type <> 'OWNER'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.type <> 'OWNER' AND T3.A11 > 8000 AND T3.A11 <= 9000",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.type != 'OWNER' AND T3.A11 BETWEEN 8001 AND 9000",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 93.41484904289246,
      "matched_cells": [
        {
          "table": "disp",
          "column": "type",
          "value": "OWNER",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "account type",
        "A11"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "disp.type: To identify the account types that are not 'OWNER' and thus not eligible for loans.\ndistrict.A11: To filter districts based on the average income, which is required to be between $8000 and $9000.\ndisp.account_id: Needed to link the 'disp' table to the 'account' table.\naccount.account_id: Needed to join the 'disp' and 'account' tables.\naccount.district_id: Needed to link the 'account' table to the 'district' table.\ndistrict.district_id: Needed to join the 'account' table with the 'dist",
      "gt_executed_ok": true,
      "gt_row_count": 461,
      "oracle_match": false,
      "unique_sql_count": 7
    },
    {
      "question_id": 953,
      "db_id": "formula_1",
      "difficulty": "simple",
      "question": "How many French constructors have a lap number of over 50?",
      "evidence": "lap numbers of over 50 refers to laps > 50;",
      "ground_truth_sql": "SELECT COUNT(DISTINCT T2.constructorId) FROM results AS T1 INNER JOIN constructors AS T2 on T1.constructorId = T2.constructorId WHERE T1.laps > 50 AND T2.nationality = 'French'",
      "s1_fields": [
        [
          "constructors",
          "constructorId"
        ],
        [
          "constructors",
          "nationality"
        ],
        [
          "lapTimes",
          "driverId"
        ],
        [
          "lapTimes",
          "lap"
        ],
        [
          "lapTimes",
          "raceId"
        ],
        [
          "results",
          "constructorId"
        ],
        [
          "results",
          "driverId"
        ],
        [
          "results",
          "raceId"
        ],
        [
          "results",
          "resultId"
        ],
        [
          "results",
          "statusId"
        ]
      ],
      "s2_fields": [
        [
          "constructors",
          "constructorId"
        ],
        [
          "constructors",
          "nationality"
        ],
        [
          "lapTimes",
          "driverId"
        ],
        [
          "lapTimes",
          "lap"
        ],
        [
          "lapTimes",
          "raceId"
        ],
        [
          "results",
          "constructorId"
        ],
        [
          "results",
          "driverId"
        ],
        [
          "results",
          "raceId"
        ],
        [
          "results",
          "resultId"
        ],
        [
          "results",
          "statusId"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.constructorId) FROM constructors AS T1 INNER JOIN results AS T2 ON T1.constructorId = T2.constructorId INNER JOIN lapTimes AS T3 ON T2.raceId = T3.raceId AND T2.driverId = T3.driverId WHERE T1.nationality = 'French' AND T3.lap > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.constructorId) FROM constructors AS T1 INNER JOIN results AS T2 ON T1.constructorId = T2.constructorId INNER JOIN lapTimes AS T3 ON T2.raceId = T3.raceId AND T2.driverId = T3.driverId WHERE T1.nationality = 'French' AND T3.lap > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.constructorId) FROM constructors AS T1 INNER JOIN results AS T2 ON T1.constructorId = T2.constructorId INNER JOIN lapTimes AS T3 ON T2.raceId = T3.raceId AND T2.driverId = T3.driverId WHERE T1.nationality = 'French' AND T3.lap > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.constructorId) FROM constructors AS T1 INNER JOIN results AS T2 ON T1.constructorId = T2.constructorId INNER JOIN lapTimes AS T3 ON T2.raceId = T3.raceId AND T2.driverId = T3.driverId WHERE T1.nationality = 'French' AND T3.lap > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.constructorId) FROM constructors AS T1 INNER JOIN results AS T2 ON T1.constructorId = T2.constructorId INNER JOIN lapTimes AS T3 ON T2.raceId = T3.raceId AND T2.driverId = T3.driverId WHERE T1.nationality = 'French' AND T3.lap > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "To find the number of French constructors that have participated in races where a lap number exceeded 50, we need to: 1. Identify constructors with 'French' nationality. 2. Find records in `lapTimes` where the `lap` number is greater than 50. 3. Link these `lapTimes` to `results` via `raceId` and `driverId`. 4. Link these `results` to `constructors` via `constructorId`. 5. Finally",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "near \"To\": syntax error",
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH FrenchConstructors AS ( SELECT constructorId FROM constructors WHERE nationality = 'French' ), RaceDriverPairsWithHighLaps AS ( SELECT DISTINCT raceId, driverId FROM lapTimes WHERE lap > 50 ) SELECT COUNT(DISTINCT T1.constructorId) FROM FrenchConstructors AS T1 JOIN results AS T2 ON T1.constructorId = T2.constructorId JOIN RaceDriverPairsWithHighLaps AS T3 ON T2.raceId = T3.raceId AND T2.driverId = T3.driverId",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH ConstructorsWithHighLaps AS ( -- First, identify all unique constructor IDs that have at least one lap time greater than 50. -- This requires joining results (which links constructor to a race/driver) -- with lapTimes (which contains the lap number). SELECT DISTINCT r.constructorId FROM results AS r INNER JOIN lapTimes AS lt ON r.raceId = lt.raceId AND r.driverId = lt.driverId WHERE lt.lap > 50 ) -- Now, count how many of the constructors from the set above are French. SELECT COUNT(c.constructorId) FROM constructors AS c -- Join with our CTE to consider only constructors who have met the lap > 50 condition. INNER JOIN ConstructorsWithHighLaps AS ch ON c.constructorId = ch.constructorId WHERE c.nationality = 'French'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(DISTINCT T1.constructorId) FROM constructors AS T1 INNER JOIN results AS T2 ON T1.constructorId = T2.constructorId INNER JOIN lapTimes AS T3 ON T2.raceId = T3.raceId AND T2.driverId = T3.driverId WHERE T1.nationality = 'French' AND T3.lap > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.constructorId) FROM constructors AS T1 INNER JOIN results AS T2 ON T1.constructorId = T2.constructorId INNER JOIN lapTimes AS T3 ON T2.raceId = T3.raceId AND T2.driverId = T3.driverId WHERE T1.nationality = 'French' AND T3.lap > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.constructorid) FROM constructors AS T1 INNER JOIN results AS T2 ON T1.constructorid = T2.constructorid INNER JOIN laptimes AS T3 ON T2.raceid = T3.raceid AND T2.driverid = T3.driverid WHERE T1.nationality = 'French' AND T3.lap > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 97.28554916381836,
      "matched_cells": [
        {
          "table": "drivers",
          "column": "nationality",
          "value": "French",
          "sim": 1.0
        },
        {
          "table": "constructors",
          "column": "nationality",
          "value": "French",
          "sim": 1.0
        },
        {
          "table": "driverStandings",
          "column": "positionText",
          "value": "50",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "constructors",
        "lap number",
        "laps"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "constructors.constructorId: To count the number of French constructors.\nconstructors.nationality: To filter constructors by French nationality.\nlapTimes.lap: To filter for laps over 50.\nresults.constructorId: To link constructors to their results.\nresults.raceId: To link results to lap times.\nlapTimes.raceId: To link lap times to race results.",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": false,
      "unique_sql_count": 4
    },
    {
      "question_id": 852,
      "db_id": "formula_1",
      "difficulty": "moderate",
      "question": "How many races in the year 2010 are held on grand prixs outside Asia and Europe?",
      "evidence": "",
      "ground_truth_sql": "SELECT COUNT(T3.raceId) FROM circuits AS T1 INNER JOIN races AS T3 ON T3.circuitID = T1.circuitId WHERE T1.country NOT IN ( 'Bahrain', 'China', 'Singapore', 'Japan', 'Korea', 'Turkey', 'UAE', 'Malaysia', 'Spain', 'Monaco', 'Azerbaijan', 'Austria', 'Belgium', 'France', 'Germany', 'Hungary', 'Italy', 'UK' ) AND T3.year = 2010",
      "s1_fields": [
        [
          "circuits",
          "circuitId"
        ],
        [
          "circuits",
          "country"
        ],
        [
          "races",
          "circuitId"
        ],
        [
          "races",
          "raceId"
        ],
        [
          "races",
          "year"
        ]
      ],
      "s2_fields": [
        [
          "circuits",
          "circuitId"
        ],
        [
          "circuits",
          "country"
        ],
        [
          "races",
          "circuitId"
        ],
        [
          "races",
          "name"
        ],
        [
          "races",
          "raceId"
        ],
        [
          "races",
          "year"
        ],
        [
          "seasons",
          "year"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T1.raceId) FROM races AS T1 INNER JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T1.year = 2010 AND T2.country NOT IN ('Asia', 'Europe')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T1.raceId) FROM races AS T1 INNER JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T1.year = 2010 AND T2.country IN ('Australia', 'Canada', 'Brazil')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T1.raceId) FROM races AS T1 INNER JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T1.year = 2010 AND T2.country NOT IN ('Asia', 'Europe')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T1.raceId) FROM races AS T1 INNER JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T1.year = 2010 AND T2.country NOT IN ( 'UK', 'Italy', 'Germany', 'France', 'Spain', 'Monaco', 'Belgium', 'Austria', 'Hungary', 'Netherlands', 'Russia', 'Portugal', 'Turkey', 'San Marino', 'Switzerland', 'Sweden', 'Japan', 'China', 'Malaysia', 'Singapore', 'Bahrain', 'UAE', 'India', 'South Korea', 'Azerbaijan' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.raceId) FROM races AS T1 INNER JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T1.year = 2010 AND T2.country NOT IN ('France', 'Spain') AND T2.country NOT IN (",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "To determine the number of races in 2010 held on Grand Prix circuits outside Asia and Europe, we need to join the `races` table with the `circuits` table. We will filter for races in the `year` 2010 and then filter the `circuits.country` column to exclude countries located in Asia or Europe. To achieve this",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "near \"To\": syntax error",
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH Races_In_2010 AS ( -- First, select all races that occurred in the year 2010 SELECT circuitId FROM races WHERE year = 2010 ) -- Then, join with circuit information to filter by location -- and count the races held in countries outside of Asia and Europe. SELECT COUNT(T1.circuitId) FROM Races_In_2010 AS T1 INNER JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T2.country IN ('Australia', 'Canada', 'USA', 'Mexico', 'Brazil', 'Argentina', 'South Africa')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH RacesIn2010 AS ( SELECT T1.raceId, T2.country FROM races AS T1 JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T1.year = 2010 ) SELECT COUNT(raceId) FROM RacesIn2010 WHERE country NOT IN ( 'UK', 'Spain', 'Italy', 'Monaco', 'Germany', 'Hungary', 'Belgium', 'Turkey', 'France', 'Portugal', 'Netherlands', 'Austria', 'Russia', 'Bahrain', 'Malaysia', 'China', 'Singapore', 'Japan', 'South Korea', 'UAE', 'India', 'Qatar' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(*) FROM races AS T1 INNER JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T1.year = 2010 AND T2.country NOT IN ('Asia', 'Europe')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(*) FROM races AS T1 JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T1.year = 2010 AND T2.country NOT IN ('Asia', 'Europe')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(*) FROM races AS T1 INNER JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T1.year = 2010 AND T2.country NOT IN ('Asia', 'Europe')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 94.58102822303772,
      "matched_cells": [
        {
          "table": "races",
          "column": "date",
          "value": "2010-04-04",
          "sim": 0.2890625
        },
        {
          "table": "pitStops",
          "column": "duration",
          "value": "22.010",
          "sim": 0.2265625
        },
        {
          "table": "drivers",
          "column": "forename",
          "value": "Basil",
          "sim": 0.3046875
        }
      ],
      "schema_hints": [
        "races",
        "grand prixs"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "races.year: To filter races that occurred in the year 2010.\ncircuits.country: To identify the location of the race and filter out those in Asia and Europe.\nraces.raceId: To count the number of races.\nraces.name: To identify the location of the race, which is needed to filter by continent.\nseasons.year: To filter the races for the year 2010.",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 9
    },
    {
      "question_id": 994,
      "db_id": "formula_1",
      "difficulty": "challenging",
      "question": "Which constructor scored most points from Monaco Grand Prix between 1980 and 2010? List the score, name and nationality of this team.",
      "evidence": "Monaco Grand Priz refers to the race; race in year between 1980 and 2010",
      "ground_truth_sql": "SELECT SUM(T1.points), T2.name, T2.nationality FROM constructorResults AS T1 INNER JOIN constructors AS T2 ON T1.constructorId = T2.constructorId INNER JOIN races AS T3 ON T3.raceid = T1.raceid WHERE T3.name = 'Monaco Grand Prix' AND T3.year BETWEEN 1980 AND 2010 GROUP BY T2.name ORDER BY SUM(T1.points) DESC LIMIT 1",
      "s1_fields": [
        [
          "constructorResults",
          "constructorId"
        ],
        [
          "constructorResults",
          "constructorResultsId"
        ],
        [
          "constructorResults",
          "points"
        ],
        [
          "constructorResults",
          "raceId"
        ],
        [
          "constructors",
          "constructorId"
        ],
        [
          "constructors",
          "name"
        ],
        [
          "constructors",
          "nationality"
        ],
        [
          "races",
          "circuitId"
        ],
        [
          "races",
          "name"
        ],
        [
          "races",
          "raceId"
        ],
        [
          "races",
          "year"
        ]
      ],
      "s2_fields": [
        [
          "circuits",
          "circuitId"
        ],
        [
          "circuits",
          "name"
        ],
        [
          "constructorResults",
          "constructorId"
        ],
        [
          "constructorResults",
          "constructorResultsId"
        ],
        [
          "constructorResults",
          "points"
        ],
        [
          "constructorResults",
          "raceId"
        ],
        [
          "constructors",
          "constructorId"
        ],
        [
          "constructors",
          "name"
        ],
        [
          "constructors",
          "nationality"
        ],
        [
          "races",
          "circuitId"
        ],
        [
          "races",
          "name"
        ],
        [
          "races",
          "raceId"
        ],
        [
          "races",
          "year"
        ],
        [
          "results",
          "constructorId"
        ],
        [
          "results",
          "driverId"
        ],
        [
          "results",
          "points"
        ],
        [
          "results",
          "raceId"
        ],
        [
          "results",
          "resultId"
        ],
        [
          "results",
          "statusId"
        ],
        [
          "seasons",
          "year"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT SUM(CR.points) AS total_points, C.name, C.nationality FROM constructorResults AS CR JOIN races AS R ON CR.raceId = R.raceId JOIN constructors AS C ON CR.constructorId = C.constructorId WHERE R.name = 'Monaco Grand Prix' AND R.year BETWEEN 1980 AND 2010 GROUP BY C.constructorId, C.name, C.nationality ORDER BY total_points DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT SUM(T1.points) AS total_score, T2.name, T2.nationality FROM constructorResults AS T1 INNER JOIN constructors AS T2 ON T1.constructorId = T2.constructorId INNER JOIN races AS T3 ON T1.raceId = T3.raceId WHERE T3.name = 'Monaco Grand Prix' AND T3.year BETWEEN 1980 AND 2010 GROUP BY T2.name, T2.nationality ORDER BY total_score DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT SUM(T3.points), T4.name, T4.nationality FROM races AS T1 INNER JOIN constructorResults AS T3 ON T1.raceId = T3.raceId INNER JOIN constructors AS T4 ON T3.constructorId = T4.constructorId WHERE T1.name = 'Monaco Grand Prix' AND T1.year BETWEEN 1980 AND 2010 GROUP BY T4.constructorId ORDER BY SUM(T3.points) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT SUM(T3.points) AS total_score, T1.name, T1.nationality FROM constructors AS T1 INNER JOIN constructorResults AS T3 ON T1.constructorId = T3.constructorId INNER JOIN races AS T2 ON T3.raceId = T2.raceId WHERE T2.name = 'Monaco Grand Prix' AND T2.year BETWEEN 1980 AND 2010 GROUP BY T1.constructorId, T1.name, T1.nationality ORDER BY total_score DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T2.points) AS total_points, T3.name, T3.nationality FROM races AS T1 INNER JOIN constructorResults AS T2 ON T1.raceId = T2.raceId INNER JOIN constructors AS T3 ON T2.constructorId = T3.constructorId WHERE T1.name = 'Monaco Grand Prix' AND T1.year BETWEEN 1980 AND 2010 GROUP BY T3.constructorId, T3.name, T3.nationality ORDER BY total_points DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT SUM(CR.points) AS total_points, C.name, C.nationality FROM constructorResults AS CR JOIN races AS R ON CR.raceId = R.raceId JOIN constructors AS C ON CR.constructorId = C.constructorId WHERE R.name = 'Monaco Grand Prix' AND R.year BETWEEN 1980 AND 2010 GROUP BY C.constructorId, C.name, C.nationality ORDER BY total_points DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH MonacoRaces AS ( SELECT raceId FROM races WHERE name = 'Monaco Grand Prix' AND year BETWEEN 1980 AND 2010 ), ConstructorPoints AS ( SELECT constructorId, SUM(points) AS total_points FROM constructorResults WHERE raceId IN ( SELECT raceId FROM MonacoRaces ) GROUP BY constructorId ) SELECT cp.total_points AS score, c.name, c.nationality FROM constructors AS c JOIN ConstructorPoints AS cp ON c.constructorId = cp.constructorId ORDER BY cp.total_points DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH MonacoRaces AS ( SELECT raceId FROM races WHERE name = 'Monaco Grand Prix' AND year BETWEEN 1980 AND 2010 ), TotalConstructorPoints AS ( SELECT T1.constructorId, SUM(T1.points) AS total_points FROM constructorResults AS T1 INNER JOIN MonacoRaces AS T2 ON T1.raceId = T2.raceId GROUP BY T1.constructorId ) SELECT T2.total_points, T1.name, T1.nationality FROM constructors AS T1 INNER JOIN TotalConstructorPoints AS T2 ON T1.constructorId = T2.constructorId ORDER BY T2.total_points DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T1.points), T3.name, T3.nationality FROM constructorResults AS T1 INNER JOIN races AS T2 ON T1.raceId = T2.raceId INNER JOIN constructors AS T3 ON T1.constructorId = T3.constructorId WHERE T2.name = 'Monaco Grand Prix' AND T2.year BETWEEN 1980 AND 2010 GROUP BY T3.name ORDER BY SUM(T1.points) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T1.points), T3.name, T3.nationality FROM constructorResults AS T1 INNER JOIN races AS T2 ON T1.raceId = T2.raceId INNER JOIN constructors AS T3 ON T1.constructorId = T3.constructorId WHERE T2.name = 'Monaco Grand Prix' AND T2.year BETWEEN 1980 AND 2010 GROUP BY T3.name ORDER BY SUM(T1.points) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T1.points), T3.name, T3.nationality FROM constructorResults AS T1 INNER JOIN races AS T2 ON T1.raceId = T2.raceId INNER JOIN constructors AS T3 ON T1.constructorId = T3.constructorId WHERE T2.name = 'Monaco Grand Prix' AND T2.year BETWEEN 1980 AND 2010 GROUP BY T3.name, T3.nationality ORDER BY SUM(T1.points) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 69.56148600578308,
      "matched_cells": [
        {
          "table": "races",
          "column": "name",
          "value": "Monaco Grand Prix",
          "sim": 1.0
        },
        {
          "table": "circuits",
          "column": "country",
          "value": "Monaco",
          "sim": 1.0
        },
        {
          "table": "circuits",
          "column": "circuitRef",
          "value": "monaco",
          "sim": 1.0
        },
        {
          "table": "drivers",
          "column": "driverRef",
          "value": "monarch",
          "sim": 0.265625
        },
        {
          "table": "drivers",
          "column": "surname",
          "value": "Monarch",
          "sim": 0.265625
        },
        {
          "table": "drivers",
          "column": "forename",
          "value": "Bertrand",
          "sim": 0.2421875
        },
        {
          "table": "pitStops",
          "column": "duration",
          "value": "20.198",
          "sim": 0.265625
        },
        {
          "table": "results",
          "column": "fastestLapSpeed",
          "value": "198.485",
          "sim": 0.21875
        },
        {
          "table": "drivers",
          "column": "dob",
          "value": "1980-01-19",
          "sim": 0.21875
        },
        {
          "table": "races",
          "column": "date",
          "value": "2010-04-04",
          "sim": 0.2890625
        }
      ],
      "schema_hints": [
        "constructor",
        "points",
        "score",
        "name",
        "nationality",
        "team",
        "race",
        "year"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "races.name: To filter for races named 'Monaco Grand Prix'.\nraces.year: To filter for races that occurred between 1980 and 2010.\nconstructorResults.points: To sum the points for each constructor to find the total score.\nconstructors.name: To display the name of the constructor.\nconstructors.nationality: To display the nationality of the constructor.\nraces.raceId: To link the races table with the constructorResults table.\nconstructorResults.raceId: To link the constructorResults table with the rac",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 9
    },
    {
      "question_id": 1349,
      "db_id": "student_club",
      "difficulty": "simple",
      "question": "Provide the total number of the budget amount for \"September Speaker\" event.",
      "evidence": "'September Speaker' is an event name; total number of budget amount refers to SUM(amount)",
      "ground_truth_sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
      "s1_fields": [
        [
          "budget",
          "amount"
        ],
        [
          "budget",
          "budget_id"
        ],
        [
          "budget",
          "link_to_event"
        ],
        [
          "event",
          "event_id"
        ],
        [
          "event",
          "event_name"
        ]
      ],
      "s2_fields": [
        [
          "budget",
          "amount"
        ],
        [
          "budget",
          "budget_id"
        ],
        [
          "budget",
          "category"
        ],
        [
          "budget",
          "link_to_event"
        ],
        [
          "budget",
          "remaining"
        ],
        [
          "budget",
          "spent"
        ],
        [
          "event",
          "event_id"
        ],
        [
          "event",
          "event_name"
        ],
        [
          "event",
          "notes"
        ],
        [
          "event",
          "type"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH SeptemberSpeakerEvent AS ( SELECT event_id FROM event WHERE event_name = 'September Speaker' ) SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN SeptemberSpeakerEvent AS T2 ON T1.link_to_event = T2.event_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T2.amount) FROM event AS T1 INNER JOIN budget AS T2 ON T1.event_id = T2.link_to_event WHERE T1.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT AGGREGATE_FUNCTION(T1.column_name) FROM table1 AS T1 INNER JOIN table2 AS T2 ON T1.foreign_key_column = T2.primary_key_column WHERE T2.column_to_filter = 'value'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "no such table: table1",
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 37.45646810531616,
      "matched_cells": [
        {
          "table": "event",
          "column": "event_name",
          "value": "September Speaker",
          "sim": 1.0
        },
        {
          "table": "budget",
          "column": "category",
          "value": "Speaker Gifts",
          "sim": 0.5390625
        },
        {
          "table": "member",
          "column": "position",
          "value": "Member",
          "sim": 0.3046875
        },
        {
          "table": "event",
          "column": "type",
          "value": "Guest Speaker",
          "sim": 0.421875
        }
      ],
      "schema_hints": [
        "amount"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "budget.amount: To calculate the total budget amount.\nevent.event_name: To filter the budget for the 'September Speaker' event.\nbudget.link_to_event: To link the budget to the event.\nevent.event_id: To link the event to the budget.\nbudget.spent: To calculate the total budget amount for the event.\nbudget.remaining: To calculate the total budget amount by summing with the spent column.\nevent.type: To identify the event type, which is likely \"Guest Speaker\".\nevent.notes: To find the specific event n",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 5
    },
    {
      "question_id": 1456,
      "db_id": "student_club",
      "difficulty": "moderate",
      "question": "List the full name of the top five members who spend the most money in the descending order of spending.",
      "evidence": "full name refers to first_name, last_name; spend the most money refers to MAX(expense.cost)",
      "ground_truth_sql": "SELECT T3.first_name, T3.last_name FROM expense AS T1 INNER JOIN budget AS T2 ON T1.link_to_budget = T2.budget_id INNER JOIN member AS T3 ON T1.link_to_member = T3.member_id ORDER BY T2.spent DESC LIMIT 5",
      "s1_fields": [
        [
          "expense",
          "cost"
        ],
        [
          "expense",
          "expense_id"
        ],
        [
          "expense",
          "link_to_budget"
        ],
        [
          "expense",
          "link_to_member"
        ],
        [
          "member",
          "first_name"
        ],
        [
          "member",
          "last_name"
        ],
        [
          "member",
          "link_to_major"
        ],
        [
          "member",
          "member_id"
        ],
        [
          "member",
          "zip"
        ]
      ],
      "s2_fields": [
        [
          "attendance",
          "link_to_event"
        ],
        [
          "attendance",
          "link_to_member"
        ],
        [
          "budget",
          "budget_id"
        ],
        [
          "budget",
          "link_to_event"
        ],
        [
          "budget",
          "spent"
        ],
        [
          "expense",
          "cost"
        ],
        [
          "expense",
          "expense_id"
        ],
        [
          "expense",
          "link_to_budget"
        ],
        [
          "expense",
          "link_to_member"
        ],
        [
          "member",
          "email"
        ],
        [
          "member",
          "first_name"
        ],
        [
          "member",
          "last_name"
        ],
        [
          "member",
          "link_to_major"
        ],
        [
          "member",
          "member_id"
        ],
        [
          "member",
          "position"
        ],
        [
          "member",
          "zip"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.first_name, T1.last_name FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id, T1.first_name, T1.last_name ORDER BY SUM(T2.cost) DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.first_name, T1.last_name FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id, T1.first_name, T1.last_name ORDER BY SUM(T2.cost) DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.first_name, T1.last_name FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id ORDER BY SUM(T2.cost) DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.first_name, T1.last_name FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id, T1.first_name, T1.last_name ORDER BY SUM(T2.cost) DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.first_name, T1.last_name, SUM(T2.cost) AS total_spending FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id, T1.first_name, T1.last_name ORDER BY total_spending DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.first_name, T1.last_name, SUM(T2.cost) AS total_spending FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id, T1.first_name, T1.last_name ORDER BY total_spending DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH MemberSpending AS ( SELECT link_to_member, SUM(cost) AS total_spending FROM expense GROUP BY link_to_member ) SELECT m.first_name || ' ' || m.last_name AS \"full_name\" FROM MemberSpending AS ms JOIN member AS m ON ms.link_to_member = m.member_id ORDER BY ms.total_spending DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH MemberSpending AS ( -- First, calculate the total amount spent by each member SELECT link_to_member, SUM(cost) AS total_spent FROM expense GROUP BY link_to_member ) -- Then, join with the member table to get their names and order by spending SELECT m.first_name || ' ' || m.last_name AS \"full_name\" FROM member AS m JOIN MemberSpending AS ms ON m.member_id = ms.link_to_member ORDER BY ms.total_spent DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.first_name , T1.last_name FROM member AS T1 JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id ORDER BY sum(T2.cost) DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.first_name , T1.last_name FROM member AS T1 JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id ORDER BY sum(T2.cost) DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.first_name, T1.last_name FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id ORDER BY SUM(T2.cost) DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 72.49775004386902,
      "matched_cells": [],
      "schema_hints": [
        "first_name",
        "last_name",
        "expense",
        "cost"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "member.first_name: To display the full name of the members.\nmember.last_name: To display the full name of the members.\nexpense.cost: To calculate the total spending for each member.\nexpense.link_to_member: To link expenses to the members who spent the money.\nattendance.link_to_member: To identify the member who is associated with spending.\nbudget.spent: To find the amount of money spent by each member.\nbudget.link_to_event: To link the budget spent to a specific event which can then be linked to",
      "gt_executed_ok": true,
      "gt_row_count": 5,
      "oracle_match": false,
      "unique_sql_count": 6
    },
    {
      "question_id": 1464,
      "db_id": "student_club",
      "difficulty": "challenging",
      "question": "Write the full names of students who received funds on the date of 9/9/2019 and include the amount received.",
      "evidence": "full name refers to first_name, last_name, amount of funds received refers to amount, received funds on date refers to date_received",
      "ground_truth_sql": "SELECT DISTINCT T3.first_name, T3.last_name, T4.amount FROM event AS T1 INNER JOIN attendance AS T2 ON T1.event_id = T2.link_to_event INNER JOIN member AS T3 ON T3.member_id = T2.link_to_member INNER JOIN income AS T4 ON T4.link_to_member = T3.member_id WHERE T4.date_received = '2019-09-09'",
      "s1_fields": [
        [
          "income",
          "amount"
        ],
        [
          "income",
          "date_received"
        ],
        [
          "income",
          "income_id"
        ],
        [
          "income",
          "link_to_member"
        ],
        [
          "member",
          "first_name"
        ],
        [
          "member",
          "last_name"
        ],
        [
          "member",
          "link_to_major"
        ],
        [
          "member",
          "member_id"
        ],
        [
          "member",
          "zip"
        ]
      ],
      "s2_fields": [
        [
          "expense",
          "cost"
        ],
        [
          "expense",
          "expense_date"
        ],
        [
          "expense",
          "expense_id"
        ],
        [
          "expense",
          "link_to_budget"
        ],
        [
          "expense",
          "link_to_member"
        ],
        [
          "income",
          "amount"
        ],
        [
          "income",
          "date_received"
        ],
        [
          "income",
          "income_id"
        ],
        [
          "income",
          "link_to_member"
        ],
        [
          "member",
          "first_name"
        ],
        [
          "member",
          "last_name"
        ],
        [
          "member",
          "link_to_major"
        ],
        [
          "member",
          "member_id"
        ],
        [
          "member",
          "zip"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.first_name, T1.last_name, T2.amount FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T2.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.first_name, T1.last_name, T2.amount FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T2.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.first_name, T1.last_name, T2.amount FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T2.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.first_name, T1.last_name, T2.amount FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T2.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.first_name, T1.last_name, T2.amount FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T2.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.first_name, T1.last_name, T2.amount FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T2.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH TargetIncome AS ( SELECT link_to_member, amount FROM income WHERE date_received = '2019-09-09' ) SELECT T1.first_name || ' ' || T1.last_name AS \"full name\", T2.amount FROM member AS T1 JOIN TargetIncome AS T2 ON T1.member_id = T2.link_to_member",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH MemberIncome AS ( SELECT link_to_member, amount FROM income WHERE date_received = '2019-09-09' ) SELECT m.first_name || ' ' || m.last_name AS \"full name\", mi.amount FROM member AS m JOIN MemberIncome AS mi ON m.member_id = mi.link_to_member",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.first_name, T2.last_name, T1.amount FROM income AS T1 INNER JOIN member AS T2 ON T1.link_to_member = T2.member_id WHERE T1.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.first_name, T1.last_name, T2.amount FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T2.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.column_for_name_part1, T2.column_for_name_part2, T1.column_for_amount FROM table_with_transaction_data AS T1 JOIN table_with_user_data AS T2 ON T1.foreign_key = T2.primary_key WHERE T1.date_column = 'YYYY-MM-DD'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "no such table: table_with_transaction_data",
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 40.02558898925781,
      "matched_cells": [],
      "schema_hints": [
        "first_name",
        "last_name",
        "amount",
        "date_received"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "member.first_name: To get the first name of the student.\nmember.last_name: To get the last name of the student.\nincome.date_received: To filter the records for the specific date of 9/9/2019.\nincome.amount: To show the amount of funds received by the student.\nincome.link_to_member: To join the income table with the member table.\nmember.member_id: To join the member table with the income table.\nexpense.cost: To find the amount of funds received.\nexpense.expense_date: To filter for funds received o",
      "gt_executed_ok": true,
      "gt_row_count": 2,
      "oracle_match": true,
      "unique_sql_count": 5
    },
    {
      "question_id": 803,
      "db_id": "superhero",
      "difficulty": "simple",
      "question": "What is the power ID of cryokinesis?",
      "evidence": "power ID refers to superpower.id; cryokinesis refers to power_name = 'cryokinesis';",
      "ground_truth_sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
      "s1_fields": [
        [
          "superpower",
          "id"
        ],
        [
          "superpower",
          "power_name"
        ]
      ],
      "s2_fields": [
        [
          "attribute",
          "attribute_name"
        ],
        [
          "attribute",
          "id"
        ],
        [
          "superpower",
          "id"
        ],
        [
          "superpower",
          "power_name"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT id_column FROM table_name WHERE name_column = 'value'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "no such table: table_name",
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 37.39441394805908,
      "matched_cells": [
        {
          "table": "superpower",
          "column": "power_name",
          "value": "Cryokinesis",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "superpower.id",
        "power_name"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "superpower.id: The user is asking for the power ID, which corresponds to the superpower.id column.\nsuperpower.power_name: The user is filtering for the power 'cryokinesis', which is found in the power_name column.\nattribute.id: This is the unique identifier for the attribute (power). The user is asking for the 'power ID', which corresponds to this column.\nattribute.attribute_name: This column contains the names of attributes, which in this context are synonymous with powers like 'Cryokinesis'. I",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 2
    },
    {
      "question_id": 782,
      "db_id": "superhero",
      "difficulty": "moderate",
      "question": "List the heroes' names whose eyes and hair colours are both black.",
      "evidence": "heroes' names refers to superhero_name; eyes and hair colours are both black refers to eye_colour_id AND hair_colour_id WHERE colour.colour = 'Black';",
      "ground_truth_sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id AND T1.hair_colour_id = T2.id WHERE T2.colour = 'Black'",
      "s1_fields": [
        [
          "colour",
          "colour"
        ],
        [
          "colour",
          "id"
        ],
        [
          "superhero",
          "alignment_id"
        ],
        [
          "superhero",
          "eye_colour_id"
        ],
        [
          "superhero",
          "gender_id"
        ],
        [
          "superhero",
          "hair_colour_id"
        ],
        [
          "superhero",
          "id"
        ],
        [
          "superhero",
          "publisher_id"
        ],
        [
          "superhero",
          "race_id"
        ],
        [
          "superhero",
          "skin_colour_id"
        ],
        [
          "superhero",
          "superhero_name"
        ]
      ],
      "s2_fields": [
        [
          "attribute",
          "attribute_name"
        ],
        [
          "attribute",
          "id"
        ],
        [
          "colour",
          "colour"
        ],
        [
          "colour",
          "id"
        ],
        [
          "hero_attribute",
          "attribute_id"
        ],
        [
          "hero_attribute",
          "attribute_value"
        ],
        [
          "hero_attribute",
          "hero_id"
        ],
        [
          "superhero",
          "alignment_id"
        ],
        [
          "superhero",
          "eye_colour_id"
        ],
        [
          "superhero",
          "full_name"
        ],
        [
          "superhero",
          "gender_id"
        ],
        [
          "superhero",
          "hair_colour_id"
        ],
        [
          "superhero",
          "id"
        ],
        [
          "superhero",
          "publisher_id"
        ],
        [
          "superhero",
          "race_id"
        ],
        [
          "superhero",
          "skin_colour_id"
        ],
        [
          "superhero",
          "superhero_name"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH BlackColour AS ( SELECT id FROM colour WHERE colour = 'Black' ) SELECT s.superhero_name FROM superhero AS s WHERE s.eye_colour_id = ( SELECT id FROM BlackColour ) AND s.hair_colour_id = ( SELECT id FROM BlackColour )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH BlackColour AS ( SELECT id FROM colour WHERE colour = 'Black' ) SELECT T1.superhero_name FROM superhero AS T1 WHERE T1.eye_colour_id = ( SELECT id FROM BlackColour ) AND T1.hair_colour_id = ( SELECT id FROM BlackColour )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 43.30226707458496,
      "matched_cells": [
        {
          "table": "colour",
          "column": "colour",
          "value": "Black",
          "sim": 1.0
        },
        {
          "table": "superhero",
          "column": "superhero_name",
          "value": "Blackout",
          "sim": 0.5234375
        }
      ],
      "schema_hints": [
        "superhero_name",
        "eye_colour_id",
        "hair_colour_id",
        "colour.colour"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "superhero.superhero_name: To list the names of the superheroes as requested in the output.\nsuperhero.eye_colour_id: To identify the eye colour of the superhero and join with the colour table.\nsuperhero.hair_colour_id: To identify the hair colour of the superhero and join with the colour table.\ncolour.id: To join with the superhero table on eye_colour_id and hair_colour_id.\ncolour.colour: To filter for the specific colour 'Black' for both eyes and hair.\nsuperhero.full_name: To retrieve the names ",
      "gt_executed_ok": true,
      "gt_row_count": 11,
      "oracle_match": true,
      "unique_sql_count": 3
    },
    {
      "question_id": 773,
      "db_id": "superhero",
      "difficulty": "challenging",
      "question": "Which superhero has the same eyes, hair and skin colour? Indicate the publisher of the superhero.",
      "evidence": "which superhero refers to superhero_name; the same eyes, hair and skin colour refers to hair_colour_id = skin_colour_id AND hair_colour_id = eye_colour_id; publisher refers to publisher_name;",
      "ground_truth_sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.eye_colour_id = T1.hair_colour_id AND T1.eye_colour_id = T1.skin_colour_id",
      "s1_fields": [
        [
          "publisher",
          "id"
        ],
        [
          "publisher",
          "publisher_name"
        ],
        [
          "superhero",
          "alignment_id"
        ],
        [
          "superhero",
          "eye_colour_id"
        ],
        [
          "superhero",
          "gender_id"
        ],
        [
          "superhero",
          "hair_colour_id"
        ],
        [
          "superhero",
          "id"
        ],
        [
          "superhero",
          "publisher_id"
        ],
        [
          "superhero",
          "race_id"
        ],
        [
          "superhero",
          "skin_colour_id"
        ],
        [
          "superhero",
          "superhero_name"
        ]
      ],
      "s2_fields": [
        [
          "colour",
          "colour"
        ],
        [
          "colour",
          "id"
        ],
        [
          "publisher",
          "id"
        ],
        [
          "publisher",
          "publisher_name"
        ],
        [
          "superhero",
          "alignment_id"
        ],
        [
          "superhero",
          "eye_colour_id"
        ],
        [
          "superhero",
          "full_name"
        ],
        [
          "superhero",
          "gender_id"
        ],
        [
          "superhero",
          "hair_colour_id"
        ],
        [
          "superhero",
          "id"
        ],
        [
          "superhero",
          "publisher_id"
        ],
        [
          "superhero",
          "race_id"
        ],
        [
          "superhero",
          "skin_colour_id"
        ],
        [
          "superhero",
          "superhero_name"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.hair_colour_id = T1.skin_colour_id AND T1.hair_colour_id = T1.eye_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.eye_colour_id = T1.hair_colour_id AND T1.hair_colour_id = T1.skin_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.eye_colour_id = T1.hair_colour_id AND T1.hair_colour_id = T1.skin_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.eye_colour_id = T1.hair_colour_id AND T1.hair_colour_id = T1.skin_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.eye_colour_id = T1.hair_colour_id AND T1.hair_colour_id = T1.skin_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.eye_colour_id = T1.hair_colour_id AND T1.hair_colour_id = T1.skin_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH MatchedSuperheroes AS ( SELECT superhero_name, publisher_id FROM superhero WHERE hair_colour_id = skin_colour_id AND hair_colour_id = eye_colour_id ) SELECT T1.superhero_name, T2.publisher_name FROM MatchedSuperheroes AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH MatchingColourSuperheroes AS ( SELECT superhero_name, publisher_id FROM superhero WHERE eye_colour_id = hair_colour_id AND hair_colour_id = skin_colour_id ) SELECT T1.superhero_name, T2.publisher_name FROM MatchingColourSuperheroes AS T1 JOIN publisher AS T2 ON T1.publisher_id = T2.id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.skin_colour_id = T1.hair_colour_id AND T1.hair_colour_id = T1.eye_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.skin_colour_id = T1.hair_colour_id AND T1.hair_colour_id = T1.eye_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.hair_colour_id = T1.skin_colour_id AND T1.hair_colour_id = T1.eye_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 34.21987199783325,
      "matched_cells": [],
      "schema_hints": [
        "superhero_name",
        "hair_colour_id",
        "skin_colour_id",
        "eye_colour_id",
        "publisher_name"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "superhero.superhero_name: To identify the superhero.\nsuperhero.eye_colour_id: To compare with hair and skin colour to find superheroes with the same colour for all three.\nsuperhero.hair_colour_id: To compare with eye and skin colour to find superheroes with the same colour for all three.\nsuperhero.skin_colour_id: To compare with eye and hair colour to find superheroes with the same colour for all three.\npublisher.publisher_name: To display the publisher of the superhero.\nsuperhero.publisher_id: ",
      "gt_executed_ok": true,
      "gt_row_count": 157,
      "oracle_match": true,
      "unique_sql_count": 5
    },
    {
      "question_id": 1276,
      "db_id": "thrombosis_prediction",
      "difficulty": "simple",
      "question": "For the patients who have an abnormal level of anti-DNA, please list the diseases they are diagnosed with.",
      "evidence": "abnormal level of anti-DNA refers to DNA > = 8; diseases refers to Diagnosis;",
      "ground_truth_sql": "SELECT DISTINCT(T1.Diagnosis) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.DNA >= 8",
      "s1_fields": [
        [
          "Laboratory",
          "DNA"
        ],
        [
          "Laboratory",
          "Date"
        ],
        [
          "Laboratory",
          "ID"
        ],
        [
          "Patient",
          "Diagnosis"
        ],
        [
          "Patient",
          "ID"
        ]
      ],
      "s2_fields": [
        [
          "Examination",
          "Diagnosis"
        ],
        [
          "Examination",
          "ID"
        ],
        [
          "Laboratory",
          "DNA"
        ],
        [
          "Laboratory",
          "DNA-II"
        ],
        [
          "Laboratory",
          "Date"
        ],
        [
          "Laboratory",
          "ID"
        ],
        [
          "Patient",
          "Diagnosis"
        ],
        [
          "Patient",
          "ID"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T1.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.DNA >= 8",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T2.Diagnosis FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.DNA >= 8",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T2.Diagnosis FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.DNA >= 8",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T2.Diagnosis FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.DNA >= 8",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT P.Diagnosis FROM Patient AS P JOIN Laboratory AS L ON P.ID = L.ID WHERE L.DNA >= 8",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T2.Diagnosis FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.DNA >= 8",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH AbnormalDNAPatients AS ( SELECT ID FROM Laboratory WHERE DNA >= 8 ) SELECT DISTINCT T1.Diagnosis FROM Patient AS T1 JOIN AbnormalDNAPatients AS T2 ON T1.ID = T2.ID",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH Abnormal_DNA_Patients AS ( -- Select the unique IDs of patients with an abnormal DNA level SELECT DISTINCT ID FROM Laboratory WHERE DNA >= 8 ) -- Join with the Patient table to get the diagnosis for each identified patient SELECT DISTINCT T1.Diagnosis FROM Patient AS T1 INNER JOIN Abnormal_DNA_Patients AS T2 ON T1.ID = T2.ID",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T2.Diagnosis FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.DNA >= 8",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "* **Tables identified:** `Laboratory`, `Patient`, `Examination`. * **Joins:** * Join `Laboratory` with `Patient` on the `ID` column to link DNA levels with patient diagnoses. * Join `Laboratory` with `Examination` on the `ID` column to link DNA levels with examination diagnoses. * **Filtering:** * Filter the `Laboratory` table for records where `DNA >= 8`. The `DNA` column is TEXT but contains numeric values, so a direct comparison will work in SQL. * **Logic:** 1. Select the `Diagnosis` from the `Patient` table for patients who meet the DNA condition. 2. Select the `Diagnosis` from the `Examination` table for the same set of patients. Since the `Diagnosis` in this table can be `NULL`, we must filter these out. 3. Combine the results from both selections using `UNION` to get a single",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "near \"*\": syntax error",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T1.Diagnosis FROM Patient AS T1 JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.DNA >= 8",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 54.90848112106323,
      "matched_cells": [
        {
          "table": "Laboratory",
          "column": "SSB",
          "value": "8",
          "sim": 1.0
        },
        {
          "table": "Laboratory",
          "column": "CRP",
          "value": "8",
          "sim": 1.0
        },
        {
          "table": "Laboratory",
          "column": "SM",
          "value": "8",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "DNA",
        "Diagnosis"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "Laboratory.DNA: To filter for patients with an abnormal level of anti-DNA, which is defined as DNA >= 8.\nPatient.Diagnosis: To list the diseases the patients are diagnosed with.\nLaboratory.DNA-II: The user is asking for patients with an 'abnormal level of anti-DNA', which the evidence defines as 'DNA > = 8'. The 'DNA-II' column is the most direct match for this condition.\nExamination.Diagnosis: The user wants to list the 'diseases they are diagnosed with', and the evidence explicitly maps 'disea",
      "gt_executed_ok": true,
      "gt_row_count": 3,
      "oracle_match": true,
      "unique_sql_count": 7
    },
    {
      "question_id": 1225,
      "db_id": "thrombosis_prediction",
      "difficulty": "moderate",
      "question": "List and group all patients by sex for total bilirubin (T-BIL) level not within the normal range.",
      "evidence": "List refers to GROUP_CONCAT(DISTINCT ID); total bilirubin (T-BIL) not within normal range refers to T-BIL > = 2.0",
      "ground_truth_sql": "SELECT T1.ID,T1.SEX FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.`T-BIL` >= 2.0 GROUP BY T1.SEX,T1.ID",
      "s1_fields": [
        [
          "Laboratory",
          "Date"
        ],
        [
          "Laboratory",
          "ID"
        ],
        [
          "Laboratory",
          "T-BIL"
        ],
        [
          "Patient",
          "ID"
        ],
        [
          "Patient",
          "SEX"
        ]
      ],
      "s2_fields": [
        [
          "Examination",
          "ID"
        ],
        [
          "Laboratory",
          "Date"
        ],
        [
          "Laboratory",
          "ID"
        ],
        [
          "Laboratory",
          "T-BIL"
        ],
        [
          "Patient",
          "ID"
        ],
        [
          "Patient",
          "SEX"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T2.SEX, GROUP_CONCAT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2.0 GROUP BY T2.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT P.SEX, GROUP_CONCAT(DISTINCT P.ID) AS PatientsWithAbnormalTBIL FROM Patient AS P JOIN Laboratory AS L ON P.ID = L.ID WHERE L.\"T-BIL\" >= 2.0 GROUP BY P.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.SEX, GROUP_CONCAT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.\"T-BIL\" >= 2.0 GROUP BY T1.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T2.SEX, GROUP_CONCAT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2.0 GROUP BY T2.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T2.SEX, GROUP_CONCAT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.`T-BIL` >= 2.0 GROUP BY T2.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.SEX, GROUP_CONCAT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.`T-BIL` >= 2.0 GROUP BY T2.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH Abnormal_Tbil_Patients AS ( -- Select all patient records where Total Bilirubin is outside the normal range (>= 2.0) SELECT ID FROM Laboratory WHERE \"T-BIL\" >= 2.0 ) -- Join with the Patient table to get demographic information (SEX) -- and group by SEX to list the unique patient IDs. SELECT T2.SEX, GROUP_CONCAT(DISTINCT T1.ID) AS Patient_IDs FROM Abnormal_Tbil_Patients AS T1 JOIN Patient AS T2 ON T1.ID = T2.ID GROUP BY T2.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH Abnormal_TBIL_Patients AS ( SELECT DISTINCT ID FROM Laboratory WHERE \"T-BIL\" >= 2.0 ) SELECT T2.SEX, GROUP_CONCAT(T1.ID) AS Patient_List FROM Abnormal_TBIL_Patients AS T1 JOIN Patient AS T2 ON T1.ID = T2.ID GROUP BY T2.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.SEX, group_concat(T1.ID) FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.`T-BIL` >= 2.0 GROUP BY T2.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.SEX, group_concat(T1.ID) FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.`T-BIL` >= 2.0 GROUP BY T2.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.SEX, GROUP_CONCAT(T1.ID) FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2.0 GROUP BY T2.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 40.251426219940186,
      "matched_cells": [
        {
          "table": "Laboratory",
          "column": "RF",
          "value": "<22.0",
          "sim": 0.3671875
        }
      ],
      "schema_hints": [
        "ID",
        "T-BIL",
        "sex"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "Patient.ID: To list the patients as requested.\nPatient.SEX: To group the patients by sex as requested.\nLaboratory.T-BIL: To filter patients based on their total bilirubin level.\nExamination.ID: The user wants to list patients, and the evidence \"GROUP_CONCAT(DISTINCT ID)\" indicates that the 'ID' column is used for this purpose.",
      "gt_executed_ok": true,
      "gt_row_count": 10,
      "oracle_match": false,
      "unique_sql_count": 8
    },
    {
      "question_id": 1295,
      "db_id": "thrombosis_prediction",
      "difficulty": "challenging",
      "question": "Among the patients whose total bilirubin is over the normal range, how many of them have a peripheral pattern observed in the sheet of ANA examination?",
      "evidence": "total bilirubin is over the normal range refers to `T-BIL` > = 2.0; peripheral pattern is observed in the sheet of ANA examination refers to that ANA Pattern contains 'P';",
      "ground_truth_sql": "SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T1.ID = T3.ID WHERE T2.`T-BIL` >= 2 AND T3.`ANA Pattern` LIKE '%P%'",
      "s1_fields": [
        [
          "Examination",
          "ANA Pattern"
        ],
        [
          "Examination",
          "ID"
        ],
        [
          "Laboratory",
          "Date"
        ],
        [
          "Laboratory",
          "ID"
        ],
        [
          "Laboratory",
          "T-BIL"
        ],
        [
          "Patient",
          "ID"
        ]
      ],
      "s2_fields": [
        [
          "Examination",
          "ANA"
        ],
        [
          "Examination",
          "ANA Pattern"
        ],
        [
          "Examination",
          "ID"
        ],
        [
          "Laboratory",
          "Date"
        ],
        [
          "Laboratory",
          "ID"
        ],
        [
          "Laboratory",
          "T-BIL"
        ],
        [
          "Patient",
          "ID"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2.0 AND T2.\"ANA Pattern\" LIKE '%P%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2.0 AND T2.\"ANA Pattern\" LIKE '%P%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2.0 AND T2.\"ANA Pattern\" LIKE '%P%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2.0 AND T2.\"ANA Pattern\" LIKE '%P%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.`T-BIL` >= 2.0 AND T2.`ANA Pattern` LIKE '%P%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.`T-BIL` >= 2.0 AND T2.`ANA Pattern` LIKE '%P%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH High_Bilirubin_Patients AS ( -- Select patients with total bilirubin over the normal range (>= 2.0) SELECT ID FROM Laboratory WHERE \"T-BIL\" >= 2.0 ), Peripheral_Pattern_Patients AS ( -- Select patients with a peripheral pattern in ANA examination SELECT ID FROM Examination WHERE \"ANA Pattern\" LIKE '%P%' ) -- Count the distinct patients who are in both groups SELECT COUNT(DISTINCT T1.ID) FROM High_Bilirubin_Patients AS T1 JOIN Peripheral_Pattern_Patients AS T2 ON T1.ID = T2.ID",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH PatientsWithHighBilirubin AS ( -- First, identify all unique patients whose total bilirubin is 2.0 or higher. SELECT DISTINCT ID FROM Laboratory WHERE \"T-BIL\" >= 2.0 ), PatientsWithPeripheralPattern AS ( -- Second, identify all unique patients with a peripheral ('P') ANA pattern. -- The LIKE operator handles cases where 'P' is part of a larger string (e.g., 'P,S'). SELECT DISTINCT ID FROM Examination WHERE \"ANA Pattern\" LIKE '%P%' ) -- Finally, count the number of patients who appear in both of the sets defined above. SELECT COUNT(T1.ID) FROM PatientsWithHighBilirubin AS T1 INNER JOIN PatientsWithPeripheralPattern AS T2 ON T1.ID = T2.ID",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2.0 AND T2.\"ANA Pattern\" LIKE '%P%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.`T-BIL` >= 2 AND T2.`ANA Pattern` LIKE '%P%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2.0 AND T2.\"ANA Pattern\" LIKE '%P%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 62.24095702171326,
      "matched_cells": [
        {
          "table": "Laboratory",
          "column": "RF",
          "value": "<22.0",
          "sim": 0.3671875
        },
        {
          "table": "Examination",
          "column": "ANA Pattern",
          "value": "p",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "T-BIL",
        "ANA Pattern"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "Laboratory.T-BIL: To filter for patients whose total bilirubin is over the normal range (>= 2.0).\nExamination.ANA Pattern: To identify patients with a peripheral pattern in their ANA examination.\nPatient.ID: To count the number of unique patients who meet both criteria.\nExamination.ANA: The user is asking a question about the 'peripheral pattern observed in the sheet of ANA examination'. The 'ANA' column in the 'Examination' table is the most relevant field to identify these records.",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 5
    },
    {
      "question_id": 195,
      "db_id": "toxicology",
      "difficulty": "simple",
      "question": "What is the most common bond type?",
      "evidence": "most common bond type refers MAX(COUNT(bond_type))",
      "ground_truth_sql": "SELECT T.bond_type FROM ( SELECT bond_type, COUNT(bond_id) FROM bond GROUP BY bond_type ORDER BY COUNT(bond_id) DESC LIMIT 1 ) AS T",
      "s1_fields": [
        [
          "bond",
          "bond_id"
        ],
        [
          "bond",
          "bond_type"
        ],
        [
          "bond",
          "molecule_id"
        ]
      ],
      "s2_fields": [
        [
          "bond",
          "bond_id"
        ],
        [
          "bond",
          "bond_type"
        ],
        [
          "bond",
          "molecule_id"
        ],
        [
          "connected",
          "atom_id"
        ],
        [
          "connected",
          "atom_id2"
        ],
        [
          "connected",
          "bond_id"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(bond_type) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(bond_type) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(bond_type) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(bond_type) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(bond_type) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(bond_type) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH BondTypeCounts AS ( -- First, count the occurrences of each bond type SELECT bond_type, COUNT(*) AS frequency FROM bond GROUP BY bond_type ) -- Then, select the bond type with the highest frequency SELECT bond_type FROM BondTypeCounts ORDER BY frequency DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(*) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY count(*) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY count(*) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(*) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 27.28779911994934,
      "matched_cells": [],
      "schema_hints": [
        "bond_type"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "bond.bond_type: The user is asking for the most common bond type. To determine this, I need to count the occurrences of each bond type, which is found in the `bond_type` column of the `bond` table.\nconnected.bond_id: The user is asking for the most common bond type. To answer this, I would need a column that describes the type of bond. Since there is no 'bond_type' column, I will select 'bond_id' to count the bonds, but the question is likely unanswerable with the given schema.",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 3
    },
    {
      "question_id": 237,
      "db_id": "toxicology",
      "difficulty": "moderate",
      "question": "Which molecule does the atom TR001_10 belong to? Please state whether this molecule is carcinogenic or not.",
      "evidence": "TR001_10 is the atom id; label = '+' mean molecules are carcinogenic",
      "ground_truth_sql": "SELECT T2.molecule_id , IIF(T2.label = '+', 'YES', 'NO') AS flag_carcinogenic FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
      "s1_fields": [
        [
          "atom",
          "atom_id"
        ],
        [
          "atom",
          "molecule_id"
        ],
        [
          "molecule",
          "label"
        ],
        [
          "molecule",
          "molecule_id"
        ]
      ],
      "s2_fields": [
        [
          "atom",
          "atom_id"
        ],
        [
          "atom",
          "molecule_id"
        ],
        [
          "bond",
          "bond_id"
        ],
        [
          "bond",
          "molecule_id"
        ],
        [
          "connected",
          "atom_id"
        ],
        [
          "connected",
          "atom_id2"
        ],
        [
          "connected",
          "bond_id"
        ],
        [
          "molecule",
          "label"
        ],
        [
          "molecule",
          "molecule_id"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.molecule_id, T2.label FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.molecule_id, T2.label FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.molecule_id, T2.label FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.molecule_id, CASE WHEN T2.label = '+' THEN 'carcinogenic' ELSE 'not carcinogenic' END AS carcinogenicity FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.molecule_id, T2.label FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.molecule_id, T2.label FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.molecule_id, CASE WHEN T2.label = '+' THEN 'carcinogenic' ELSE 'not carcinogenic' END AS carcinogenicity FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.molecule_id, CASE WHEN T2.label = '+' THEN 'Carcinogenic' ELSE 'Not Carcinogenic' END AS carcinogenic_status FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.molecule_id, T2.label FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.molecule_id, T2.label FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.molecule_id, T2.label FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 63.40567708015442,
      "matched_cells": [
        {
          "table": "connected",
          "column": "atom_id2",
          "value": "TR001_10",
          "sim": 1.0
        },
        {
          "table": "atom",
          "column": "atom_id",
          "value": "TR001_10",
          "sim": 1.0
        },
        {
          "table": "connected",
          "column": "atom_id",
          "value": "TR001_10",
          "sim": 1.0
        },
        {
          "table": "molecule",
          "column": "label",
          "value": "+",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "molecule",
        "atom id",
        "label",
        "carcinogenic"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "atom.atom_id: This column is needed to identify and filter for the specific atom 'TR001_10' mentioned in the user's question.\natom.molecule_id: This column is required to link the identified atom to its parent molecule.\nmolecule.molecule_id: This column is necessary to join with the 'atom' table to find the correct molecule.\nmolecule.label: This column provides the carcinogenicity information ('+' or '-'), which is essential to answer the second part of the user's question.\nbond.molecule_id: To ",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": false,
      "unique_sql_count": 3
    },
    {
      "question_id": 304,
      "db_id": "toxicology",
      "difficulty": "challenging",
      "question": "List all carcinogenic molecules and their elements.",
      "evidence": "label = '+' mean molecules are carcinogenic; element = 'cl' means Chlorine; element = 'c' means Carbon; element = 'h' means Hydrogen; element = 'o' means Oxygen, element = 's' means Sulfur; element = 'n' means Nitrogen, element = 'p' means Phosphorus, element = 'na' means Sodium, element = 'br' means Bromine, element = 'f' means Fluorine; element = 'i' means Iodine; element = 'sn' means Tin; element = 'pb' means Lead; element = 'te' means Tellurium; element = 'ca' means Calcium",
      "ground_truth_sql": "SELECT DISTINCT T2.molecule_id, T1.element FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T2.label = '+'",
      "s1_fields": [
        [
          "atom",
          "atom_id"
        ],
        [
          "atom",
          "element"
        ],
        [
          "atom",
          "molecule_id"
        ],
        [
          "molecule",
          "label"
        ],
        [
          "molecule",
          "molecule_id"
        ]
      ],
      "s2_fields": [
        [
          "atom",
          "atom_id"
        ],
        [
          "atom",
          "element"
        ],
        [
          "atom",
          "molecule_id"
        ],
        [
          "bond",
          "bond_id"
        ],
        [
          "bond",
          "molecule_id"
        ],
        [
          "connected",
          "atom_id"
        ],
        [
          "connected",
          "atom_id2"
        ],
        [
          "connected",
          "bond_id"
        ],
        [
          "molecule",
          "label"
        ],
        [
          "molecule",
          "molecule_id"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT m.molecule_id, a.element FROM molecule AS m JOIN atom AS a ON m.molecule_id = a.molecule_id WHERE m.label = '+' ORDER BY m.molecule_id, a.element",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3692,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT m.molecule_id, a.element FROM molecule AS m JOIN atom AS a ON m.molecule_id = a.molecule_id WHERE m.label = '+' ORDER BY m.molecule_id, a.element",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3692,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.molecule_id, T2.element FROM molecule AS T1 INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.label = '+' ORDER BY T1.molecule_id, T2.element",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3692,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.molecule_id, T2.element FROM molecule AS T1 INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.label = '+'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3692,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.molecule_id, T2.element FROM molecule AS T1 INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.label = '+' ORDER BY T1.molecule_id, T2.element",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3692,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T1.molecule_id, T2.element FROM molecule AS T1 INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.label = '+'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 563,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH CarcinogenicMolecules AS ( SELECT molecule_id FROM molecule WHERE label = '+' ) SELECT DISTINCT T1.molecule_id, T2.element FROM CarcinogenicMolecules AS T1 JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 563,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH CarcinogenicMolecules AS ( SELECT molecule_id FROM molecule WHERE label = '+' ) SELECT DISTINCT T1.molecule_id, T2.element FROM CarcinogenicMolecules AS T1 JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 563,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T1.molecule_id, T2.element FROM molecule AS T1 INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.label = '+'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 563,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T1.molecule_id , T2.element FROM molecule AS T1 JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.label = '+'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 563,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T1.molecule_id , T2.element FROM molecule AS T1 JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.label = '+'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 563,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 44.924906969070435,
      "matched_cells": [
        {
          "table": "molecule",
          "column": "label",
          "value": "+",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "label",
        "element"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "molecule.label: To filter for molecules that are carcinogenic.\nmolecule.molecule_id: To identify each unique molecule and join with the atom table.\natom.element: To list the elements within each carcinogenic molecule.\natom.molecule_id: To link atoms to their parent molecule.\nbond.molecule_id: To identify the carcinogenic molecules.\nconnected.atom_id: To identify the atoms and thus the elements that make up each molecule.",
      "gt_executed_ok": true,
      "gt_row_count": 563,
      "oracle_match": true,
      "unique_sql_count": 6
    }
  ]
}