{
  "run_config": {
    "provider": "gemini",
    "model_fast": "gemini-2.5-flash",
    "model_powerful": "gemini-2.5-pro",
    "model_reasoning": "gemini-2.5-flash",
    "cache_enabled": true,
    "n_questions": 33,
    "sampling": "stratified 3-per-DB (1s/1m/1c), random.seed(42)",
    "total_elapsed_seconds": 1884.4930119514465
  },
  "summary": {
    "oracle_upper_bound": 0.7575757575757576,
    "oracle_count": 25,
    "question_count": 33,
    "total_candidates": 359,
    "unique_candidates": 198,
    "duplicate_candidates": 161,
    "gen_stats": {
      "A_reasoning": {
        "total": 132,
        "non_empty": 132,
        "exec_ok": 131,
        "oracle_match": 63
      },
      "B1_standard": {
        "total": 66,
        "non_empty": 66,
        "exec_ok": 63,
        "oracle_match": 34
      },
      "B2_complex": {
        "total": 66,
        "non_empty": 66,
        "exec_ok": 62,
        "oracle_match": 35
      },
      "C_icl": {
        "total": 99,
        "non_empty": 95,
        "exec_ok": 94,
        "oracle_match": 50
      }
    }
  },
  "questions": [
    {
      "question_id": 64,
      "db_id": "california_schools",
      "difficulty": "simple",
      "question": "What is the total number of schools with a mailing city in Hickman belonging to the charter number 00D4?",
      "evidence": "",
      "ground_truth_sql": "SELECT COUNT(*) FROM schools WHERE CharterNum = '00D4' AND MailCity = 'Hickman'",
      "s1_fields": [
        [
          "schools",
          "CDSCode"
        ],
        [
          "schools",
          "CharterNum"
        ],
        [
          "schools",
          "MailCity"
        ]
      ],
      "s2_fields": [
        [
          "frpm",
          "CDSCode"
        ],
        [
          "frpm",
          "Charter School Number"
        ],
        [
          "schools",
          "CDSCode"
        ],
        [
          "schools",
          "CharterNum"
        ],
        [
          "schools",
          "MailCity"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(CDSCode) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(CDSCode) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T1.CDSCode) FROM schools AS T1 WHERE T1.MailCity = 'Hickman' AND T1.CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T1.CDSCode) FROM schools AS T1 WHERE T1.MailCity = 'Hickman' AND T1.CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(CDSCode) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(CDSCode) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(CDSCode) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.CDSCode) FROM schools AS T1 WHERE T1.MailCity = 'Hickman' AND T1.CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(*) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(*) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(*) FROM schools WHERE MailCity = 'Hickman' AND CharterNum = '00D4'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 42.91597318649292,
      "matched_cells": [
        {
          "table": "schools",
          "column": "AdmLName1",
          "value": "Hickman",
          "sim": 1.0
        },
        {
          "table": "schools",
          "column": "MailCity",
          "value": "Hickman",
          "sim": 1.0
        },
        {
          "table": "schools",
          "column": "City",
          "value": "Hickman",
          "sim": 1.0
        },
        {
          "table": "frpm",
          "column": "School Name",
          "value": "Hickman Middle",
          "sim": 0.46875
        },
        {
          "table": "schools",
          "column": "School",
          "value": "Hickman Middle",
          "sim": 0.46875
        },
        {
          "table": "frpm",
          "column": "Charter School Number",
          "value": "00D4",
          "sim": 1.0
        },
        {
          "table": "schools",
          "column": "CharterNum",
          "value": "00D4",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "schools",
        "mailing city",
        "charter number"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "schools.MailCity: To filter schools based on their mailing city being 'Hickman'.\nschools.CharterNum: To filter schools based on their charter number being '00D4'.\nschools.MailCity: To filter schools based on their mailing city being 'Hickman'.\nfrpm.Charter School Number: To filter schools based on their charter number being '00D4'.",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 3
    },
    {
      "question_id": 23,
      "db_id": "california_schools",
      "difficulty": "moderate",
      "question": "List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools.",
      "evidence": "Diffrence in enrollement = `Enrollment (K-12)` - `Enrollment (Ages 5-17)`",
      "ground_truth_sql": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30",
      "s1_fields": [
        [
          "frpm",
          "CDSCode"
        ],
        [
          "frpm",
          "Enrollment (Ages 5-17)"
        ],
        [
          "frpm",
          "Enrollment (K-12)"
        ],
        [
          "frpm",
          "School Name"
        ],
        [
          "schools",
          "CDSCode"
        ],
        [
          "schools",
          "School"
        ],
        [
          "schools",
          "Street"
        ]
      ],
      "s2_fields": [
        [
          "frpm",
          "CDSCode"
        ],
        [
          "frpm",
          "Enrollment (Ages 5-17)"
        ],
        [
          "frpm",
          "Enrollment (K-12)"
        ],
        [
          "frpm",
          "Free Meal Count (Ages 5-17)"
        ],
        [
          "frpm",
          "Free Meal Count (K-12)"
        ],
        [
          "frpm",
          "School Name"
        ],
        [
          "satscores",
          "cds"
        ],
        [
          "satscores",
          "sname"
        ],
        [
          "schools",
          "CDSCode"
        ],
        [
          "schools",
          "City"
        ],
        [
          "schools",
          "School"
        ],
        [
          "schools",
          "Street"
        ],
        [
          "schools",
          "Zip"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.\"School Name\", T2.Street FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE (T1.\"Enrollment (K-12)\" - T1.\"Enrollment (Ages 5-17)\") > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT s.School, s.Street FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE ( f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\" ) > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE ( T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\" ) > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE ( T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\" ) > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\" > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE ABS(T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\") > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\" > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH EnrollmentDifferences AS ( SELECT CDSCode, ABS(\"Enrollment (K-12)\" - \"Enrollment (Ages 5-17)\") AS EnrollmentDiff FROM frpm ) SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN EnrollmentDifferences AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.EnrollmentDiff > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE ABS(T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\") > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE ABS(T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\") > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE ABS(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > 30",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1239,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 44.42163109779358,
      "matched_cells": [
        {
          "table": "frpm",
          "column": "County Code",
          "value": "30",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "names of schools",
        "full street adress",
        "Enrollment (K-12)",
        "Enrollment (Ages 5-17)"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "frpm.Enrollment (K-12): This column is required to calculate the difference in enrollments as specified in the question.\nfrpm.Enrollment (Ages 5-17): This column is required to calculate the difference in enrollments as specified in the question.\nfrpm.School Name: The user is asking for the names of the schools.\nschools.Street: The user is asking for the full street address of the schools.\nschools.School: This column is needed to join the frpm table with the schools table to get the street addre",
      "gt_executed_ok": true,
      "gt_row_count": 1239,
      "oracle_match": true,
      "unique_sql_count": 7
    },
    {
      "question_id": 28,
      "db_id": "california_schools",
      "difficulty": "challenging",
      "question": "Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average.",
      "evidence": "Difference between K-12 enrollment and 15-17 enrollment can be computed by `Enrollment (K-12)` - `Enrollment (Ages 5-17)`",
      "ground_truth_sql": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')",
      "s1_fields": [
        [
          "frpm",
          "CDSCode"
        ],
        [
          "frpm",
          "Enrollment (Ages 5-17)"
        ],
        [
          "frpm",
          "Enrollment (K-12)"
        ],
        [
          "schools",
          "CDSCode"
        ],
        [
          "schools",
          "FundingType"
        ],
        [
          "schools",
          "SOCType"
        ],
        [
          "schools",
          "School"
        ]
      ],
      "s2_fields": [
        [
          "frpm",
          "CDSCode"
        ],
        [
          "frpm",
          "Charter Funding Type"
        ],
        [
          "frpm",
          "Educational Option Type"
        ],
        [
          "frpm",
          "Enrollment (Ages 5-17)"
        ],
        [
          "frpm",
          "Enrollment (K-12)"
        ],
        [
          "frpm",
          "FRPM Count (Ages 5-17)"
        ],
        [
          "frpm",
          "FRPM Count (K-12)"
        ],
        [
          "frpm",
          "School Name"
        ],
        [
          "schools",
          "CDSCode"
        ],
        [
          "schools",
          "FundingType"
        ],
        [
          "schools",
          "SOCType"
        ],
        [
          "schools",
          "School"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT s.School, s.SOCType FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE s.FundingType = 'Locally funded' AND (f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(f_sub.\"Enrollment (K-12)\" - f_sub.\"Enrollment (Ages 5-17)\") FROM schools AS s_sub JOIN frpm AS f_sub ON s_sub.CDSCode = f_sub.CDSCode WHERE s_sub.FundingType = 'Locally funded' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 57,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT s.School, s.SOCType FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode WHERE s.FundingType = 'Locally funded' AND ( f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\" ) > ( SELECT AVG(f_sub.\"Enrollment (K-12)\" - f_sub.\"Enrollment (Ages 5-17)\") FROM schools AS s_sub JOIN frpm AS f_sub ON s_sub.CDSCode = f_sub.CDSCode WHERE s_sub.FundingType = 'Locally funded' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 57,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.School, T1.SOCType FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.\"Charter Funding Type\" = 'Locally funded' AND (T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(T3.\"Enrollment (K-12)\" - T3.\"Enrollment (Ages 5-17)\") FROM frpm AS T3 WHERE T3.\"Charter Funding Type\" = 'Locally funded' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 49,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.School, T1.SOCType FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Locally funded' AND (T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(T4.\"Enrollment (K-12)\" - T4.\"Enrollment (Ages 5-17)\") FROM schools AS T3 INNER JOIN frpm AS T4 ON T3.CDSCode = T4.CDSCode WHERE T3.FundingType = 'Locally funded' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 57,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.School, T1.SOCType FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Locally funded' AND (T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\") > ( SELECT AVG(T4.\"Enrollment (K-12)\" - T4.\"Enrollment (Ages 5-17)\") FROM schools AS T3 INNER JOIN frpm AS T4 ON T3.CDSCode = T4.CDSCode WHERE T3.FundingType = 'Locally funded' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 57,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.School, T1.SOCType FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Locally funded' AND ( T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\" ) > ( SELECT AVG(T2_sub.\"Enrollment (K-12)\" - T2_sub.\"Enrollment (Ages 5-17)\") FROM schools AS T1_sub INNER JOIN frpm AS T2_sub ON T1_sub.CDSCode = T2_sub.CDSCode WHERE T1_sub.FundingType = 'Locally funded' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 57,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH SchoolEnrollmentDifference AS ( SELECT T1.School, T1.SOCType, ( T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\" ) AS enrollment_difference FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode ) SELECT School, SOCType FROM SchoolEnrollmentDifference WHERE enrollment_difference > ( SELECT AVG(T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\") FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Locally funded' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2541,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH SchoolEnrollmentDiff AS ( SELECT s.School, s.SOCType, s.FundingType, ( f.\"Enrollment (K-12)\" - f.\"Enrollment (Ages 5-17)\" ) AS enrollment_difference FROM schools AS s JOIN frpm AS f ON s.CDSCode = f.CDSCode ), AvgDiffForLocallyFunded AS ( SELECT AVG(enrollment_difference) AS avg_diff FROM SchoolEnrollmentDiff WHERE FundingType = 'Locally funded' ) SELECT T1.School, T1.SOCType FROM SchoolEnrollmentDiff AS T1 CROSS JOIN AvgDiffForLocallyFunded AS T2 WHERE T1.enrollment_difference > T2.avg_diff",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2541,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.School, T1.SOCType FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Locally funded' AND T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\" > (SELECT AVG(T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\") FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Locally funded')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 57,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.School, T2.SOCType FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND T1.\"Enrollment (K-12)\" - T1.\"Enrollment (Ages 5-17)\" > (SELECT AVG(T3.\"Enrollment (K-12)\" - T3.\"Enrollment (Ages 5-17)\") FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 57,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.School, T1.SOCType FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Locally funded' AND T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\" > ( SELECT AVG(T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\") FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Locally funded' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 57,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 44.605157136917114,
      "matched_cells": [
        {
          "table": "schools",
          "column": "GSoffered",
          "value": "K-12",
          "sim": 1.0
        },
        {
          "table": "schools",
          "column": "GSserved",
          "value": "K-12",
          "sim": 1.0
        },
        {
          "table": "schools",
          "column": "MailZip",
          "value": "92315-1708",
          "sim": 0.3984375
        },
        {
          "table": "schools",
          "column": "Zip",
          "value": "90015-1714",
          "sim": 0.375
        },
        {
          "table": "schools",
          "column": "LastUpdate",
          "value": "2015-10-17",
          "sim": 0.3515625
        },
        {
          "table": "frpm",
          "column": "Charter Funding Type",
          "value": "Locally funded",
          "sim": 1.0
        },
        {
          "table": "schools",
          "column": "FundingType",
          "value": "Locally funded",
          "sim": 1.0
        },
        {
          "table": "schools",
          "column": "City",
          "value": "Callel",
          "sim": 0.296875
        },
        {
          "table": "schools",
          "column": "MailCity",
          "value": "Callel",
          "sim": 0.296875
        },
        {
          "table": "schools",
          "column": "AdmLName1",
          "value": "Launder",
          "sim": 0.3125
        }
      ],
      "schema_hints": [
        "Enrollment (K-12)",
        "Enrollment (Ages 5-17)",
        "names",
        "DOC type",
        "schools"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "frpm.Enrollment (K-12): This column is required to calculate the difference between K-12 enrollment and 5-17 enrollment, which is a key part of the question.\nfrpm.Enrollment (Ages 5-17): This column is needed to calculate the difference in enrollment figures as specified in the question's evidence.\nschools.FundingType: This column is necessary to filter for schools that are 'locally funded' as required by the question.\nschools.School: This column is required to output the names of the schools th",
      "gt_executed_ok": true,
      "gt_row_count": 57,
      "oracle_match": false,
      "unique_sql_count": 10
    },
    {
      "question_id": 463,
      "db_id": "card_games",
      "difficulty": "simple",
      "question": "How many translations are there for the set of cards with \"Angel of Mercy\" in it?",
      "evidence": "set of cards with \"Angel of Mercy\" in it refers to name = 'Angel of Mercy'",
      "ground_truth_sql": "SELECT COUNT(DISTINCT translation) FROM set_translations WHERE setCode IN ( SELECT setCode FROM cards WHERE name = 'Angel of Mercy' ) AND translation IS NOT NULL",
      "s1_fields": [
        [
          "cards",
          "id"
        ],
        [
          "cards",
          "name"
        ],
        [
          "cards",
          "setCode"
        ],
        [
          "set_translations",
          "id"
        ],
        [
          "set_translations",
          "setCode"
        ],
        [
          "set_translations",
          "translation"
        ]
      ],
      "s2_fields": [
        [
          "cards",
          "id"
        ],
        [
          "cards",
          "name"
        ],
        [
          "cards",
          "setCode"
        ],
        [
          "set_translations",
          "id"
        ],
        [
          "set_translations",
          "language"
        ],
        [
          "set_translations",
          "setCode"
        ],
        [
          "set_translations",
          "translation"
        ],
        [
          "sets",
          "id"
        ],
        [
          "sets",
          "name"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T1.id) FROM set_translations AS T1 INNER JOIN cards AS T2 ON T1.setCode = T2.setCode WHERE T2.name = 'Angel of Mercy'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T1.translation) FROM set_translations AS T1 INNER JOIN cards AS T2 ON T1.setCode = T2.setCode WHERE T2.name = 'Angel of Mercy'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T1.id) FROM set_translations AS T1 INNER JOIN cards AS T2 ON T1.setCode = T2.setCode WHERE T2.name = 'Angel of Mercy'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T2.id) FROM cards AS T1 INNER JOIN set_translations AS T2 ON T1.setCode = T2.setCode WHERE T1.name = 'Angel of Mercy'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.id) FROM set_translations AS T1 INNER JOIN cards AS T2 ON T1.setCode = T2.setCode WHERE T2.name = 'Angel of Mercy'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.id) FROM set_translations AS T1 INNER JOIN cards AS T2 ON T1.setCode = T2.setCode WHERE T2.name = 'Angel of Mercy'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH AngelCardSets AS ( SELECT DISTINCT setCode FROM cards WHERE name = 'Angel of Mercy' ) SELECT COUNT(T1.id) AS translation_count FROM set_translations AS T1 INNER JOIN AngelCardSets AS T2 ON T1.setCode = T2.setCode",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH AngelCardSet AS ( SELECT setCode FROM cards WHERE name = 'Angel of Mercy' ) SELECT COUNT(T1.id) AS translation_count FROM set_translations AS T1 JOIN AngelCardSet AS T2 ON T1.setCode = T2.setCode",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(*) FROM set_translations AS T1 INNER JOIN cards AS T2 ON T1.setCode = T2.setCode WHERE T2.name = 'Angel of Mercy'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.id) FROM set_translations AS T1 INNER JOIN cards AS T2 ON T1.setCode = T2.setCode WHERE T2.name = 'Angel of Mercy'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(*) FROM set_translations WHERE setCode IN (SELECT setCode FROM cards WHERE name = 'Angel of Mercy')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 46.78707695007324,
      "matched_cells": [
        {
          "table": "cards",
          "column": "name",
          "value": "Angel of Mercy",
          "sim": 1.0
        },
        {
          "table": "cards",
          "column": "subtypes",
          "value": "Angel",
          "sim": 1.0
        },
        {
          "table": "cards",
          "column": "keywords",
          "value": "Changeling",
          "sim": 0.4140625
        }
      ],
      "schema_hints": [
        "translations",
        "name"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "cards.name: To find the card named 'Angel of Mercy'.\ncards.setCode: To identify the set that the card 'Angel of Mercy' belongs to.\nset_translations.setCode: To find the corresponding set in the set_translations table.\nset_translations.translation: To count the number of translations for the specific set.\ncards.name: To identify the card named 'Angel of Mercy'.\nsets.name: To identify the set that the card 'Angel of Mercy' belongs to.\nset_translations.language: To count the number of translations ",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": false,
      "unique_sql_count": 7
    },
    {
      "question_id": 427,
      "db_id": "card_games",
      "difficulty": "moderate",
      "question": "What languages are available in the set known as Archenemy on the magic card market and having the code ARC?",
      "evidence": "known as Archenemy refers to mcmName = 'Archenemy'; having the code ARC refers to setCode = 'ARC'",
      "ground_truth_sql": "SELECT T2.language FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.mcmName = 'Archenemy' AND T2.setCode = 'ARC'",
      "s1_fields": [
        [
          "set_translations",
          "id"
        ],
        [
          "set_translations",
          "language"
        ],
        [
          "set_translations",
          "setCode"
        ],
        [
          "sets",
          "code"
        ],
        [
          "sets",
          "id"
        ],
        [
          "sets",
          "mcmName"
        ]
      ],
      "s2_fields": [
        [
          "cards",
          "id"
        ],
        [
          "cards",
          "setCode"
        ],
        [
          "foreign_data",
          "id"
        ],
        [
          "foreign_data",
          "language"
        ],
        [
          "foreign_data",
          "name"
        ],
        [
          "foreign_data",
          "uuid"
        ],
        [
          "set_translations",
          "id"
        ],
        [
          "set_translations",
          "language"
        ],
        [
          "set_translations",
          "setCode"
        ],
        [
          "set_translations",
          "translation"
        ],
        [
          "sets",
          "code"
        ],
        [
          "sets",
          "id"
        ],
        [
          "sets",
          "mcmName"
        ],
        [
          "sets",
          "name"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T2.language FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.mcmName = 'Archenemy' AND T1.code = 'ARC'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T2.language FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.mcmName = 'Archenemy' AND T1.code = 'ARC'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.language FROM set_translations AS T1 INNER JOIN sets AS T2 ON T1.setCode = T2.code WHERE T2.mcmName = 'Archenemy' AND T2.code = 'ARC' UNION SELECT T3.language FROM sets AS T1 INNER JOIN cards AS T2 ON T1.code = T2.setCode INNER JOIN foreign_data AS T3 ON T2.uuid = T3.uuid WHERE T1.mcmName = 'Archenemy' AND T1.code = 'ARC'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T3.language FROM sets AS T1 INNER JOIN cards AS T2 ON T1.code = T2.setCode INNER JOIN foreign_data AS T3 ON T2.uuid = T3.uuid WHERE T1.mcmName = 'Archenemy' AND T1.code = 'ARC'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T2.language FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.mcmName = 'Archenemy' AND T1.code = 'ARC'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T1.language FROM set_translations AS T1 INNER JOIN sets AS T2 ON T1.setCode = T2.code WHERE T2.mcmName = 'Archenemy' AND T2.code = 'ARC'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH TargetSet AS ( SELECT code FROM sets WHERE mcmName = 'Archenemy' AND code = 'ARC' ) SELECT T1.language FROM set_translations AS T1 JOIN TargetSet AS T2 ON T1.setCode = T2.code",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH TargetSet AS ( SELECT code FROM sets WHERE mcmName = 'Archenemy' AND code = 'ARC' ) SELECT T1.language FROM set_translations AS T1 INNER JOIN TargetSet AS T2 ON T1.setCode = T2.code",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.language FROM set_translations AS T1 INNER JOIN sets AS T2 ON T1.setCode = T2.code WHERE T2.mcmName = 'Archenemy' AND T2.code = 'ARC'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.language FROM set_translations AS T1 INNER JOIN sets AS T2 ON T1.setCode = T2.code WHERE T2.mcmName = 'Archenemy' AND T2.code = 'ARC'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.language FROM set_translations AS T1 INNER JOIN sets AS T2 ON T1.setCode = T2.code WHERE T2.mcmName = 'Archenemy' AND T2.code = 'ARC'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 48.07774806022644,
      "matched_cells": [
        {
          "table": "sets",
          "column": "mcmName",
          "value": "Archenemy",
          "sim": 1.0
        },
        {
          "table": "sets",
          "column": "name",
          "value": "Archenemy",
          "sim": 1.0
        },
        {
          "table": "sets",
          "column": "type",
          "value": "archenemy",
          "sim": 1.0
        },
        {
          "table": "set_translations",
          "column": "translation",
          "value": "Archenemy",
          "sim": 1.0
        },
        {
          "table": "cards",
          "column": "setCode",
          "value": "ARC",
          "sim": 1.0
        },
        {
          "table": "sets",
          "column": "parentCode",
          "value": "ARC",
          "sim": 1.0
        },
        {
          "table": "set_translations",
          "column": "setCode",
          "value": "ARC",
          "sim": 1.0
        },
        {
          "table": "sets",
          "column": "code",
          "value": "ARC",
          "sim": 1.0
        },
        {
          "table": "sets",
          "column": "keyruneCode",
          "value": "ARC",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "mcmName",
        "setCode",
        "languages"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "sets.mcmName: To identify the set by its Magic Card Market name 'Archenemy'.\nsets.code: To filter for the specific set with the code 'ARC'.\nset_translations.language: To list the available languages for the specified set.\nset_translations.setCode: To link the set translations to the correct set using its code.\nforeign_data.language: This column is needed to identify the different languages available for the cards in the specified set.\nsets.name: The user is asking a question about the set named ",
      "gt_executed_ok": true,
      "gt_row_count": 10,
      "oracle_match": true,
      "unique_sql_count": 7
    },
    {
      "question_id": 431,
      "db_id": "card_games",
      "difficulty": "challenging",
      "question": "Which set is not available outside of the United States and has foil cards with Japanese writing on them? Please include the set ID in your response.",
      "evidence": "available outside of the United States refers to isForeignOnly = 1; has foil cards refers to isFoilOnly = 1; with Japanese writing on them refers to language = 'Japanese'",
      "ground_truth_sql": "SELECT T1.name, T1.id FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T2.language = 'Japanese' AND T1.isFoilOnly = 1 AND T1.isForeignOnly = 0",
      "s1_fields": [
        [
          "set_translations",
          "id"
        ],
        [
          "set_translations",
          "language"
        ],
        [
          "set_translations",
          "setCode"
        ],
        [
          "sets",
          "code"
        ],
        [
          "sets",
          "id"
        ],
        [
          "sets",
          "isFoilOnly"
        ],
        [
          "sets",
          "isForeignOnly"
        ],
        [
          "sets",
          "name"
        ]
      ],
      "s2_fields": [
        [
          "set_translations",
          "id"
        ],
        [
          "set_translations",
          "language"
        ],
        [
          "set_translations",
          "setCode"
        ],
        [
          "sets",
          "code"
        ],
        [
          "sets",
          "id"
        ],
        [
          "sets",
          "isFoilOnly"
        ],
        [
          "sets",
          "isForeignOnly"
        ],
        [
          "sets",
          "name"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.id FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.isForeignOnly = 1 AND T1.isFoilOnly = 1 AND T2.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.id FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.isForeignOnly = 1 AND T1.isFoilOnly = 1 AND T2.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.name, T1.id FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.isForeignOnly = 1 AND T1.isFoilOnly = 1 AND T2.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.id, T1.name FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.isForeignOnly = 1 AND T1.isFoilOnly = 1 AND T2.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.id FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.isForeignOnly = 1 AND T1.isFoilOnly = 1 AND T2.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.id FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.isForeignOnly = 1 AND T1.isFoilOnly = 1 AND T2.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH JapaneseTranslatedSets AS ( SELECT setCode FROM set_translations WHERE language = 'Japanese' ) SELECT T1.name, T1.id FROM sets AS T1 INNER JOIN JapaneseTranslatedSets AS T2 ON T1.code = T2.setCode WHERE T1.isForeignOnly = 0 AND T1.isFoilOnly = 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT s.id FROM sets AS s WHERE s.isForeignOnly = 0 AND s.isFoilOnly = 1 AND EXISTS ( SELECT 1 FROM set_translations AS st WHERE st.setCode = s.code AND st.language = 'Japanese' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.id FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.isForeignOnly = 0 AND T1.isFoilOnly = 1 AND T2.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.id FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.isForeignOnly = 0 AND T1.isFoilOnly = 1 AND T2.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.id FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.isForeignOnly = 0 AND T1.isFoilOnly = 1 AND T2.language = 'Japanese'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 69.18768382072449,
      "matched_cells": [
        {
          "table": "cards",
          "column": "number",
          "value": "1",
          "sim": 1.0
        },
        {
          "table": "cards",
          "column": "mcmMetaId",
          "value": "1",
          "sim": 1.0
        },
        {
          "table": "cards",
          "column": "life",
          "value": "1",
          "sim": 1.0
        },
        {
          "table": "cards",
          "column": "power",
          "value": "1",
          "sim": 1.0
        },
        {
          "table": "cards",
          "column": "toughness",
          "value": "1",
          "sim": 1.0
        },
        {
          "table": "foreign_data",
          "column": "language",
          "value": "Japanese",
          "sim": 1.0
        },
        {
          "table": "set_translations",
          "column": "language",
          "value": "Japanese",
          "sim": 1.0
        },
        {
          "table": "cards",
          "column": "flavorText",
          "value": "Japan",
          "sim": 0.578125
        },
        {
          "table": "cards",
          "column": "watermark",
          "value": "japanjunior",
          "sim": 0.3046875
        },
        {
          "table": "cards",
          "column": "artist",
          "value": "Cristi Balanescu",
          "sim": 0.078125
        }
      ],
      "schema_hints": [
        "isForeignOnly",
        "isFoilOnly",
        "language",
        "set ID"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "sets.isForeignOnly: To identify sets that are not available outside of the United States, as per the evidence provided.\nsets.isFoilOnly: To filter for sets that contain foil cards, as specified in the user's question.\nset_translations.language: To filter for sets that have Japanese writing, as requested by the user.\nsets.id: The user explicitly requested the set ID in the response.\nsets.name: To provide the name of the set that meets the specified criteria.\nsets.code: This is the primary key for",
      "gt_executed_ok": true,
      "gt_row_count": 10,
      "oracle_match": true,
      "unique_sql_count": 6
    },
    {
      "question_id": 601,
      "db_id": "codebase_community",
      "difficulty": "simple",
      "question": "What is the score and the link type ID for post ID 395?",
      "evidence": "",
      "ground_truth_sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 INNER JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T2.PostId = 395",
      "s1_fields": [
        [
          "postLinks",
          "Id"
        ],
        [
          "postLinks",
          "LinkTypeId"
        ],
        [
          "postLinks",
          "PostId"
        ],
        [
          "postLinks",
          "RelatedPostId"
        ],
        [
          "posts",
          "Id"
        ],
        [
          "posts",
          "LastEditorUserId"
        ],
        [
          "posts",
          "OwnerUserId"
        ],
        [
          "posts",
          "ParentId"
        ],
        [
          "posts",
          "Score"
        ]
      ],
      "s2_fields": [
        [
          "postHistory",
          "Id"
        ],
        [
          "postHistory",
          "PostHistoryTypeId"
        ],
        [
          "postHistory",
          "PostId"
        ],
        [
          "postHistory",
          "UserId"
        ],
        [
          "postLinks",
          "Id"
        ],
        [
          "postLinks",
          "LinkTypeId"
        ],
        [
          "postLinks",
          "PostId"
        ],
        [
          "postLinks",
          "RelatedPostId"
        ],
        [
          "posts",
          "Id"
        ],
        [
          "posts",
          "LastEditorUserId"
        ],
        [
          "posts",
          "OwnerUserId"
        ],
        [
          "posts",
          "ParentId"
        ],
        [
          "posts",
          "Score"
        ],
        [
          "votes",
          "Id"
        ],
        [
          "votes",
          "PostId"
        ],
        [
          "votes",
          "UserId"
        ],
        [
          "votes",
          "VoteTypeId"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 LEFT JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 INNER JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 INNER JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 INNER JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 INNER JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 INNER JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 INNER JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 INNER JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 INNER JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 INNER JOIN postLinks AS T2 ON T1.Id = T2.PostId WHERE T1.Id = 395",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 38.03629803657532,
      "matched_cells": [
        {
          "table": "postHistory",
          "column": "Comment",
          "value": "395",
          "sim": 1.0
        },
        {
          "table": "users",
          "column": "DisplayName",
          "value": "user239501",
          "sim": 0.171875
        },
        {
          "table": "postHistory",
          "column": "UserDisplayName",
          "value": "user3959",
          "sim": 0.15625
        },
        {
          "table": "posts",
          "column": "OwnerDisplayName",
          "value": "user3959",
          "sim": 0.15625
        }
      ],
      "schema_hints": [
        "score",
        "link type ID",
        "post ID"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "posts.Score: To find the score of the post as requested in the question.\npostLinks.LinkTypeId: To find the link type ID as requested in the question.\npostLinks.PostId: To filter the results for the post with ID 395.\nposts.Id: To filter the results for the post with ID 395.\npostHistory.PostId: To identify the post with ID 395.\nvotes.VoteTypeId: To calculate the score of the post based on upvotes and downvotes.\npostHistory.PostHistoryTypeId: To identify the link type ID associated with the post's ",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 3
    },
    {
      "question_id": 571,
      "db_id": "codebase_community",
      "difficulty": "moderate",
      "question": "For the user No.24, how many times is the number of his/her posts compared to his/her votes?",
      "evidence": "user no. 24 refers to UserId = OwnerUserId = '24'; times of his/her post than votes = Divide (Count(post.Id), Count(votes.Id))",
      "ground_truth_sql": "SELECT CAST(COUNT(T2.Id) AS REAL) / COUNT(DISTINCT T1.Id) FROM votes AS T1 INNER JOIN posts AS T2 ON T1.UserId = T2.OwnerUserId WHERE T1.UserId = 24",
      "s1_fields": [
        [
          "posts",
          "Id"
        ],
        [
          "posts",
          "LastEditorUserId"
        ],
        [
          "posts",
          "OwnerUserId"
        ],
        [
          "posts",
          "ParentId"
        ],
        [
          "votes",
          "Id"
        ],
        [
          "votes",
          "PostId"
        ],
        [
          "votes",
          "UserId"
        ]
      ],
      "s2_fields": [
        [
          "postHistory",
          "Id"
        ],
        [
          "postHistory",
          "PostId"
        ],
        [
          "postHistory",
          "UserId"
        ],
        [
          "posts",
          "Id"
        ],
        [
          "posts",
          "LastEditorUserId"
        ],
        [
          "posts",
          "OwnerUserId"
        ],
        [
          "posts",
          "ParentId"
        ],
        [
          "users",
          "Id"
        ],
        [
          "votes",
          "CreationDate"
        ],
        [
          "votes",
          "Id"
        ],
        [
          "votes",
          "PostId"
        ],
        [
          "votes",
          "UserId"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT CAST(COUNT(DISTINCT T1.Id) AS REAL) / COUNT(DISTINCT T2.Id) FROM posts AS T1 INNER JOIN votes AS T2 ON T1.OwnerUserId = T2.UserId WHERE T1.OwnerUserId = 24 AND T2.UserId = 24",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT CAST(COUNT(DISTINCT T1.Id) AS REAL) / COUNT(DISTINCT T2.Id) FROM posts AS T1 INNER JOIN votes AS T2 ON T1.OwnerUserId = T2.UserId WHERE T1.OwnerUserId = 24",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT CAST(COUNT(DISTINCT T1.Id) AS REAL) / COUNT(DISTINCT T2.Id) FROM posts AS T1 INNER JOIN votes AS T2 ON T1.OwnerUserId = T2.UserId WHERE T1.OwnerUserId = 24",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT CAST( ( SELECT COUNT(T1.Id) FROM posts AS T1 WHERE T1.OwnerUserId = 24 ) AS REAL ) / ( SELECT COUNT(T2.Id) FROM votes AS T2 WHERE T2.UserId = 24 ) AS posts_per_vote_ratio",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH User24PostCount AS ( SELECT COUNT(Id) AS PostCount FROM posts WHERE OwnerUserId = 24 ), User24VoteCount AS ( SELECT COUNT(Id) AS VoteCount FROM votes WHERE UserId = 24 ) SELECT CASE WHEN T2.VoteCount = 0 THEN NULL ELSE CAST(T1.PostCount AS REAL) / T2.VoteCount END AS Ratio_Posts_to_Votes FROM User24PostCount AS T1, User24VoteCount AS T2",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT CAST(COUNT(DISTINCT T1.Id) AS REAL) / COUNT(DISTINCT T2.Id) FROM posts AS T1 INNER JOIN votes AS T2 ON T1.OwnerUserId = T2.UserId WHERE T1.OwnerUserId = 24",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH UserPosts AS ( SELECT COUNT(Id) AS post_count FROM posts WHERE OwnerUserId = 24 ), UserVotes AS ( SELECT COUNT(Id) AS vote_count FROM votes WHERE UserId = 24 ) SELECT CAST(T1.post_count AS REAL) / T2.vote_count FROM UserPosts AS T1, UserVotes AS T2",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH UserPosts AS ( SELECT COUNT(Id) AS PostCount FROM posts WHERE OwnerUserId = 24 ), UserVotes AS ( SELECT COUNT(Id) AS VoteCount FROM votes WHERE UserId = 24 ) SELECT CAST(T1.PostCount AS REAL) / T2.VoteCount FROM UserPosts AS T1 CROSS JOIN UserVotes AS T2",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT CAST(T1.pc AS REAL) / T2.vc FROM (SELECT COUNT(Id) AS pc FROM posts WHERE OwnerUserId = 24) AS T1, (SELECT COUNT(Id) AS vc FROM votes WHERE UserId = 24) AS T2",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT CAST(T1.cnt AS REAL) / T2.cnt FROM (SELECT count(*) AS cnt FROM posts WHERE OwnerUserId = 24) AS T1, (SELECT count(*) AS cnt FROM votes WHERE UserId = 24) AS T2",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT CAST(T1.cnt AS REAL) / T2.cnt FROM (SELECT count(*) AS cnt FROM posts WHERE OwnerUserId = 24) AS T1, (SELECT count(*) AS cnt FROM votes WHERE UserId = 24) AS T2",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 64.9930489063263,
      "matched_cells": [
        {
          "table": "postHistory",
          "column": "Comment",
          "value": "24",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "post.Id",
        "votes.Id",
        "UserId",
        "OwnerUserId"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "posts.OwnerUserId: To filter the posts for the user with ID 24.\nposts.Id: To count the number of posts for the user.\nvotes.UserId: To filter the votes for the user with ID 24.\nvotes.Id: To count the number of votes from the user.\nusers.Id: To identify the user with ID 24.\npostHistory.UserId: To count the number of posts associated with the user.\nvotes.CreationDate: To count the number of votes from the user. Accessing the votes table is necessary, and this is a column within it.",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": false,
      "unique_sql_count": 8
    },
    {
      "question_id": 586,
      "db_id": "codebase_community",
      "difficulty": "challenging",
      "question": "Which user added a bounty amount of 50 to the post title mentioning variance?",
      "evidence": "bounty amount of 50 refers to BountyAmount = 50; user refers to DisplayName; title mentioning variance refers to Title include 'variance'",
      "ground_truth_sql": "SELECT T3.DisplayName, T1.Title FROM posts AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.PostId INNER JOIN users AS T3 ON T3.Id = T2.UserId WHERE T2.BountyAmount = 50 AND T1.Title LIKE '%variance%'",
      "s1_fields": [
        [
          "posts",
          "Id"
        ],
        [
          "posts",
          "LastEditorUserId"
        ],
        [
          "posts",
          "OwnerUserId"
        ],
        [
          "posts",
          "ParentId"
        ],
        [
          "posts",
          "Title"
        ],
        [
          "users",
          "AccountId"
        ],
        [
          "users",
          "DisplayName"
        ],
        [
          "users",
          "Id"
        ],
        [
          "votes",
          "BountyAmount"
        ],
        [
          "votes",
          "Id"
        ],
        [
          "votes",
          "PostId"
        ],
        [
          "votes",
          "UserId"
        ]
      ],
      "s2_fields": [
        [
          "postHistory",
          "Comment"
        ],
        [
          "postHistory",
          "Id"
        ],
        [
          "postHistory",
          "PostId"
        ],
        [
          "postHistory",
          "Text"
        ],
        [
          "postHistory",
          "UserDisplayName"
        ],
        [
          "postHistory",
          "UserId"
        ],
        [
          "posts",
          "Id"
        ],
        [
          "posts",
          "LastEditorUserId"
        ],
        [
          "posts",
          "OwnerUserId"
        ],
        [
          "posts",
          "ParentId"
        ],
        [
          "posts",
          "Title"
        ],
        [
          "users",
          "AccountId"
        ],
        [
          "users",
          "DisplayName"
        ],
        [
          "users",
          "Id"
        ],
        [
          "votes",
          "BountyAmount"
        ],
        [
          "votes",
          "Id"
        ],
        [
          "votes",
          "PostId"
        ],
        [
          "votes",
          "UserId"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.UserId INNER JOIN posts AS T3 ON T2.PostId = T3.Id WHERE T2.BountyAmount = 50 AND T3.Title LIKE '%variance%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.UserId INNER JOIN posts AS T3 ON T2.PostId = T3.Id WHERE T2.BountyAmount = 50 AND T3.Title LIKE '%variance%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.UserId INNER JOIN posts AS T3 ON T2.PostId = T3.Id WHERE T2.BountyAmount = 50 AND T3.Title LIKE '%variance%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T3.DisplayName FROM posts AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.PostId INNER JOIN users AS T3 ON T2.UserId = T3.Id WHERE T1.Title LIKE '%variance%' AND T2.BountyAmount = 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.UserId INNER JOIN posts AS T3 ON T2.PostId = T3.Id WHERE T2.BountyAmount = 50 AND T3.Title LIKE '%variance%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.UserId INNER JOIN posts AS T3 ON T2.PostId = T3.Id WHERE T2.BountyAmount = 50 AND T3.Title LIKE '%variance%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH PostWithVariance AS ( SELECT Id FROM posts WHERE Title LIKE '%variance%' ), VoteWithBounty AS ( SELECT PostId, UserId FROM votes WHERE BountyAmount = 50 ) SELECT T3.DisplayName FROM PostWithVariance AS T1 INNER JOIN VoteWithBounty AS T2 ON T1.Id = T2.PostId INNER JOIN users AS T3 ON T2.UserId = T3.Id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH PostWithVariance AS ( SELECT Id FROM posts WHERE Title LIKE '%variance%' ), BountyUser AS ( SELECT PostId, UserId FROM votes WHERE BountyAmount = 50 ) SELECT T3.DisplayName FROM PostWithVariance AS T1 INNER JOIN BountyUser AS T2 ON T1.Id = T2.PostId INNER JOIN users AS T3 ON T2.UserId = T3.Id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T3.DisplayName FROM votes AS T1 INNER JOIN posts AS T2 ON T1.PostId = T2.Id INNER JOIN users AS T3 ON T1.UserId = T3.Id WHERE T1.BountyAmount = 50 AND T2.Title LIKE '%variance%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.UserId INNER JOIN posts AS T3 ON T2.PostId = T3.Id WHERE T2.BountyAmount = 50 AND T3.Title LIKE '%variance%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T3.DisplayName FROM votes AS T1 INNER JOIN posts AS T2 ON T1.PostId = T2.Id INNER JOIN users AS T3 ON T1.UserId = T3.Id WHERE T1.BountyAmount = 50 AND T2.Title LIKE '%variance%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 37.577990770339966,
      "matched_cells": [
        {
          "table": "postHistory",
          "column": "Comment",
          "value": "variance",
          "sim": 1.0
        },
        {
          "table": "tags",
          "column": "TagName",
          "value": "variance",
          "sim": 1.0
        },
        {
          "table": "badges",
          "column": "Name",
          "value": "variance",
          "sim": 1.0
        },
        {
          "table": "posts",
          "column": "Tags",
          "value": "<variance>",
          "sim": 0.6875
        }
      ],
      "schema_hints": [
        "BountyAmount",
        "DisplayName",
        "Title"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "votes.BountyAmount: To filter for votes that have a bounty amount of 50.\nposts.Title: To find posts with titles that mention 'variance'.\nusers.DisplayName: To identify the name of the user who added the bounty.\nvotes.PostId: To link the bounty vote to a specific post.\nvotes.UserId: To identify the user who cast the vote (and added the bounty).\nposts.Id: To join with the 'votes' table on PostId to identify the post.\nusers.AccountId: To link the user from the 'votes' table to the 'users' table to ",
      "gt_executed_ok": true,
      "gt_row_count": 2,
      "oracle_match": false,
      "unique_sql_count": 5
    },
    {
      "question_id": 1519,
      "db_id": "debit_card_specializing",
      "difficulty": "simple",
      "question": "What was the product id of the transaction happened at 2012/8/23 21:20:00?",
      "evidence": "'2012/8/23 21:20:00' can refer to date = '2012-08-23' AND T1.time = '21:20:00' in the database",
      "ground_truth_sql": "SELECT T1.ProductID FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T1.Date = '2012-08-23' AND T1.Time = '21:20:00'",
      "s1_fields": [
        [
          "transactions_1k",
          "Date"
        ],
        [
          "transactions_1k",
          "ProductID"
        ],
        [
          "transactions_1k",
          "Time"
        ],
        [
          "transactions_1k",
          "TransactionID"
        ]
      ],
      "s2_fields": [
        [
          "products",
          "ProductID"
        ],
        [
          "transactions_1k",
          "Date"
        ],
        [
          "transactions_1k",
          "ProductID"
        ],
        [
          "transactions_1k",
          "Time"
        ],
        [
          "transactions_1k",
          "TransactionID"
        ],
        [
          "yearmonth",
          "CustomerID"
        ],
        [
          "yearmonth",
          "Date"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-23' AND Time = '21:20:00'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 37.42609715461731,
      "matched_cells": [
        {
          "table": "transactions_1k",
          "column": "Time",
          "value": "21:20:00",
          "sim": 1.0
        },
        {
          "table": "yearmonth",
          "column": "Date",
          "value": "201201",
          "sim": 0.234375
        },
        {
          "table": "transactions_1k",
          "column": "Date",
          "value": "2012-08-23",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "product id",
        "date",
        "T1.time"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "transactions_1k.ProductID: The user is asking for the product ID.\ntransactions_1k.Date: To filter the transaction based on the given date \"2012/8/23\".\ntransactions_1k.Time: To filter the transaction based on the given time \"21:20:00\".\nproducts.ProductID: The user is asking for the 'product id'. This column directly provides that information.\nyearmonth.Date: The user is asking for a transaction at a specific date '2012/8/23'. This column is needed to filter for that date.",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 1
    },
    {
      "question_id": 1474,
      "db_id": "debit_card_specializing",
      "difficulty": "moderate",
      "question": "Which customers, paying in CZK, consumed the most gas in 2011?",
      "evidence": "Year 2011 can be presented as Between 201101 And 201112, which means between January and December in 2011",
      "ground_truth_sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN 201101 AND 201112 GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) DESC LIMIT 1",
      "s1_fields": [
        [
          "customers",
          "Currency"
        ],
        [
          "customers",
          "CustomerID"
        ],
        [
          "yearmonth",
          "Consumption"
        ],
        [
          "yearmonth",
          "CustomerID"
        ],
        [
          "yearmonth",
          "Date"
        ]
      ],
      "s2_fields": [
        [
          "customers",
          "Currency"
        ],
        [
          "customers",
          "CustomerID"
        ],
        [
          "products",
          "Description"
        ],
        [
          "products",
          "ProductID"
        ],
        [
          "transactions_1k",
          "Amount"
        ],
        [
          "transactions_1k",
          "CustomerID"
        ],
        [
          "transactions_1k",
          "Date"
        ],
        [
          "transactions_1k",
          "ProductID"
        ],
        [
          "transactions_1k",
          "TransactionID"
        ],
        [
          "yearmonth",
          "Consumption"
        ],
        [
          "yearmonth",
          "CustomerID"
        ],
        [
          "yearmonth",
          "Date"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID HAVING SUM(T2.Consumption) = ( SELECT MAX(TotalConsumption) FROM ( SELECT SUM(T2_sub.Consumption) AS TotalConsumption FROM customers AS T1_sub INNER JOIN yearmonth AS T2_sub ON T1_sub.CustomerID = T2_sub.CustomerID WHERE T1_sub.Currency = 'CZK' AND T2_sub.Date BETWEEN '201101' AND '201112' GROUP BY T1_sub.CustomerID ) AS SubqueryMaxConsumption )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID HAVING SUM(T2.Consumption) = ( SELECT MAX(TotalConsumption) FROM ( SELECT SUM(T4.Consumption) AS TotalConsumption FROM customers AS T3 INNER JOIN yearmonth AS T4 ON T3.CustomerID = T4.CustomerID WHERE T3.Currency = 'CZK' AND T4.Date BETWEEN '201101' AND '201112' GROUP BY T3.CustomerID ) )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.CustomerID, SUM(T2.Consumption) AS TotalConsumption FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID ORDER BY TotalConsumption DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID HAVING SUM(T2.Consumption) = ( SELECT MAX(TotalConsumption) FROM ( SELECT SUM(T4.Consumption) AS TotalConsumption FROM customers AS T3 INNER JOIN yearmonth AS T4 ON T3.CustomerID = T4.CustomerID WHERE T3.Currency = 'CZK' AND T4.Date BETWEEN '201101' AND '201112' GROUP BY T3.CustomerID ) )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH CustomerConsumption AS ( SELECT T1.CustomerID, SUM(T2.Consumption) AS TotalConsumption FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID ) SELECT CustomerID FROM CustomerConsumption ORDER BY TotalConsumption DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH CustomerConsumption AS ( SELECT c.CustomerID, SUM(y.Consumption) AS TotalConsumption FROM customers AS c JOIN yearmonth AS y ON c.CustomerID = y.CustomerID WHERE c.Currency = 'CZK' AND y.Date BETWEEN '201101' AND '201112' GROUP BY c.CustomerID ), RankedConsumption AS ( SELECT CustomerID, RANK() OVER (ORDER BY TotalConsumption DESC) AS ConsumptionRank FROM CustomerConsumption ) SELECT CustomerID FROM RankedConsumption WHERE ConsumptionRank = 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Date BETWEEN '201101' AND '201112' GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 38.60660791397095,
      "matched_cells": [
        {
          "table": "customers",
          "column": "Currency",
          "value": "CZK",
          "sim": 1.0
        },
        {
          "table": "yearmonth",
          "column": "Date",
          "value": "201112",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "customers",
        "gas",
        "paying",
        "consumed"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "customers.Currency: Needed to filter customers who pay in CZK, as specified in the question.\nyearmonth.Consumption: This is the primary metric required to determine which customers \"consumed the most\".\nyearmonth.Date: Needed to filter the data for the year 2011, as specified in the question.\ncustomers.CustomerID: Needed to identify and group the consumption by each unique customer.\nyearmonth.CustomerID: Required to join the 'customers' table with the 'yearmonth' table to link consumption data to",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 6
    },
    {
      "question_id": 1526,
      "db_id": "debit_card_specializing",
      "difficulty": "challenging",
      "question": "For the customer who paid 634.8 in 2012/8/25, what was the consumption decrease rate from Year 2012 to 2013?",
      "evidence": "'2012/8/24' can be represented by '2012-08-24'; Consumption decrease rate = (consumption_2012 - consumption_2013) / consumption_2012",
      "ground_truth_sql": "SELECT CAST(SUM(IIF(SUBSTR(Date, 1, 4) = '2012', Consumption, 0)) - SUM(IIF(SUBSTR(Date, 1, 4) = '2013', Consumption, 0)) AS FLOAT) / SUM(IIF(SUBSTR(Date, 1, 4) = '2012', Consumption, 0)) FROM yearmonth WHERE CustomerID = ( SELECT T1.CustomerID FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T1.Date = '2012-08-25' AND T1.Price = 634.8 )",
      "s1_fields": [
        [
          "transactions_1k",
          "CustomerID"
        ],
        [
          "transactions_1k",
          "Date"
        ],
        [
          "transactions_1k",
          "Price"
        ],
        [
          "transactions_1k",
          "TransactionID"
        ],
        [
          "yearmonth",
          "Consumption"
        ],
        [
          "yearmonth",
          "CustomerID"
        ],
        [
          "yearmonth",
          "Date"
        ]
      ],
      "s2_fields": [
        [
          "customers",
          "CustomerID"
        ],
        [
          "transactions_1k",
          "Amount"
        ],
        [
          "transactions_1k",
          "CardID"
        ],
        [
          "transactions_1k",
          "CustomerID"
        ],
        [
          "transactions_1k",
          "Date"
        ],
        [
          "transactions_1k",
          "Price"
        ],
        [
          "transactions_1k",
          "TransactionID"
        ],
        [
          "yearmonth",
          "Consumption"
        ],
        [
          "yearmonth",
          "CustomerID"
        ],
        [
          "yearmonth",
          "Date"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT CAST((T.consumption_2012 - T.consumption_2013) AS REAL) / T.consumption_2012 FROM ( SELECT SUM(CASE WHEN SUBSTR(T1.Date, 1, 4) = '2012' THEN T1.Consumption ELSE 0 END) AS consumption_2012, SUM(CASE WHEN SUBSTR(T1.Date, 1, 4) = '2013' THEN T1.Consumption ELSE 0 END) AS consumption_2013 FROM yearmonth AS T1 JOIN ( SELECT CustomerID FROM transactions_1k WHERE Price = 634.8 AND Date = '2012-08-25' ) AS T2 ON T1.CustomerID = T2.CustomerID ) AS T",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT ( SUM(CASE WHEN SUBSTR(T1.Date, 1, 4) = '2012' THEN T1.Consumption ELSE 0 END) - SUM(CASE WHEN SUBSTR(T1.Date, 1, 4) = '2013' THEN T1.Consumption ELSE 0 END) ) * 1.0 / SUM(CASE WHEN SUBSTR(T1.Date, 1, 4) = '2012' THEN T1.Consumption ELSE 0 END) FROM yearmonth AS T1 WHERE T1.CustomerID = ( SELECT CustomerID FROM transactions_1k WHERE Price = 634.8 AND Date = '2012-08-25' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "WITH TargetCustomer AS ( SELECT CustomerID FROM transactions_1k WHERE Price = 634.8 AND Date = '2012-08-25' ), YearlyConsumption AS ( SELECT SUM(CASE WHEN T2.Date LIKE '2012%' THEN T2.Consumption ELSE 0 END) AS consumption_2012, SUM(CASE WHEN T2.Date LIKE '2013%' THEN T2.Consumption ELSE 0 END) AS consumption_2013 FROM yearmonth AS T2 JOIN TargetCustomer AS T1 ON T2.CustomerID = T1.CustomerID ) SELECT (YC.consumption_2012 - YC.consumption_2013) * 1.0 / YC.consumption_2012 FROM YearlyConsumption AS YC",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "WITH CustomerData AS ( -- Step 1: Find the CustomerID for the specified transaction SELECT T1.CustomerID FROM transactions_1k AS T1 WHERE T1.Price = 634.8 AND T1.Date = '2012-08-25' ), CustomerYearlyConsumption AS ( -- Step 2 & 3: Calculate total consumption for the identified customer for years 2012 and 2013 SELECT SUM(CASE WHEN SUBSTR(T2.Date, 1, 4) = '2012' THEN T2.Consumption ELSE 0 END) AS consumption_2012, SUM(CASE WHEN SUBSTR(T2.Date, 1, 4) = '2013' THEN T2.Consumption ELSE 0 END) AS consumption_2013 FROM yearmonth AS T2 JOIN CustomerData AS CD ON T2.CustomerID = CD.CustomerID ) -- Step 4: Calculate the consumption decrease rate SELECT (CYC.consumption_2012 - CYC.consumption_2013) * 1.0 / NULLIF(CYC.consumption_2012, 0) AS consumption_decrease_rate FROM CustomerYearlyConsumption AS CYC",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT (SUM(CASE WHEN SUBSTR(T2.Date, 1, 4) = '2012' THEN T2.Consumption ELSE 0 END) - SUM(CASE WHEN SUBSTR(T2.Date, 1, 4) = '2013' THEN T2.Consumption ELSE 0 END)) * 1.0 / SUM(CASE WHEN SUBSTR(T2.Date, 1, 4) = '2012' THEN T2.Consumption ELSE 0 END) FROM transactions_1k AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Price = 634.8 AND T1.Date = '2012-08-25'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH TargetCustomers AS ( -- Find the CustomerID(s) who made a transaction with Price 634.8 on 2012-08-25 SELECT DISTINCT CustomerID FROM transactions_1k WHERE Price = 634.8 AND Date = '2012-08-25' ), CustomerYearlyConsumption AS ( -- Calculate the total consumption for 2012 and 2013 for the identified customer(s) SELECT tc.CustomerID, SUM(CASE WHEN ym.Date LIKE '2012%' THEN ym.Consumption ELSE 0 END) AS consumption_2012, SUM(CASE WHEN ym.Date LIKE '2013%' THEN ym.Consumption ELSE 0 END) AS consumption_2013 FROM TargetCustomers AS tc JOIN yearmonth AS ym ON tc.CustomerID = ym.CustomerID GROUP BY tc.CustomerID ) -- Calculate the consumption decrease rate using the provided formula SELECT CASE WHEN cyc.consumption_2012 IS NULL OR cyc.consumption_2012 = 0 THEN NULL -- Avoid division by zero if 2012 consumption is 0 or not found ELSE (cyc.consumption_2012 - cyc.consumption_2013) * 1.0 / cyc.consumption_2012 END AS consumption_decrease_rate FROM CustomerYearlyConsumption AS cyc",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH CustomerInfo AS ( SELECT CustomerID FROM transactions_1k WHERE Price = 634.8 AND Date = '2012-08-25' ), AnnualConsumption AS ( SELECT SUM(CASE WHEN SUBSTR(T1.Date, 1, 4) = '2012' THEN T1.Consumption ELSE 0 END) AS consumption_2012, SUM(CASE WHEN SUBSTR(T1.Date, 1, 4) = '2013' THEN T1.Consumption ELSE 0 END) AS consumption_2013 FROM yearmonth AS T1 INNER JOIN CustomerInfo AS T2 ON T1.CustomerID = T2.CustomerID WHERE SUBSTR(T1.Date, 1, 4) IN ('2012', '2013') ) SELECT (consumption_2012 - consumption_2013) * 1.0 / consumption_2012 AS \"consumption decrease rate\" FROM AnnualConsumption",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH CustomerInfo AS ( -- First, identify the customer who made the specific transaction. SELECT CustomerID FROM transactions_1k WHERE Price = 634.8 AND Date = '2012-08-25' ), AggregatedConsumption AS ( -- Next, calculate the total consumption for that customer in 2012 and 2013. SELECT SUM(CASE WHEN SUBSTR(T1.Date, 1, 4) = '2012' THEN T1.Consumption ELSE 0 END) AS consumption_2012, SUM(CASE WHEN SUBSTR(T1.Date, 1, 4) = '2013' THEN T1.Consumption ELSE 0 END) AS consumption_2013 FROM yearmonth AS T1 INNER JOIN CustomerInfo AS T2 ON T1.CustomerID = T2.CustomerID WHERE SUBSTR(T1.Date, 1, 4) IN ('2012', '2013') ) -- Finally, calculate the consumption decrease rate using the provided formula. SELECT (consumption_2012 - consumption_2013) * 1.0 / consumption_2012 AS \"consumption decrease rate\" FROM AggregatedConsumption",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT (T1.c2 - T1.c3) / T1.c2 FROM (SELECT sum(CASE WHEN substr(Date, 1, 4) = '2012' THEN Consumption ELSE 0 END) AS c2, sum(CASE WHEN substr(Date, 1, 4) = '2013' THEN Consumption ELSE 0 END) AS c3 FROM yearmonth WHERE CustomerID = (SELECT CustomerID FROM transactions_1k WHERE Price = 634.8 AND Date = '2012-08-25')) AS T1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "",
          "error_flag": true,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "error_flag_or_empty",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "",
          "error_flag": true,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "error_flag_or_empty",
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 118.70572781562805,
      "matched_cells": [
        {
          "table": "yearmonth",
          "column": "Date",
          "value": "201201",
          "sim": 0.6484375
        },
        {
          "table": "transactions_1k",
          "column": "Date",
          "value": "2012-08-24",
          "sim": 1.0
        }
      ],
      "schema_hints": [],
      "few_shot_count": 8,
      "selection_reasoning": "transactions_1k.CustomerID: To identify the customer who made the transaction.\ntransactions_1k.Price: To find the transaction where the customer paid 634.8.\ntransactions_1k.Date: To find the transaction that occurred on the specified date of 2012/8/25.\nyearmonth.Consumption: To calculate the total consumption for the years 2012 and 2013 for the identified customer.\nyearmonth.Date: To filter the consumption data for the years 2012 and 2013.\nyearmonth.CustomerID: To link the customer from the tran",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 9
    },
    {
      "question_id": 1027,
      "db_id": "european_football_2",
      "difficulty": "simple",
      "question": "Indicate the full names of the top 10 players with the highest number of penalties.",
      "evidence": "full name refers to player_name; players with highest number of penalties refers to MAX(penalties);",
      "ground_truth_sql": "SELECT t2.player_name FROM Player_Attributes AS t1 INNER JOIN Player AS t2 ON t1.id = t2.id ORDER BY t1.penalties DESC LIMIT 10",
      "s1_fields": [
        [
          "Player",
          "id"
        ],
        [
          "Player",
          "player_name"
        ],
        [
          "Player_Attributes",
          "id"
        ],
        [
          "Player_Attributes",
          "penalties"
        ],
        [
          "Player_Attributes",
          "player_api_id"
        ],
        [
          "Player_Attributes",
          "player_fifa_api_id"
        ]
      ],
      "s2_fields": [
        [
          "Match",
          "away_player_1"
        ],
        [
          "Match",
          "away_player_10"
        ],
        [
          "Match",
          "away_player_11"
        ],
        [
          "Match",
          "away_player_3"
        ],
        [
          "Match",
          "away_player_5"
        ],
        [
          "Match",
          "away_player_7"
        ],
        [
          "Match",
          "away_player_8"
        ],
        [
          "Match",
          "away_player_9"
        ],
        [
          "Match",
          "home_player_3"
        ],
        [
          "Match",
          "home_player_5"
        ],
        [
          "Player",
          "id"
        ],
        [
          "Player",
          "player_name"
        ],
        [
          "Player_Attributes",
          "id"
        ],
        [
          "Player_Attributes",
          "penalties"
        ],
        [
          "Player_Attributes",
          "player_api_id"
        ],
        [
          "Player_Attributes",
          "player_fifa_api_id"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.player_name FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.id = T2.player_api_id ORDER BY T2.penalties DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.player_name FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.id = T2.player_api_id ORDER BY T2.penalties DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.player_name FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.player_api_id = T2.player_api_id ORDER BY T2.penalties DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.player_name FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.player_api_id = T2.player_api_id ORDER BY T2.penalties DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.player_name FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.id = T2.player_api_id ORDER BY T2.penalties DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.player_name FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.player_api_id = T2.player_api_id ORDER BY T2.penalties DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH Player_Max_Penalties AS ( SELECT player_api_id, MAX(penalties) AS max_penalties FROM Player_Attributes GROUP BY player_api_id ) SELECT p.player_name FROM Player AS p JOIN Player_Max_Penalties AS pmp ON p.id = pmp.player_api_id ORDER BY pmp.max_penalties DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH PlayerMaxPenalties AS ( SELECT player_api_id, MAX(penalties) AS max_penalty_score FROM Player_Attributes GROUP BY player_api_id ) SELECT T2.player_name FROM PlayerMaxPenalties AS T1 JOIN Player AS T2 ON T1.player_api_id = T2.id ORDER BY T1.max_penalty_score DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.player_name FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.id = T2.player_api_id GROUP BY T1.id ORDER BY MAX(T2.penalties) DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.player_name FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.id = T2.player_api_id GROUP BY T1.player_name ORDER BY MAX(T2.penalties) DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.player_name FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.id = T2.player_api_id GROUP BY T1.id ORDER BY MAX(T2.penalties) DESC LIMIT 10",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 10,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 79.33908295631409,
      "matched_cells": [],
      "schema_hints": [
        "player_name",
        "penalties"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "Player.player_name: The user wants to know the full names of the players.\nPlayer_Attributes.penalties: The user wants to rank players by the highest number of penalties, and this column contains that value.\nPlayer.player_fifa_api_id: To identify the players.\nMatch.goal: The XML data in this column may contain information about which players scored penalties.",
      "gt_executed_ok": true,
      "gt_row_count": 10,
      "oracle_match": false,
      "unique_sql_count": 6
    },
    {
      "question_id": 1025,
      "db_id": "european_football_2",
      "difficulty": "moderate",
      "question": "Give the name of the league had the most goals in the 2016 season?",
      "evidence": "league that had the most goals refers to MAX(SUM(home_team_goal, away_team_goal)); 2016 season refers to season = '2015/2016';",
      "ground_truth_sql": "SELECT t2.name FROM Match AS t1 INNER JOIN League AS t2 ON t1.league_id = t2.id WHERE t1.season = '2015/2016' GROUP BY t2.name ORDER BY SUM(t1.home_team_goal + t1.away_team_goal) DESC LIMIT 1",
      "s1_fields": [
        [
          "League",
          "country_id"
        ],
        [
          "League",
          "id"
        ],
        [
          "League",
          "name"
        ],
        [
          "Match",
          "away_player_1"
        ],
        [
          "Match",
          "away_player_10"
        ],
        [
          "Match",
          "away_player_2"
        ],
        [
          "Match",
          "away_player_5"
        ],
        [
          "Match",
          "away_player_7"
        ],
        [
          "Match",
          "away_player_9"
        ],
        [
          "Match",
          "away_team_api_id"
        ],
        [
          "Match",
          "away_team_goal"
        ],
        [
          "Match",
          "country_id"
        ],
        [
          "Match",
          "home_player_3"
        ],
        [
          "Match",
          "home_player_5"
        ],
        [
          "Match",
          "home_player_8"
        ],
        [
          "Match",
          "home_player_9"
        ],
        [
          "Match",
          "home_team_api_id"
        ],
        [
          "Match",
          "home_team_goal"
        ],
        [
          "Match",
          "league_id"
        ],
        [
          "Match",
          "season"
        ]
      ],
      "s2_fields": [
        [
          "League",
          "country_id"
        ],
        [
          "League",
          "id"
        ],
        [
          "League",
          "name"
        ],
        [
          "Match",
          "away_player_1"
        ],
        [
          "Match",
          "away_player_10"
        ],
        [
          "Match",
          "away_player_2"
        ],
        [
          "Match",
          "away_player_3"
        ],
        [
          "Match",
          "away_player_4"
        ],
        [
          "Match",
          "away_player_5"
        ],
        [
          "Match",
          "away_player_6"
        ],
        [
          "Match",
          "away_player_7"
        ],
        [
          "Match",
          "away_player_9"
        ],
        [
          "Match",
          "away_team_api_id"
        ],
        [
          "Match",
          "away_team_goal"
        ],
        [
          "Match",
          "country_id"
        ],
        [
          "Match",
          "home_player_1"
        ],
        [
          "Match",
          "home_player_3"
        ],
        [
          "Match",
          "home_player_5"
        ],
        [
          "Match",
          "home_player_8"
        ],
        [
          "Match",
          "home_player_9"
        ],
        [
          "Match",
          "home_team_api_id"
        ],
        [
          "Match",
          "home_team_goal"
        ],
        [
          "Match",
          "id"
        ],
        [
          "Match",
          "league_id"
        ],
        [
          "Match",
          "season"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT L.name FROM Match AS M JOIN League AS L ON M.league_id = L.id WHERE M.season = '2015/2016' GROUP BY L.name ORDER BY SUM(M.home_team_goal + M.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T2.name FROM Match AS T1 INNER JOIN League AS T2 ON T1.league_id = T2.id WHERE T1.season = '2015/2016' GROUP BY T2.name ORDER BY SUM(T1.home_team_goal + T1.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T2.name FROM Match AS T1 INNER JOIN League AS T2 ON T1.league_id = T2.id WHERE T1.season = '2015/2016' GROUP BY T2.name ORDER BY SUM(T1.home_team_goal + T1.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T2.name FROM Match AS T1 INNER JOIN League AS T2 ON T1.league_id = T2.id WHERE T1.season = '2015/2016' GROUP BY T1.league_id ORDER BY SUM(T1.home_team_goal + T1.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T2.name FROM Match AS T1 INNER JOIN League AS T2 ON T1.league_id = T2.id WHERE T1.season = '2015/2016' GROUP BY T2.name ORDER BY SUM(T1.home_team_goal + T1.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.name FROM Match AS T1 INNER JOIN League AS T2 ON T1.league_id = T2.id WHERE T1.season = '2015/2016' GROUP BY T2.name ORDER BY SUM(T1.home_team_goal + T1.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH LeagueTotalGoals AS ( SELECT league_id, SUM(home_team_goal + away_team_goal) AS total_goals FROM Match WHERE season = '2015/2016' GROUP BY league_id ) SELECT T2.name FROM LeagueTotalGoals AS T1 INNER JOIN League AS T2 ON T1.league_id = T2.id ORDER BY T1.total_goals DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH LeagueGoals AS ( SELECT league_id, SUM(home_team_goal + away_team_goal) AS total_goals FROM Match WHERE season = '2015/2016' GROUP BY league_id ) SELECT T2.name FROM LeagueGoals AS T1 INNER JOIN League AS T2 ON T1.league_id = T2.id ORDER BY T1.total_goals DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.name FROM Match AS T1 INNER JOIN League AS T2 ON T1.league_id = T2.id WHERE T1.season = '2015/2016' GROUP BY T2.name ORDER BY SUM(T1.home_team_goal + T1.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.name FROM Match AS T1 INNER JOIN League AS T2 ON T1.league_id = T2.id WHERE T1.season = '2015/2016' GROUP BY T2.name ORDER BY SUM(T1.home_team_goal + T1.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.name FROM Match AS T1 INNER JOIN League AS T2 ON T1.league_id = T2.id WHERE T1.season = '2015/2016' GROUP BY T2.name ORDER BY SUM(T1.home_team_goal + T1.away_team_goal) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 43.69099521636963,
      "matched_cells": [
        {
          "table": "Match",
          "column": "season",
          "value": "2015/2016",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "home_team_goal",
        "away_team_goal",
        "season"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "League.name: To display the name of the league that had the most goals.\nMatch.home_team_goal: To calculate the total number of goals scored in each match.\nMatch.away_team_goal: To calculate the total number of goals scored in each match.\nMatch.season: To filter the matches for the '2015/2016' season as specified in the question.\nMatch.league_id: To link the matches to their respective leagues in order to group goals by league.",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 5
    },
    {
      "question_id": 1031,
      "db_id": "european_football_2",
      "difficulty": "challenging",
      "question": "At present, calculate for the player's age who have a sprint speed of no less than 97 between 2013 to 2015.",
      "evidence": "players age at present = SUBTRACT((DATETIME(), birthday)); sprint speed of no less than 97 refers to sprint_speed > = 97; between 2013 to 2015 refers to YEAR(date) > = '2013' AND YEAR(date) < = '2015'; ",
      "ground_truth_sql": "SELECT DISTINCT DATETIME() - T2.birthday age FROM Player_Attributes AS t1 INNER JOIN Player AS t2 ON t1.player_api_id = t2.player_api_id WHERE STRFTIME('%Y',t1.`date`) >= '2013' AND STRFTIME('%Y',t1.`date`) <= '2015' AND t1.sprint_speed >= 97",
      "s1_fields": [
        [
          "Player",
          "birthday"
        ],
        [
          "Player",
          "id"
        ],
        [
          "Player_Attributes",
          "date"
        ],
        [
          "Player_Attributes",
          "id"
        ],
        [
          "Player_Attributes",
          "player_api_id"
        ],
        [
          "Player_Attributes",
          "player_fifa_api_id"
        ],
        [
          "Player_Attributes",
          "sprint_speed"
        ]
      ],
      "s2_fields": [
        [
          "Player",
          "birthday"
        ],
        [
          "Player",
          "id"
        ],
        [
          "Player_Attributes",
          "date"
        ],
        [
          "Player_Attributes",
          "id"
        ],
        [
          "Player_Attributes",
          "player_api_id"
        ],
        [
          "Player_Attributes",
          "player_fifa_api_id"
        ],
        [
          "Player_Attributes",
          "sprint_speed"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT CAST(strftime('%Y', 'now') - strftime('%Y', T2.birthday) - (strftime('%m-%d', 'now') < strftime('%m-%d', T2.birthday)) AS INTEGER) AS player_age FROM ( SELECT DISTINCT player_api_id FROM Player_Attributes AS T1 WHERE T1.sprint_speed >= 97 AND strftime('%Y', T1.date) BETWEEN '2013' AND '2015' ) AS SubQuery INNER JOIN Player AS T2 ON SubQuery.player_api_id = T2.id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT (STRFTIME('%Y', 'now') - STRFTIME('%Y', T2.birthday)) - (STRFTIME('%m-%d', 'now') < STRFTIME('%m-%d', T2.birthday)) AS current_age FROM Player_Attributes AS T1 INNER JOIN Player AS T2 ON T1.player_api_id = T2.id WHERE T1.sprint_speed >= 97 AND STRFTIME('%Y', T1.date) >= '2013' AND STRFTIME('%Y', T1.date) <= '2015'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT (STRFTIME('%Y', 'now') - STRFTIME('%Y', T2.birthday)) - (STRFTIME('%m-%d', 'now') < STRFTIME('%m-%d', T2.birthday)) AS player_age FROM Player_Attributes AS T1 INNER JOIN Player AS T2 ON T1.player_api_id = T2.id WHERE T1.sprint_speed >= 97 AND STRFTIME('%Y', T1.date) BETWEEN '2013' AND '2015'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT CAST((JULIANDAY('now') - JULIANDAY(T2.birthday)) / 365.25 AS INTEGER) AS player_age FROM Player_Attributes AS T1 INNER JOIN Player AS T2 ON T1.player_api_id = T2.id WHERE T1.sprint_speed >= 97 AND STRFTIME('%Y', T1.date) >= '2013' AND STRFTIME('%Y', T1.date) <= '2015'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT SUBTRACT(DATETIME(), T1.birthday) FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.id = T2.player_api_id WHERE T2.sprint_speed >= 97 AND STRFTIME('%Y', T2.date) >= '2013' AND STRFTIME('%Y', T2.date) <= '2015'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "no such function: SUBTRACT",
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT CAST((JULIANDAY('now') - JULIANDAY(T2.birthday)) / 365.25 AS INTEGER) AS player_age_at_present FROM Player AS T2 WHERE T2.id IN ( SELECT DISTINCT T1.player_api_id FROM Player_Attributes AS T1 WHERE T1.sprint_speed >= 97 AND STRFTIME('%Y', T1.date) BETWEEN '2013' AND '2015' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH Fast_Players AS ( SELECT DISTINCT player_api_id FROM Player_Attributes WHERE sprint_speed >= 97 AND STRFTIME('%Y', date) BETWEEN '2013' AND '2015' ) SELECT CAST(STRFTIME('%Y', 'now') - STRFTIME('%Y', T1.birthday) AS INTEGER) AS age FROM Player AS T1 INNER JOIN Fast_Players AS T2 ON T1.player_api_id = T2.player_api_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH Fast_Players_In_Period AS ( -- First, find the unique IDs of all players who had a sprint speed of 97 or higher -- in any attribute update between 2013 and 2015. -- DISTINCT is crucial to ensure we only consider each player once, even if they -- met the criteria multiple times. SELECT DISTINCT player_api_id FROM Player_Attributes WHERE sprint_speed >= 97 AND STRFTIME('%Y', date) BETWEEN '2013' AND '2015' ) -- Now, join this list of fast players with the main Player table to access their birth dates -- and calculate their current age. SELECT -- Calculate the age by subtracting the birth year from the current year. -- This provides a simple and effective age calculation. STRFTIME('%Y', 'now') - STRFTIME('%Y', T1.birthday) AS player_age FROM Player AS T1 -- We use an INNER JOIN to ensure we only get results for players -- who were identified in our CTE. JOIN Fast_Players_In_Period AS T2 ON T1.id = T2.player_api_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "",
          "error_flag": true,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "error_flag_or_empty",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT STRFTIME('%Y', 'now') - STRFTIME('%Y', T1.birthday) FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.id = T2.player_api_id WHERE T2.sprint_speed >= 97 AND STRFTIME('%Y', T2.date) BETWEEN '2013' AND '2015'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT STRFTIME('%Y', 'now') - STRFTIME('%Y', T2.birthday) FROM Player_Attributes AS T1 INNER JOIN Player AS T2 ON T1.player_api_id = T2.id WHERE T1.sprint_speed >= 97 AND STRFTIME('%Y', T1.date) BETWEEN '2013' AND '2015'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 0,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 106.6814501285553,
      "matched_cells": [
        {
          "table": "Match",
          "column": "season",
          "value": "2012/2013",
          "sim": 0.3359375
        },
        {
          "table": "Match",
          "column": "date",
          "value": "2015-07-25 00:00:00",
          "sim": 0.1953125
        },
        {
          "table": "Player_Attributes",
          "column": "date",
          "value": "2015-12-24 00:00:00",
          "sim": 0.1875
        }
      ],
      "schema_hints": [
        "birthday",
        "sprint_speed",
        "date"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "Player_Attributes.sprint_speed: To filter for players with a sprint speed of no less than 97.\nPlayer.birthday: To calculate the current age of the players.\nPlayer_Attributes.date: To filter the player attributes data for the years between 2013 and 2015.\nPlayer.birthday: The \"birthday\" column is needed to calculate the age of the players.\nPlayer_Attributes.sprint_speed: The \"sprint_speed\" column is needed to filter for players with a sprint speed of no less than 97.\nPlayer_Attributes.date: The \"d",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 10
    },
    {
      "question_id": 109,
      "db_id": "financial",
      "difficulty": "simple",
      "question": "How many clients opened their accounts in Jesenik branch were women?",
      "evidence": "A2 has region names; Woman and female share the same meaning; female refers to gender = 'F'",
      "ground_truth_sql": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'F' AND T2.A2 = 'Jesenik'",
      "s1_fields": [
        [
          "account",
          "account_id"
        ],
        [
          "account",
          "district_id"
        ],
        [
          "client",
          "client_id"
        ],
        [
          "client",
          "district_id"
        ],
        [
          "client",
          "gender"
        ],
        [
          "disp",
          "account_id"
        ],
        [
          "disp",
          "client_id"
        ],
        [
          "disp",
          "disp_id"
        ],
        [
          "district",
          "A2"
        ],
        [
          "district",
          "district_id"
        ]
      ],
      "s2_fields": [
        [
          "account",
          "account_id"
        ],
        [
          "account",
          "district_id"
        ],
        [
          "client",
          "client_id"
        ],
        [
          "client",
          "district_id"
        ],
        [
          "client",
          "gender"
        ],
        [
          "disp",
          "account_id"
        ],
        [
          "disp",
          "client_id"
        ],
        [
          "disp",
          "disp_id"
        ],
        [
          "district",
          "A2"
        ],
        [
          "district",
          "district_id"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A2 = 'Jesenik' AND T1.gender = 'F'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.client_id) FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN account AS T3 ON T2.account_id = T3.account_id INNER JOIN district AS T4 ON T3.district_id = T4.district_id WHERE T4.A2 = 'Jesenik' AND T1.gender = 'F'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.client_id) FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN account AS T3 ON T2.account_id = T3.account_id INNER JOIN district AS T4 ON T3.district_id = T4.district_id WHERE T4.A2 = 'Jesenik' AND T1.gender = 'F'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN account AS T3 ON T2.account_id = T3.account_id INNER JOIN district AS T4 ON T3.district_id = T4.district_id WHERE T4.A2 = 'Jesenik' AND T1.gender = 'F'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T3.client_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T4 ON T2.account_id = T4.account_id INNER JOIN client AS T3 ON T4.client_id = T3.client_id WHERE T1.A2 = 'Jesenik' AND T3.gender = 'F'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T4.client_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T3 ON T2.account_id = T3.account_id INNER JOIN client AS T4 ON T3.client_id = T4.client_id WHERE T1.A2 = 'Jesenik' AND T4.gender = 'F'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH JesenikAccounts AS ( -- Find all accounts located in the 'Jesenik' district SELECT T1.account_id FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A2 = 'Jesenik' ), FemaleClientsWithJesenikAccounts AS ( -- Find all female clients associated with these accounts SELECT DISTINCT T1.client_id FROM disp AS T1 INNER JOIN client AS T2 ON T1.client_id = T2.client_id INNER JOIN JesenikAccounts AS T3 ON T1.account_id = T3.account_id WHERE T2.gender = 'F' ) -- Count the total number of unique female clients found SELECT COUNT(client_id) FROM FemaleClientsWithJesenikAccounts",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.client_id) FROM client AS T1 WHERE T1.gender = 'F' AND EXISTS ( SELECT 1 FROM disp AS T2 INNER JOIN account AS T3 ON T2.account_id = T3.account_id INNER JOIN district AS T4 ON T3.district_id = T4.district_id WHERE T2.client_id = T1.client_id AND T4.A2 = 'Jesenik' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.client_id) FROM client AS T1 JOIN disp AS T2 ON T1.client_id = T2.client_id JOIN account AS T3 ON T2.account_id = T3.account_id JOIN district AS T4 ON T3.district_id = T4.district_id WHERE T1.gender = 'F' AND T4.A2 = 'Jesenik'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN account AS T3 ON T2.account_id = T3.account_id INNER JOIN district AS T4 ON T3.district_id = T4.district_id WHERE T1.gender = 'F' AND T4.A2 = 'Jesenik'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(DISTINCT T1.client_id) FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN account AS T3 ON T2.account_id = T3.account_id INNER JOIN district AS T4 ON T3.district_id = T4.district_id WHERE T1.gender = 'F' AND T4.A2 = 'Jesenik'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 94.88054299354553,
      "matched_cells": [
        {
          "table": "district",
          "column": "A2",
          "value": "Jesenik",
          "sim": 1.0
        },
        {
          "table": "client",
          "column": "gender",
          "value": "F",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "gender",
        "A2"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "client.client_id: To count the number of clients.\nclient.gender: To filter for female clients.\ndisp.client_id: To link clients to their accounts.\ndisp.account_id: To link dispositions to accounts.\naccount.account_id: To identify the accounts.\naccount.district_id: To link accounts to districts.\ndistrict.A2: To filter for the 'Jesenik' branch.",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 10
    },
    {
      "question_id": 135,
      "db_id": "financial",
      "difficulty": "moderate",
      "question": "After making a credit card withdrawal, how many account/s with monthly issuance has a negative balance?",
      "evidence": "Negative balance means balance < 0; Operation = 'VYBER KARTOU' stands for credit card withdraw. Frequency = 'POPLATEK MESICNE' stands for monthly issurance",
      "ground_truth_sql": "SELECT COUNT(T1.account_id) FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T1.balance < 0 AND T1.operation = 'VYBER KARTOU' AND T2.frequency = 'POPLATEK MESICNE'",
      "s1_fields": [
        [
          "account",
          "account_id"
        ],
        [
          "account",
          "district_id"
        ],
        [
          "account",
          "frequency"
        ],
        [
          "trans",
          "account_id"
        ],
        [
          "trans",
          "balance"
        ],
        [
          "trans",
          "operation"
        ],
        [
          "trans",
          "trans_id"
        ]
      ],
      "s2_fields": [
        [
          "account",
          "account_id"
        ],
        [
          "account",
          "district_id"
        ],
        [
          "account",
          "frequency"
        ],
        [
          "trans",
          "account"
        ],
        [
          "trans",
          "account_id"
        ],
        [
          "trans",
          "balance"
        ],
        [
          "trans",
          "operation"
        ],
        [
          "trans",
          "trans_id"
        ],
        [
          "trans",
          "type"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.account_id) FROM account AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T2.operation = 'VYBER KARTOU' AND T2.balance < 0 AND T1.frequency = 'POPLATEK MESICNE'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.account_id) FROM account AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T2.operation = 'VYBER KARTOU' AND T2.balance < 0 AND T1.frequency = 'POPLATEK MESICNE'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.account_id) FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T1.operation = 'VYBER KARTOU' AND T2.frequency = 'POPLATEK MESICNE' AND T1.balance < 0",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.account_id) FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T1.operation = 'VYBER KARTOU' AND T2.frequency = 'POPLATEK MESICNE' AND T1.balance < 0",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.account_id) FROM account AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T2.operation = 'VYBER KARTOU' AND T2.balance < 0 AND T1.frequency = 'POPLATEK MESICNE'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.account_id) FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T1.operation = 'VYBER KARTOU' AND T2.frequency = 'POPLATEK MESICNE' AND T1.balance < 0",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH CreditCardWithdrawal AS ( SELECT account_id FROM trans WHERE operation = 'VYBER KARTOU' AND balance < 0 ) SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN CreditCardWithdrawal AS T2 ON T1.account_id = T2.account_id WHERE T1.frequency = 'POPLATEK MESICNE'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T2.operation = 'VYBER KARTOU' AND T1.frequency = 'POPLATEK MESICNE' AND T2.balance < 0",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.account_id) FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T1.operation = 'VYBER KARTOU' AND T2.frequency = 'POPLATEK MESICNE' AND T1.balance < 0",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.account_id) FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T1.operation = 'VYBER KARTOU' AND T2.frequency = 'POPLATEK MESICNE' AND T1.balance < 0",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.account_id) FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T1.operation = 'VYBER KARTOU' AND T2.frequency = 'POPLATEK MESICNE' AND T1.balance < 0",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 53.30023121833801,
      "matched_cells": [
        {
          "table": "trans",
          "column": "operation",
          "value": "VYBER KARTOU",
          "sim": 1.0
        },
        {
          "table": "district",
          "column": "A2",
          "value": "Karvina",
          "sim": 0.1796875
        },
        {
          "table": "trans",
          "column": "type",
          "value": "VYBER",
          "sim": 1.0
        },
        {
          "table": "account",
          "column": "frequency",
          "value": "POPLATEK MESICNE",
          "sim": 1.0
        },
        {
          "table": "district",
          "column": "A7",
          "value": "0",
          "sim": 1.0
        },
        {
          "table": "district",
          "column": "A5",
          "value": "0",
          "sim": 1.0
        },
        {
          "table": "district",
          "column": "A6",
          "value": "0",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "Operation",
        "Frequency",
        "balance",
        "account"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "trans.operation: Identifies credit card withdrawals, as specified in the evidence ('VYBER KARTOU').\ntrans.balance: Needed to check for accounts with a negative balance, as per the condition 'balance < 0'.\naccount.frequency: Filters for accounts with monthly issuance ('POPLATEK MESICNE').\ntrans.account_id: Links the transaction data to the account data to check both conditions for the same account.\naccount.account_id: Used to count the number of unique accounts that meet all the specified criteri",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 4
    },
    {
      "question_id": 149,
      "db_id": "financial",
      "difficulty": "challenging",
      "question": "Please list the account types that are not eligible for loans, and the average income of residents in the district where the account is located exceeds $8000 but is no more than $9000.",
      "evidence": "A11 represents the average salary; Salary and income share the similar meanings; when the account type = 'OWNER', it's eligible for loans",
      "ground_truth_sql": "SELECT T3.type FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T3 ON T2.account_id = T3.account_id WHERE T3.type != 'OWNER' AND T1.A11 BETWEEN 8000 AND 9000",
      "s1_fields": [
        [
          "account",
          "account_id"
        ],
        [
          "account",
          "district_id"
        ],
        [
          "disp",
          "account_id"
        ],
        [
          "disp",
          "client_id"
        ],
        [
          "disp",
          "disp_id"
        ],
        [
          "disp",
          "type"
        ],
        [
          "district",
          "A11"
        ],
        [
          "district",
          "district_id"
        ]
      ],
      "s2_fields": [
        [
          "account",
          "account_id"
        ],
        [
          "account",
          "district_id"
        ],
        [
          "disp",
          "account_id"
        ],
        [
          "disp",
          "client_id"
        ],
        [
          "disp",
          "disp_id"
        ],
        [
          "disp",
          "type"
        ],
        [
          "district",
          "A11"
        ],
        [
          "district",
          "district_id"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.type <> 'OWNER' AND T3.A11 > 8000 AND T3.A11 <= 9000",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.type != 'OWNER' AND T3.A11 > 8000 AND T3.A11 <= 9000",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.type != 'OWNER' AND T3.A11 > 8000 AND T3.A11 <= 9000",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.type <> 'OWNER' AND T3.A11 > 8000 AND T3.A11 <= 9000",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.type != 'OWNER' AND T3.A11 > 8000 AND T3.A11 <= 9000",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.type != 'OWNER' AND T3.A11 > 8000 AND T3.A11 <= 9000",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "/* This query identifies account types not eligible for loans in districts with a specific average income range. 1. First, the `DistrictsWithTargetIncome` CTE filters the `district` table to find districts where the average salary (A11) is between $8000 and $9000. 2. The main query then joins these filtered districts with the `account` table to get all accounts located in them. 3. This result is joined with the `disp` table to find the disposition types associated with these accounts. 4. Finally, it filters for disposition types that are not 'OWNER' (as 'OWNER' types are eligible for loans) and returns the distinct list of these non-eligible types. */ WITH DistrictsWithTargetIncome AS ( SELECT district_id FROM district WHERE A11 > 8000 AND A11 <= 9000 ) SELECT DISTINCT T3.type FROM DistrictsWithTargetIncome AS T1 JOIN account AS T2 ON T1.district_id = T2.district_id JOIN disp AS T3 ON T2.account_id = T3.account_id WHERE T3.type <> 'OWNER'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT d.type FROM disp AS d WHERE d.type <> 'OWNER' AND EXISTS ( SELECT 1 FROM account AS a JOIN district AS dist ON a.district_id = dist.district_id WHERE a.account_id = d.account_id AND dist.A11 > 8000 AND dist.A11 <= 9000 )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.type != 'OWNER' AND T3.A11 > 8000 AND T3.A11 <= 9000",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 461,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.type != 'OWNER' AND T3.A11 > 8000 AND T3.A11 <= 9000",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T1.type FROM disp AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.type <> 'OWNER' AND T3.A11 > 8000 AND T3.A11 <= 9000",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 90.76864886283875,
      "matched_cells": [
        {
          "table": "disp",
          "column": "type",
          "value": "OWNER",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "account type",
        "A11"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "disp.type: To identify the account types that are not eligible for loans. The user is asking to list these types.\ndistrict.A11: Represents the average salary in the district, which is needed to filter for districts where the average income is between $8000 and $9000.\ndisp.account_id: Needed to link the 'disp' table to the 'account' table to find out which district an account belongs to.\naccount.district_id: Needed to link the 'account' table to the 'district' table to filter by the district's av",
      "gt_executed_ok": true,
      "gt_row_count": 461,
      "oracle_match": true,
      "unique_sql_count": 5
    },
    {
      "question_id": 953,
      "db_id": "formula_1",
      "difficulty": "simple",
      "question": "How many French constructors have a lap number of over 50?",
      "evidence": "lap numbers of over 50 refers to laps > 50;",
      "ground_truth_sql": "SELECT COUNT(DISTINCT T2.constructorId) FROM results AS T1 INNER JOIN constructors AS T2 on T1.constructorId = T2.constructorId WHERE T1.laps > 50 AND T2.nationality = 'French'",
      "s1_fields": [
        [
          "constructors",
          "constructorId"
        ],
        [
          "constructors",
          "nationality"
        ],
        [
          "results",
          "constructorId"
        ],
        [
          "results",
          "driverId"
        ],
        [
          "results",
          "laps"
        ],
        [
          "results",
          "raceId"
        ],
        [
          "results",
          "resultId"
        ],
        [
          "results",
          "statusId"
        ]
      ],
      "s2_fields": [
        [
          "constructorResults",
          "constructorId"
        ],
        [
          "constructorResults",
          "constructorResultsId"
        ],
        [
          "constructorResults",
          "raceId"
        ],
        [
          "constructors",
          "constructorId"
        ],
        [
          "constructors",
          "name"
        ],
        [
          "constructors",
          "nationality"
        ],
        [
          "lapTimes",
          "driverId"
        ],
        [
          "lapTimes",
          "lap"
        ],
        [
          "lapTimes",
          "raceId"
        ],
        [
          "results",
          "constructorId"
        ],
        [
          "results",
          "driverId"
        ],
        [
          "results",
          "laps"
        ],
        [
          "results",
          "raceId"
        ],
        [
          "results",
          "resultId"
        ],
        [
          "results",
          "statusId"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.constructorId) FROM constructors AS T1 INNER JOIN results AS T2 ON T1.constructorId = T2.constructorId WHERE T1.nationality = 'French' AND T2.laps > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.constructorId) FROM constructors AS T1 INNER JOIN results AS T2 ON T1.constructorId = T2.constructorId WHERE T1.nationality = 'French' AND T2.laps > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.constructorId) FROM constructors AS T1 INNER JOIN results AS T2 ON T1.constructorId = T2.constructorId INNER JOIN lapTimes AS T3 ON T2.raceId = T3.raceId WHERE T1.nationality = 'French' AND T3.lap > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.constructorId) FROM constructors AS T1 INNER JOIN results AS T2 ON T1.constructorId = T2.constructorId INNER JOIN lapTimes AS T3 ON T2.driverId = T3.driverId AND T2.raceId = T3.raceId WHERE T1.nationality = 'French' AND T3.lap > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.constructorId) FROM constructors AS T1 INNER JOIN results AS T2 ON T1.constructorId = T2.constructorId WHERE T1.nationality = 'French' AND T2.laps > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.constructorId) FROM constructors AS T1 INNER JOIN results AS T2 ON T1.constructorId = T2.constructorId INNER JOIN lapTimes AS T3 ON T2.raceId = T3.raceId WHERE T1.nationality = 'French' AND T3.lap > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH FrenchConstructors AS ( SELECT constructorId FROM constructors WHERE nationality = 'French' ) SELECT COUNT(DISTINCT T1.constructorId) FROM results AS T1 INNER JOIN FrenchConstructors AS T2 ON T1.constructorId = T2.constructorId WHERE T1.laps > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH FrenchConstructors AS ( SELECT constructorId FROM constructors WHERE nationality = 'French' ) SELECT COUNT(DISTINCT T1.constructorId) FROM results AS T1 INNER JOIN FrenchConstructors AS T2 ON T1.constructorId = T2.constructorId WHERE T1.laps > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(DISTINCT T1.constructorId) FROM constructors AS T1 INNER JOIN results AS T2 ON T1.constructorId = T2.constructorId WHERE T1.nationality = 'French' AND T2.laps > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.constructorId) FROM constructors AS T1 INNER JOIN results AS T2 ON T1.constructorId = T2.constructorId WHERE T1.nationality = 'French' AND T2.laps > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(DISTINCT T1.constructorId) FROM constructors AS T1 INNER JOIN results AS T2 ON T1.constructorId = T2.constructorId WHERE T1.nationality = 'French' AND T2.laps > 50",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 58.02460289001465,
      "matched_cells": [
        {
          "table": "drivers",
          "column": "nationality",
          "value": "French",
          "sim": 1.0
        },
        {
          "table": "constructors",
          "column": "nationality",
          "value": "French",
          "sim": 1.0
        },
        {
          "table": "driverStandings",
          "column": "positionText",
          "value": "50",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "constructors",
        "laps"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "constructors.nationality: To identify constructors that are French.\nconstructors.constructorId: To link constructors with their race results.\nresults.laps: To filter for races where the number of laps is over 50.\nresults.constructorId: To join with the constructors table.\nlapTimes.lap: To filter for lap numbers greater than 50.\nconstructors.name: To identify the French constructors.\nconstructorResults.constructorId: To link constructors to the races they participated in.\nlapTimes.raceId: To link",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 4
    },
    {
      "question_id": 852,
      "db_id": "formula_1",
      "difficulty": "moderate",
      "question": "How many races in the year 2010 are held on grand prixs outside Asia and Europe?",
      "evidence": "",
      "ground_truth_sql": "SELECT COUNT(T3.raceId) FROM circuits AS T1 INNER JOIN races AS T3 ON T3.circuitID = T1.circuitId WHERE T1.country NOT IN ( 'Bahrain', 'China', 'Singapore', 'Japan', 'Korea', 'Turkey', 'UAE', 'Malaysia', 'Spain', 'Monaco', 'Azerbaijan', 'Austria', 'Belgium', 'France', 'Germany', 'Hungary', 'Italy', 'UK' ) AND T3.year = 2010",
      "s1_fields": [
        [
          "circuits",
          "circuitId"
        ],
        [
          "circuits",
          "country"
        ],
        [
          "races",
          "circuitId"
        ],
        [
          "races",
          "raceId"
        ],
        [
          "races",
          "year"
        ]
      ],
      "s2_fields": [
        [
          "circuits",
          "circuitId"
        ],
        [
          "circuits",
          "country"
        ],
        [
          "circuits",
          "name"
        ],
        [
          "races",
          "circuitId"
        ],
        [
          "races",
          "name"
        ],
        [
          "races",
          "raceId"
        ],
        [
          "races",
          "year"
        ],
        [
          "seasons",
          "year"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T1.raceId) FROM races AS T1 INNER JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T1.year = 2010 AND T2.country NOT IN ('Asia', 'Europe')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T1.raceId) FROM races AS T1 INNER JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T1.year = 2010 AND T2.country NOT IN ( 'Austria', 'Azerbaijan', 'Belgium', 'France', 'Germany', 'Hungary', 'Italy', 'Monaco', 'Netherlands', 'Portugal', 'Russia', 'Spain', 'UK', 'Bahrain', 'China', 'Japan', 'Malaysia', 'Singapore', 'South Korea', 'Turkey', 'UAE', 'Qatar' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T1.raceId) FROM races AS T1 INNER JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T1.year = 2010 AND T2.country NOT IN ('Asia', 'Europe')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(T1.raceId) FROM races AS T1 INNER JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T1.year = 2010 AND T2.country NOT IN ( 'UK', 'Germany', 'Italy', 'France', 'Spain', 'Belgium', 'Monaco', 'Austria', 'Hungary', 'Netherlands', 'Portugal', 'Russia', 'Turkey', 'Japan', 'China', 'Malaysia', 'Bahrain', 'Singapore', 'United Arab Emirates' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.raceId) FROM races AS T1 INNER JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T1.year = 2010 AND T2.country IN ('USA', 'Canada', 'Mexico', 'Brazil', 'Australia', 'South Africa')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.raceId) FROM races AS T1 INNER JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T1.year = 2010 AND T2.country IN ('Australia', 'Canada', 'Brazil')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH RacesIn2010 AS ( SELECT circuitId FROM races WHERE year = 2010 ) SELECT COUNT(T1.circuitId) FROM RacesIn2010 AS T1 INNER JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T2.country NOT IN ( 'UK', 'Spain', 'Italy', 'Germany', 'Monaco', 'Belgium', 'Hungary', 'Austria', 'France', 'Netherlands', 'Portugal', 'Russia', 'Japan', 'China', 'Malaysia', 'Singapore', 'Bahrain', 'UAE', 'Turkey', 'South Korea', 'Qatar', 'Saudi Arabia', 'India' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH RacesIn2010 AS ( SELECT circuitId FROM races WHERE year = 2010 ) SELECT COUNT(T2.circuitId) FROM RacesIn2010 AS T1 JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T2.country NOT IN ( 'UK', 'Spain', 'Monaco', 'Germany', 'Hungary', 'Belgium', 'Italy', 'Turkey', 'Bahrain', 'Malaysia', 'China', 'Singapore', 'Japan', 'Korea', 'UAE' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(*) FROM races AS T1 JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T1.year = 2010 AND T2.country NOT IN ('Asia', 'Europe')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.raceId) FROM races AS T1 INNER JOIN circuits AS T2 ON T1.circuitId = T2.circuitId WHERE T1.year = 2010 AND T2.country NOT IN ('UK', 'Spain', 'Monaco', 'Germany', 'Hungary', 'Belgium', 'Italy', 'France', 'Malaysia', 'China', 'Turkey', 'Singapore', 'Japan', 'Bahrain', 'UAE')",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "",
          "error_flag": true,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "error_flag_or_empty",
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 88.9294171333313,
      "matched_cells": [
        {
          "table": "races",
          "column": "date",
          "value": "2010-04-04",
          "sim": 0.2890625
        },
        {
          "table": "pitStops",
          "column": "duration",
          "value": "22.010",
          "sim": 0.2265625
        },
        {
          "table": "drivers",
          "column": "forename",
          "value": "Basil",
          "sim": 0.3046875
        }
      ],
      "schema_hints": [
        "races",
        "grand prixs"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "races.raceId: To count the number of races.\nraces.year: To filter the races for the year 2010.\ncircuits.circuitId: To link the races table with the circuits table.\ncircuits.country: To identify the location of the race and filter for those outside Asia and Europe.\nseasons.year: To filter the races for the year 2010.\nraces.name: To identify the location of the Grand Prix and filter for those outside of Asia and Europe.\ncircuits.name: To identify the location of the circuit as an alternative way t",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 9
    },
    {
      "question_id": 994,
      "db_id": "formula_1",
      "difficulty": "challenging",
      "question": "Which constructor scored most points from Monaco Grand Prix between 1980 and 2010? List the score, name and nationality of this team.",
      "evidence": "Monaco Grand Priz refers to the race; race in year between 1980 and 2010",
      "ground_truth_sql": "SELECT SUM(T1.points), T2.name, T2.nationality FROM constructorResults AS T1 INNER JOIN constructors AS T2 ON T1.constructorId = T2.constructorId INNER JOIN races AS T3 ON T3.raceid = T1.raceid WHERE T3.name = 'Monaco Grand Prix' AND T3.year BETWEEN 1980 AND 2010 GROUP BY T2.name ORDER BY SUM(T1.points) DESC LIMIT 1",
      "s1_fields": [
        [
          "constructorResults",
          "constructorId"
        ],
        [
          "constructorResults",
          "constructorResultsId"
        ],
        [
          "constructorResults",
          "points"
        ],
        [
          "constructorResults",
          "raceId"
        ],
        [
          "constructors",
          "constructorId"
        ],
        [
          "constructors",
          "name"
        ],
        [
          "constructors",
          "nationality"
        ],
        [
          "races",
          "circuitId"
        ],
        [
          "races",
          "name"
        ],
        [
          "races",
          "raceId"
        ],
        [
          "races",
          "year"
        ]
      ],
      "s2_fields": [
        [
          "circuits",
          "name"
        ],
        [
          "constructorResults",
          "constructorId"
        ],
        [
          "constructorResults",
          "constructorResultsId"
        ],
        [
          "constructorResults",
          "points"
        ],
        [
          "constructorResults",
          "raceId"
        ],
        [
          "constructorStandings",
          "constructorStandingsId"
        ],
        [
          "constructorStandings",
          "points"
        ],
        [
          "constructorStandings",
          "raceId"
        ],
        [
          "constructors",
          "constructorId"
        ],
        [
          "constructors",
          "name"
        ],
        [
          "constructors",
          "nationality"
        ],
        [
          "races",
          "circuitId"
        ],
        [
          "races",
          "name"
        ],
        [
          "races",
          "raceId"
        ],
        [
          "races",
          "year"
        ],
        [
          "results",
          "constructorId"
        ],
        [
          "results",
          "driverId"
        ],
        [
          "results",
          "points"
        ],
        [
          "results",
          "raceId"
        ],
        [
          "results",
          "statusId"
        ],
        [
          "seasons",
          "year"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT SUM(CR.points) AS total_points, C.name AS constructor_name, C.nationality AS constructor_nationality FROM constructorResults AS CR JOIN races AS R ON CR.raceId = R.raceId JOIN constructors AS C ON CR.constructorId = C.constructorId WHERE R.name = 'Monaco Grand Prix' AND R.year BETWEEN 1980 AND 2010 GROUP BY C.constructorId, C.name, C.nationality ORDER BY total_points DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT SUM(T3.points) AS score, T2.name, T2.nationality FROM races AS T1 INNER JOIN constructors AS T2 ON T2.constructorId = T3.constructorId INNER JOIN constructorResults AS T3 ON T1.raceId = T3.raceId WHERE T1.name = 'Monaco Grand Prix' AND T1.year BETWEEN 1980 AND 2010 GROUP BY T2.constructorId, T2.name, T2.nationality ORDER BY score DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT SUM(T2.points) AS total_score, T3.name, T3.nationality FROM races AS T1 INNER JOIN constructorResults AS T2 ON T1.raceId = T2.raceId INNER JOIN constructors AS T3 ON T2.constructorId = T3.constructorId WHERE T1.name = 'Monaco Grand Prix' AND T1.year BETWEEN 1980 AND 2010 GROUP BY T3.constructorId ORDER BY total_score DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT SUM(CR.points) AS total_score, C.name AS constructor_name, C.nationality AS constructor_nationality FROM races AS R JOIN constructorResults AS CR ON R.raceId = CR.raceId JOIN constructors AS C ON CR.constructorId = C.constructorId WHERE R.name = 'Monaco Grand Prix' AND R.year BETWEEN 1980 AND 2010 GROUP BY C.constructorId, C.name, C.nationality ORDER BY total_score DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT SUM(CR.points) AS total_score, C.name, C.nationality FROM constructors AS C JOIN constructorResults AS CR ON C.constructorId = CR.constructorId JOIN races AS R ON CR.raceId = R.raceId WHERE R.name = 'Monaco Grand Prix' AND R.year BETWEEN 1980 AND 2010 GROUP BY C.constructorId, C.name, C.nationality ORDER BY total_score DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T2.points) AS total_points, T3.name, T3.nationality FROM races AS T1 INNER JOIN constructorResults AS T2 ON T1.raceId = T2.raceId INNER JOIN constructors AS T3 ON T2.constructorId = T3.constructorId WHERE T1.name = 'Monaco Grand Prix' AND T1.year BETWEEN 1980 AND 2010 GROUP BY T3.constructorId, T3.name, T3.nationality ORDER BY total_points DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH MonacoRaces AS ( SELECT raceId FROM races WHERE name = 'Monaco Grand Prix' AND year BETWEEN 1980 AND 2010 ), ConstructorTotalPoints AS ( SELECT constructorId, SUM(points) AS total_points FROM constructorResults WHERE raceId IN ( SELECT raceId FROM MonacoRaces ) GROUP BY constructorId ) SELECT T2.total_points AS score, T3.name, T3.nationality FROM ConstructorTotalPoints AS T2 JOIN constructors AS T3 ON T2.constructorId = T3.constructorId ORDER BY score DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH MonacoRaces AS ( SELECT raceId FROM races WHERE name = 'Monaco Grand Prix' AND year BETWEEN 1980 AND 2010 ), ConstructorPoints AS ( SELECT constructorId, SUM(points) AS total_points FROM results WHERE raceId IN ( SELECT raceId FROM MonacoRaces ) GROUP BY constructorId ) SELECT T2.name, T2.nationality, T1.total_points AS score FROM ConstructorPoints AS T1 INNER JOIN constructors AS T2 ON T1.constructorId = T2.constructorId ORDER BY T1.total_points DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T2.points), T3.name, T3.nationality FROM races AS T1 INNER JOIN results AS T2 ON T1.raceId = T2.raceId INNER JOIN constructors AS T3 ON T2.constructorId = T3.constructorId WHERE T1.name = 'Monaco Grand Prix' AND T1.year BETWEEN 1980 AND 2010 GROUP BY T3.name, T3.nationality ORDER BY SUM(T2.points) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T2.points), T3.name, T3.nationality FROM races AS T1 INNER JOIN constructorResults AS T2 ON T1.raceId = T2.raceId INNER JOIN constructors AS T3 ON T2.constructorId = T3.constructorId WHERE T1.name = 'Monaco Grand Prix' AND T1.year BETWEEN 1980 AND 2010 GROUP BY T3.name ORDER BY SUM(T2.points) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T2.points), T3.name, T3.nationality FROM races AS T1 INNER JOIN constructorResults AS T2 ON T1.raceId = T2.raceId INNER JOIN constructors AS T3 ON T2.constructorId = T3.constructorId WHERE T1.name = 'Monaco Grand Prix' AND T1.year BETWEEN 1980 AND 2010 GROUP BY T3.name, T3.nationality ORDER BY SUM(T2.points) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 80.60124897956848,
      "matched_cells": [
        {
          "table": "races",
          "column": "name",
          "value": "Monaco Grand Prix",
          "sim": 1.0
        },
        {
          "table": "circuits",
          "column": "circuitRef",
          "value": "monaco",
          "sim": 1.0
        },
        {
          "table": "circuits",
          "column": "country",
          "value": "Monaco",
          "sim": 1.0
        },
        {
          "table": "drivers",
          "column": "driverRef",
          "value": "monarch",
          "sim": 0.265625
        },
        {
          "table": "drivers",
          "column": "surname",
          "value": "Monarch",
          "sim": 0.265625
        },
        {
          "table": "drivers",
          "column": "forename",
          "value": "Bertrand",
          "sim": 0.2421875
        },
        {
          "table": "pitStops",
          "column": "duration",
          "value": "20.198",
          "sim": 0.265625
        },
        {
          "table": "results",
          "column": "fastestLapSpeed",
          "value": "198.485",
          "sim": 0.21875
        },
        {
          "table": "races",
          "column": "date",
          "value": "2010-04-04",
          "sim": 0.2890625
        }
      ],
      "schema_hints": [
        "constructor",
        "points",
        "score",
        "name",
        "nationality",
        "team",
        "race",
        "year"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "constructorResults.points: To calculate the total score for each constructor.\nraces.name: To filter the races for 'Monaco Grand Prix'.\nraces.year: To filter the races for the years between 1980 and 2010.\nconstructors.name: To display the name of the constructor with the most points.\nconstructors.nationality: To display the nationality of the constructor.\nraces.raceId: To join with the constructorResults table.\nconstructorResults.raceId: To join with the races table.\nconstructorResults.constructo",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 11
    },
    {
      "question_id": 1349,
      "db_id": "student_club",
      "difficulty": "simple",
      "question": "Provide the total number of the budget amount for \"September Speaker\" event.",
      "evidence": "'September Speaker' is an event name; total number of budget amount refers to SUM(amount)",
      "ground_truth_sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
      "s1_fields": [
        [
          "budget",
          "amount"
        ],
        [
          "budget",
          "budget_id"
        ],
        [
          "budget",
          "link_to_event"
        ],
        [
          "event",
          "event_id"
        ],
        [
          "event",
          "event_name"
        ]
      ],
      "s2_fields": [
        [
          "budget",
          "amount"
        ],
        [
          "budget",
          "budget_id"
        ],
        [
          "budget",
          "category"
        ],
        [
          "budget",
          "link_to_event"
        ],
        [
          "budget",
          "spent"
        ],
        [
          "event",
          "event_id"
        ],
        [
          "event",
          "event_name"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT SUM(T1.amount) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.event_name = 'September Speaker'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 32.4179151058197,
      "matched_cells": [
        {
          "table": "event",
          "column": "event_name",
          "value": "September Speaker",
          "sim": 1.0
        },
        {
          "table": "budget",
          "column": "category",
          "value": "Speaker Gifts",
          "sim": 0.5390625
        },
        {
          "table": "member",
          "column": "position",
          "value": "Member",
          "sim": 0.3046875
        },
        {
          "table": "zip_code",
          "column": "city",
          "value": "Peak",
          "sim": 0.421875
        }
      ],
      "schema_hints": [
        "amount"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "budget.amount: To calculate the total budget amount.\nevent.event_name: To filter for the 'September Speaker' event.\nbudget.link_to_event: To link the budget to the specific event.\nbudget.spent: To find the total budget amount for the event, I need to sum the 'spent' column from the budget table.\nbudget.category: The 'category' column can be used to filter the budget for the 'September Speaker' event.",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 1
    },
    {
      "question_id": 1456,
      "db_id": "student_club",
      "difficulty": "moderate",
      "question": "List the full name of the top five members who spend the most money in the descending order of spending.",
      "evidence": "full name refers to first_name, last_name; spend the most money refers to MAX(expense.cost)",
      "ground_truth_sql": "SELECT T3.first_name, T3.last_name FROM expense AS T1 INNER JOIN budget AS T2 ON T1.link_to_budget = T2.budget_id INNER JOIN member AS T3 ON T1.link_to_member = T3.member_id ORDER BY T2.spent DESC LIMIT 5",
      "s1_fields": [
        [
          "expense",
          "cost"
        ],
        [
          "expense",
          "expense_id"
        ],
        [
          "expense",
          "link_to_budget"
        ],
        [
          "expense",
          "link_to_member"
        ],
        [
          "member",
          "first_name"
        ],
        [
          "member",
          "last_name"
        ],
        [
          "member",
          "link_to_major"
        ],
        [
          "member",
          "member_id"
        ],
        [
          "member",
          "zip"
        ]
      ],
      "s2_fields": [
        [
          "attendance",
          "link_to_event"
        ],
        [
          "attendance",
          "link_to_member"
        ],
        [
          "budget",
          "budget_id"
        ],
        [
          "budget",
          "link_to_event"
        ],
        [
          "budget",
          "spent"
        ],
        [
          "expense",
          "cost"
        ],
        [
          "expense",
          "expense_id"
        ],
        [
          "expense",
          "link_to_budget"
        ],
        [
          "expense",
          "link_to_member"
        ],
        [
          "member",
          "email"
        ],
        [
          "member",
          "first_name"
        ],
        [
          "member",
          "last_name"
        ],
        [
          "member",
          "link_to_major"
        ],
        [
          "member",
          "member_id"
        ],
        [
          "member",
          "zip"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.first_name, T1.last_name, SUM(T2.cost) AS total_spending FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id, T1.first_name, T1.last_name ORDER BY total_spending DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.first_name, T1.last_name FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id, T1.first_name, T1.last_name ORDER BY SUM(T2.cost) DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.first_name, T1.last_name FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id, T1.first_name, T1.last_name ORDER BY SUM(T2.cost) DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.first_name, T1.last_name, SUM(T2.cost) AS total_spending FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id, T1.first_name, T1.last_name ORDER BY total_spending DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.first_name, T1.last_name, SUM(T2.cost) AS total_spending FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id, T1.first_name, T1.last_name ORDER BY total_spending DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.first_name, T1.last_name, SUM(T2.cost) AS total_spending FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id, T1.first_name, T1.last_name ORDER BY total_spending DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH MemberTotalSpending AS ( SELECT link_to_member, SUM(cost) AS total_spending FROM expense GROUP BY link_to_member ) SELECT T2.first_name || ' ' || T2.last_name AS \"full name\" FROM MemberTotalSpending AS T1 INNER JOIN member AS T2 ON T1.link_to_member = T2.member_id ORDER BY T1.total_spending DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH MemberSpending AS ( -- First, calculate the maximum expense for each member SELECT link_to_member, MAX(cost) AS max_expense FROM expense GROUP BY link_to_member ) -- Then, join with the member table to get their names and order by the max expense SELECT T2.first_name || ' ' || T2.last_name AS \"full_name\", T1.max_expense AS \"spending\" FROM MemberSpending AS T1 JOIN member AS T2 ON T1.link_to_member = T2.member_id ORDER BY spending DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.first_name, T1.last_name FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id ORDER BY SUM(T2.cost) DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.first_name, T1.last_name FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id ORDER BY SUM(T2.cost) DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.first_name, T1.last_name FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id ORDER BY SUM(T2.cost) DESC LIMIT 5",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 78.03495407104492,
      "matched_cells": [],
      "schema_hints": [
        "first_name",
        "last_name",
        "expense",
        "cost"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "member.first_name: To display the full name of the members.\nmember.last_name: To display the full name of the members.\nexpense.cost: To calculate the total amount of money spent by each member.\nexpense.link_to_member: To link the expenses to the members who made them.\nbudget.spent: To find out the amount of money spent to determine the top spenders.\nattendance.link_to_member: To identify which member is associated with an event and their spending.\nbudget.link_to_event: To link the spending in th",
      "gt_executed_ok": true,
      "gt_row_count": 5,
      "oracle_match": false,
      "unique_sql_count": 5
    },
    {
      "question_id": 1464,
      "db_id": "student_club",
      "difficulty": "challenging",
      "question": "Write the full names of students who received funds on the date of 9/9/2019 and include the amount received.",
      "evidence": "full name refers to first_name, last_name, amount of funds received refers to amount, received funds on date refers to date_received",
      "ground_truth_sql": "SELECT DISTINCT T3.first_name, T3.last_name, T4.amount FROM event AS T1 INNER JOIN attendance AS T2 ON T1.event_id = T2.link_to_event INNER JOIN member AS T3 ON T3.member_id = T2.link_to_member INNER JOIN income AS T4 ON T4.link_to_member = T3.member_id WHERE T4.date_received = '2019-09-09'",
      "s1_fields": [
        [
          "income",
          "amount"
        ],
        [
          "income",
          "date_received"
        ],
        [
          "income",
          "income_id"
        ],
        [
          "income",
          "link_to_member"
        ],
        [
          "member",
          "first_name"
        ],
        [
          "member",
          "last_name"
        ],
        [
          "member",
          "link_to_major"
        ],
        [
          "member",
          "member_id"
        ],
        [
          "member",
          "zip"
        ]
      ],
      "s2_fields": [
        [
          "expense",
          "cost"
        ],
        [
          "expense",
          "expense_date"
        ],
        [
          "expense",
          "expense_id"
        ],
        [
          "expense",
          "link_to_budget"
        ],
        [
          "expense",
          "link_to_member"
        ],
        [
          "income",
          "amount"
        ],
        [
          "income",
          "date_received"
        ],
        [
          "income",
          "income_id"
        ],
        [
          "income",
          "link_to_member"
        ],
        [
          "member",
          "first_name"
        ],
        [
          "member",
          "last_name"
        ],
        [
          "member",
          "link_to_major"
        ],
        [
          "member",
          "member_id"
        ],
        [
          "member",
          "zip"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.first_name, T1.last_name, T2.amount FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T2.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.first_name, T1.last_name, T2.amount FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T2.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.first_name, T1.last_name, T2.amount FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T2.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.first_name, T1.last_name, T2.amount FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T2.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.first_name, T1.last_name, T2.amount FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T2.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.first_name, T1.last_name, T2.amount FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T2.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.first_name || ' ' || T1.last_name AS \"full_name\", T2.amount FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T2.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.first_name || ' ' || T2.last_name AS full_name, T1.amount FROM income AS T1 INNER JOIN member AS T2 ON T1.link_to_member = T2.member_id WHERE T1.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.first_name, T2.last_name, T1.amount FROM income AS T1 INNER JOIN member AS T2 ON T1.link_to_member = T2.member_id WHERE T1.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.first_name, T1.last_name, T2.amount FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T2.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.first_name, T2.last_name, T1.amount FROM income AS T1 INNER JOIN member AS T2 ON T1.link_to_member = T2.member_id WHERE T1.date_received = '2019-09-09'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 34.90923595428467,
      "matched_cells": [],
      "schema_hints": [
        "first_name",
        "last_name",
        "amount",
        "date_received"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "member.first_name: To get the first name of the student.\nmember.last_name: To get the last name of the student.\nincome.date_received: To filter the records for the specific date '9/9/2019'.\nincome.amount: To get the amount of funds received.\nincome.link_to_member: To join the income table with the member table.\nmember.member_id: To join the member table with the income table.\nexpense.cost: To get the amount of funds received by the students.\nexpense.expense_date: To filter the date when the fund",
      "gt_executed_ok": true,
      "gt_row_count": 2,
      "oracle_match": true,
      "unique_sql_count": 4
    },
    {
      "question_id": 803,
      "db_id": "superhero",
      "difficulty": "simple",
      "question": "What is the power ID of cryokinesis?",
      "evidence": "power ID refers to superpower.id; cryokinesis refers to power_name = 'cryokinesis';",
      "ground_truth_sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
      "s1_fields": [
        [
          "superpower",
          "id"
        ],
        [
          "superpower",
          "power_name"
        ]
      ],
      "s2_fields": [
        [
          "attribute",
          "attribute_name"
        ],
        [
          "attribute",
          "id"
        ],
        [
          "superpower",
          "id"
        ],
        [
          "superpower",
          "power_name"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT id FROM superpower WHERE power_name = 'Cryokinesis'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT <column_to_find> FROM <table_name> WHERE <lookup_column> = '<lookup_value>'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "near \"<\": syntax error",
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 29.190099954605103,
      "matched_cells": [
        {
          "table": "superpower",
          "column": "power_name",
          "value": "Cryokinesis",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "superpower.id",
        "power_name"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "superpower.id: The user is asking for the 'power ID', and the evidence states that 'power ID refers to superpower.id'.\nsuperpower.power_name: The user is asking about the power 'cryokinesis', which is found in the 'power_name' column.\nattribute.id: This is the unique identifier for the power, which is needed to answer what the power ID is.\nattribute.attribute_name: This column is needed to filter for the power 'cryokinesis'.",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 2
    },
    {
      "question_id": 782,
      "db_id": "superhero",
      "difficulty": "moderate",
      "question": "List the heroes' names whose eyes and hair colours are both black.",
      "evidence": "heroes' names refers to superhero_name; eyes and hair colours are both black refers to eye_colour_id AND hair_colour_id WHERE colour.colour = 'Black';",
      "ground_truth_sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id AND T1.hair_colour_id = T2.id WHERE T2.colour = 'Black'",
      "s1_fields": [
        [
          "colour",
          "colour"
        ],
        [
          "colour",
          "id"
        ],
        [
          "superhero",
          "alignment_id"
        ],
        [
          "superhero",
          "eye_colour_id"
        ],
        [
          "superhero",
          "gender_id"
        ],
        [
          "superhero",
          "hair_colour_id"
        ],
        [
          "superhero",
          "id"
        ],
        [
          "superhero",
          "publisher_id"
        ],
        [
          "superhero",
          "race_id"
        ],
        [
          "superhero",
          "skin_colour_id"
        ],
        [
          "superhero",
          "superhero_name"
        ]
      ],
      "s2_fields": [
        [
          "attribute",
          "attribute_name"
        ],
        [
          "attribute",
          "id"
        ],
        [
          "colour",
          "colour"
        ],
        [
          "colour",
          "id"
        ],
        [
          "hero_attribute",
          "attribute_id"
        ],
        [
          "hero_attribute",
          "attribute_value"
        ],
        [
          "hero_attribute",
          "hero_id"
        ],
        [
          "superhero",
          "alignment_id"
        ],
        [
          "superhero",
          "eye_colour_id"
        ],
        [
          "superhero",
          "full_name"
        ],
        [
          "superhero",
          "gender_id"
        ],
        [
          "superhero",
          "hair_colour_id"
        ],
        [
          "superhero",
          "id"
        ],
        [
          "superhero",
          "publisher_id"
        ],
        [
          "superhero",
          "race_id"
        ],
        [
          "superhero",
          "skin_colour_id"
        ],
        [
          "superhero",
          "superhero_name"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH BlackColour AS ( SELECT id FROM colour WHERE colour = 'Black' ) SELECT T1.superhero_name FROM superhero AS T1 WHERE T1.eye_colour_id = ( SELECT id FROM BlackColour ) AND T1.hair_colour_id = ( SELECT id FROM BlackColour )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH HeroColours AS ( SELECT s.superhero_name, ec.colour AS eye_colour, hc.colour AS hair_colour FROM superhero AS s JOIN colour AS ec ON s.eye_colour_id = ec.id JOIN colour AS hc ON s.hair_colour_id = hc.id ) SELECT superhero_name FROM HeroColours WHERE eye_colour = 'Black' AND hair_colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Black' AND T3.colour = 'Black'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 11,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 68.29853701591492,
      "matched_cells": [
        {
          "table": "colour",
          "column": "colour",
          "value": "Black",
          "sim": 1.0
        },
        {
          "table": "superhero",
          "column": "superhero_name",
          "value": "Blackout",
          "sim": 0.5234375
        }
      ],
      "schema_hints": [
        "superhero_name",
        "eye_colour_id",
        "hair_colour_id",
        "colour.colour"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "superhero.superhero_name: To display the names of the superheroes that meet the criteria.\nsuperhero.eye_colour_id: To filter superheroes based on their eye colour by joining with the 'colour' table.\nsuperhero.hair_colour_id: To filter superheroes based on their hair colour by joining with the 'colour' table.\ncolour.id: To join with the 'superhero' table on 'eye_colour_id' and 'hair_colour_id'.\ncolour.colour: To filter for the specific colour 'Black' for both eyes and hair.\nsuperhero.full_name: T",
      "gt_executed_ok": true,
      "gt_row_count": 11,
      "oracle_match": true,
      "unique_sql_count": 3
    },
    {
      "question_id": 773,
      "db_id": "superhero",
      "difficulty": "challenging",
      "question": "Which superhero has the same eyes, hair and skin colour? Indicate the publisher of the superhero.",
      "evidence": "which superhero refers to superhero_name; the same eyes, hair and skin colour refers to hair_colour_id = skin_colour_id AND hair_colour_id = eye_colour_id; publisher refers to publisher_name;",
      "ground_truth_sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.eye_colour_id = T1.hair_colour_id AND T1.eye_colour_id = T1.skin_colour_id",
      "s1_fields": [
        [
          "publisher",
          "id"
        ],
        [
          "publisher",
          "publisher_name"
        ],
        [
          "superhero",
          "alignment_id"
        ],
        [
          "superhero",
          "eye_colour_id"
        ],
        [
          "superhero",
          "gender_id"
        ],
        [
          "superhero",
          "hair_colour_id"
        ],
        [
          "superhero",
          "id"
        ],
        [
          "superhero",
          "publisher_id"
        ],
        [
          "superhero",
          "race_id"
        ],
        [
          "superhero",
          "skin_colour_id"
        ],
        [
          "superhero",
          "superhero_name"
        ]
      ],
      "s2_fields": [
        [
          "colour",
          "colour"
        ],
        [
          "colour",
          "id"
        ],
        [
          "publisher",
          "id"
        ],
        [
          "publisher",
          "publisher_name"
        ],
        [
          "superhero",
          "alignment_id"
        ],
        [
          "superhero",
          "eye_colour_id"
        ],
        [
          "superhero",
          "full_name"
        ],
        [
          "superhero",
          "gender_id"
        ],
        [
          "superhero",
          "hair_colour_id"
        ],
        [
          "superhero",
          "id"
        ],
        [
          "superhero",
          "publisher_id"
        ],
        [
          "superhero",
          "race_id"
        ],
        [
          "superhero",
          "skin_colour_id"
        ],
        [
          "superhero",
          "superhero_name"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.hair_colour_id = T1.skin_colour_id AND T1.hair_colour_id = T1.eye_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.hair_colour_id = T1.skin_colour_id AND T1.hair_colour_id = T1.eye_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.eye_colour_id = T1.hair_colour_id AND T1.hair_colour_id = T1.skin_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.hair_colour_id = T1.skin_colour_id AND T1.hair_colour_id = T1.eye_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.hair_colour_id = T1.skin_colour_id AND T1.hair_colour_id = T1.eye_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT s.superhero_name, p.publisher_name FROM superhero AS s JOIN publisher AS p ON s.publisher_id = p.id WHERE s.eye_colour_id = s.hair_colour_id AND s.hair_colour_id = s.skin_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.eye_colour_id = T1.hair_colour_id AND T1.hair_colour_id = T1.skin_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.hair_colour_id = T1.skin_colour_id AND T1.hair_colour_id = T1.eye_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.eye_colour_id = T1.hair_colour_id AND T1.hair_colour_id = T1.skin_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name , T2.publisher_name FROM superhero AS T1 JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.skin_colour_id = T1.hair_colour_id AND T1.hair_colour_id = T1.eye_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.eye_colour_id = T1.hair_colour_id AND T1.hair_colour_id = T1.skin_colour_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 157,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 42.09080123901367,
      "matched_cells": [],
      "schema_hints": [
        "superhero_name",
        "hair_colour_id",
        "skin_colour_id",
        "eye_colour_id",
        "publisher_name"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "superhero.superhero_name: To identify the superhero as requested by the user.\nsuperhero.eye_colour_id: To compare with hair and skin colour IDs to find superheroes with the same colour for all three.\nsuperhero.hair_colour_id: To compare with eye and skin colour IDs to find superheroes with the same colour for all three.\nsuperhero.skin_colour_id: To compare with eye and hair colour IDs to find superheroes with the same colour for all three.\npublisher.publisher_name: To provide the publisher's nam",
      "gt_executed_ok": true,
      "gt_row_count": 157,
      "oracle_match": true,
      "unique_sql_count": 4
    },
    {
      "question_id": 1276,
      "db_id": "thrombosis_prediction",
      "difficulty": "simple",
      "question": "For the patients who have an abnormal level of anti-DNA, please list the diseases they are diagnosed with.",
      "evidence": "abnormal level of anti-DNA refers to DNA > = 8; diseases refers to Diagnosis;",
      "ground_truth_sql": "SELECT DISTINCT(T1.Diagnosis) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.DNA >= 8",
      "s1_fields": [
        [
          "Laboratory",
          "DNA"
        ],
        [
          "Laboratory",
          "Date"
        ],
        [
          "Laboratory",
          "ID"
        ],
        [
          "Patient",
          "Diagnosis"
        ],
        [
          "Patient",
          "ID"
        ]
      ],
      "s2_fields": [
        [
          "Examination",
          "Diagnosis"
        ],
        [
          "Examination",
          "ID"
        ],
        [
          "Laboratory",
          "DNA"
        ],
        [
          "Laboratory",
          "DNA-II"
        ],
        [
          "Laboratory",
          "Date"
        ],
        [
          "Laboratory",
          "ID"
        ],
        [
          "Patient",
          "Diagnosis"
        ],
        [
          "Patient",
          "ID"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T2.Diagnosis FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.DNA >= 8",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T1.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.DNA >= 8",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T2.Diagnosis FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.DNA >= 8",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT DISTINCT T2.Diagnosis FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.DNA >= 8",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T2.Diagnosis FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.DNA >= 8",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 6,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T2.Diagnosis FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.DNA >= 8",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH AbnormalDNAPatients AS ( SELECT ID FROM Laboratory WHERE DNA >= 8 ) SELECT DISTINCT T1.Diagnosis FROM Patient AS T1 INNER JOIN AbnormalDNAPatients AS T2 ON T1.ID = T2.ID",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH AbnormalDNAPatients AS ( SELECT ID FROM Laboratory WHERE DNA >= 8 ) SELECT DISTINCT T2.Diagnosis FROM AbnormalDNAPatients AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T1.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.DNA >= 8",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T2.Diagnosis FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.DNA >= 8",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT T2.Diagnosis FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.DNA >= 8",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 33.38235306739807,
      "matched_cells": [
        {
          "table": "Laboratory",
          "column": "CRP",
          "value": "8",
          "sim": 1.0
        },
        {
          "table": "Laboratory",
          "column": "SM",
          "value": "8",
          "sim": 1.0
        },
        {
          "table": "Laboratory",
          "column": "SSB",
          "value": "8",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "DNA",
        "Diagnosis"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "Laboratory.DNA: The user is asking for patients with an abnormal level of anti-DNA, which is defined as DNA >= 8. This column is needed to filter for those patients.\nPatient.Diagnosis: The user wants to know the diseases the patients are diagnosed with. This column contains that information.\nExamination.Diagnosis: To find out the diseases the patients are diagnosed with.\nLaboratory.DNA-II: To identify patients with an abnormal level of anti-DNA, which is defined as DNA-II >= 8.",
      "gt_executed_ok": true,
      "gt_row_count": 3,
      "oracle_match": true,
      "unique_sql_count": 5
    },
    {
      "question_id": 1225,
      "db_id": "thrombosis_prediction",
      "difficulty": "moderate",
      "question": "List and group all patients by sex for total bilirubin (T-BIL) level not within the normal range.",
      "evidence": "List refers to GROUP_CONCAT(DISTINCT ID); total bilirubin (T-BIL) not within normal range refers to T-BIL > = 2.0",
      "ground_truth_sql": "SELECT T1.ID,T1.SEX FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.`T-BIL` >= 2.0 GROUP BY T1.SEX,T1.ID",
      "s1_fields": [
        [
          "Laboratory",
          "Date"
        ],
        [
          "Laboratory",
          "ID"
        ],
        [
          "Laboratory",
          "T-BIL"
        ],
        [
          "Patient",
          "ID"
        ],
        [
          "Patient",
          "SEX"
        ]
      ],
      "s2_fields": [
        [
          "Examination",
          "ID"
        ],
        [
          "Laboratory",
          "Date"
        ],
        [
          "Laboratory",
          "ID"
        ],
        [
          "Laboratory",
          "T-BIL"
        ],
        [
          "Patient",
          "ID"
        ],
        [
          "Patient",
          "SEX"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT P.SEX, GROUP_CONCAT(DISTINCT P.ID) AS PatientsWithAbnormalTBIL FROM Patient AS P JOIN Laboratory AS L ON P.ID = L.ID WHERE L.\"T-BIL\" >= 2.0 GROUP BY P.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT P.SEX, GROUP_CONCAT(DISTINCT L.ID) FROM Patient AS P JOIN Laboratory AS L ON P.ID = L.ID WHERE L.\"T-BIL\" >= 2.0 GROUP BY P.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT P.SEX, GROUP_CONCAT(DISTINCT L.ID) AS PatientsWithAbnormalTBIL FROM Laboratory AS L JOIN Patient AS P ON L.ID = P.ID WHERE L.\"T-BIL\" >= 2.0 GROUP BY P.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.SEX, GROUP_CONCAT(DISTINCT T2.ID) AS PatientsWithAbnormalTBIL FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.\"T-BIL\" >= 2.0 GROUP BY T1.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T2.SEX, GROUP_CONCAT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.`T-BIL` >= 2.0 GROUP BY T2.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.SEX, GROUP_CONCAT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.`T-BIL` >= 2.0 GROUP BY T2.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH Abnormal_TBIL AS ( SELECT ID FROM Laboratory WHERE \"T-BIL\" >= 2.0 ) SELECT T2.SEX, GROUP_CONCAT(DISTINCT T1.ID) AS patient_ids FROM Abnormal_TBIL AS T1 JOIN Patient AS T2 ON T1.ID = T2.ID GROUP BY T2.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH Abnormal_TBIL_Patients AS ( SELECT DISTINCT ID FROM Laboratory WHERE \"T-BIL\" >= 2.0 ) SELECT T2.SEX, GROUP_CONCAT(T1.ID) AS Patient_IDs FROM Abnormal_TBIL_Patients AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID GROUP BY T2.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.SEX, GROUP_CONCAT(T1.ID) FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.`T-BIL` >= 2.0 GROUP BY T2.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.SEX, GROUP_CONCAT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.`T-BIL` >= 2.0 GROUP BY T2.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T2.SEX, COUNT(T1.ID) FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2.0 GROUP BY T2.SEX",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 2,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 53.302698850631714,
      "matched_cells": [
        {
          "table": "Laboratory",
          "column": "RF",
          "value": "<22.0",
          "sim": 0.3671875
        }
      ],
      "schema_hints": [
        "T-BIL",
        "sex",
        "ID"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "Patient.ID: To list and identify each patient.\nPatient.SEX: To group the patients by their biological sex.\nLaboratory.T-BIL: To filter patients based on their total bilirubin level being outside the normal range (>= 2.0).\nLaboratory.ID: To link laboratory results with patient information.\nExamination.ID: The user wants to list all patients, and the ID column is the unique identifier for each patient.",
      "gt_executed_ok": true,
      "gt_row_count": 10,
      "oracle_match": false,
      "unique_sql_count": 9
    },
    {
      "question_id": 1295,
      "db_id": "thrombosis_prediction",
      "difficulty": "challenging",
      "question": "Among the patients whose total bilirubin is over the normal range, how many of them have a peripheral pattern observed in the sheet of ANA examination?",
      "evidence": "total bilirubin is over the normal range refers to `T-BIL` > = 2.0; peripheral pattern is observed in the sheet of ANA examination refers to that ANA Pattern contains 'P';",
      "ground_truth_sql": "SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T1.ID = T3.ID WHERE T2.`T-BIL` >= 2 AND T3.`ANA Pattern` LIKE '%P%'",
      "s1_fields": [
        [
          "Examination",
          "ANA Pattern"
        ],
        [
          "Examination",
          "ID"
        ],
        [
          "Laboratory",
          "Date"
        ],
        [
          "Laboratory",
          "ID"
        ],
        [
          "Laboratory",
          "T-BIL"
        ]
      ],
      "s2_fields": [
        [
          "Examination",
          "ANA"
        ],
        [
          "Examination",
          "ANA Pattern"
        ],
        [
          "Examination",
          "ID"
        ],
        [
          "Laboratory",
          "Date"
        ],
        [
          "Laboratory",
          "ID"
        ],
        [
          "Laboratory",
          "T-BIL"
        ],
        [
          "Patient",
          "ID"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2.0 AND T2.\"ANA Pattern\" LIKE '%P%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2.0 AND LOWER(T2.\"ANA Pattern\") LIKE '%p%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2.0 AND T2.\"ANA Pattern\" LIKE '%P%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2.0 AND T2.\"ANA Pattern\" LIKE '%P%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2.0 AND T2.\"ANA Pattern\" LIKE '%P%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2.0 AND T2.\"ANA Pattern\" LIKE '%P%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH HighBilirubinPatients AS ( SELECT ID FROM Laboratory WHERE \"T-BIL\" >= 2.0 ), PeripheralPatternPatients AS ( SELECT ID FROM Examination WHERE \"ANA Pattern\" LIKE '%P%' OR \"ANA Pattern\" LIKE '%p%' ) SELECT COUNT(DISTINCT T1.ID) FROM HighBilirubinPatients AS T1 INNER JOIN PeripheralPatternPatients AS T2 ON T1.ID = T2.ID",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "WITH HighBilirubinPatients AS ( SELECT DISTINCT ID FROM Laboratory WHERE \"T-BIL\" >= 2.0 ), PeripheralPatternPatients AS ( SELECT DISTINCT ID FROM Examination WHERE \"ANA Pattern\" LIKE '%P%' OR \"ANA Pattern\" LIKE '%p%' ) SELECT COUNT(T1.ID) FROM HighBilirubinPatients AS T1 INNER JOIN PeripheralPatternPatients AS T2 ON T1.ID = T2.ID",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2 AND T2.\"ANA Pattern\" LIKE '%P%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2 AND T2.\"ANA Pattern\" LIKE '%P%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT count(DISTINCT T1.ID) FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.\"T-BIL\" >= 2.0 AND T2.\"ANA Pattern\" LIKE '%P%'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 56.20496988296509,
      "matched_cells": [
        {
          "table": "Laboratory",
          "column": "RF",
          "value": "<22.0",
          "sim": 0.3671875
        },
        {
          "table": "Examination",
          "column": "ANA Pattern",
          "value": "p",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "T-BIL",
        "ANA Pattern"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "Laboratory.T-BIL: To identify patients with total bilirubin over the normal range, which is specified as >= 2.0 in the evidence.\nExamination.ANA Pattern: To find patients who have a 'peripheral pattern' in their ANA examination, as indicated by the pattern containing 'P'.\nExamination.ID: To count the number of unique patients who meet both the bilirubin and ANA pattern criteria.\nPatient.ID: To count the number of patients.\nExamination.ANA: To identify the ANA examination results, as the question",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 6
    },
    {
      "question_id": 195,
      "db_id": "toxicology",
      "difficulty": "simple",
      "question": "What is the most common bond type?",
      "evidence": "most common bond type refers MAX(COUNT(bond_type))",
      "ground_truth_sql": "SELECT T.bond_type FROM ( SELECT bond_type, COUNT(bond_id) FROM bond GROUP BY bond_type ORDER BY COUNT(bond_id) DESC LIMIT 1 ) AS T",
      "s1_fields": [
        [
          "bond",
          "bond_id"
        ],
        [
          "bond",
          "bond_type"
        ],
        [
          "bond",
          "molecule_id"
        ]
      ],
      "s2_fields": [
        [
          "bond",
          "bond_id"
        ],
        [
          "bond",
          "bond_type"
        ],
        [
          "bond",
          "molecule_id"
        ],
        [
          "connected",
          "atom_id"
        ],
        [
          "connected",
          "atom_id2"
        ],
        [
          "connected",
          "bond_id"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(bond_type) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(bond_type) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(bond_type) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(bond_type) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(bond_type) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(bond_type) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH BondCounts AS ( SELECT bond_type, COUNT(*) AS frequency FROM bond GROUP BY bond_type ) SELECT bond_type FROM BondCounts ORDER BY frequency DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(*) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(*) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY count(*) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT(*) DESC LIMIT 1",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": true
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 47.30011296272278,
      "matched_cells": [],
      "schema_hints": [
        "bond_type"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "bond.bond_type: The user is asking for the most common bond type. To determine this, I need to count the occurrences of each bond type from the `bond_type` column.\nconnected.bond_id: To find the most common bond, I need to count the occurrences of each bond type. `bond_id` is the identifier for bonds in the `connected` table.",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": true,
      "unique_sql_count": 3
    },
    {
      "question_id": 237,
      "db_id": "toxicology",
      "difficulty": "moderate",
      "question": "Which molecule does the atom TR001_10 belong to? Please state whether this molecule is carcinogenic or not.",
      "evidence": "TR001_10 is the atom id; label = '+' mean molecules are carcinogenic",
      "ground_truth_sql": "SELECT T2.molecule_id , IIF(T2.label = '+', 'YES', 'NO') AS flag_carcinogenic FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
      "s1_fields": [
        [
          "atom",
          "atom_id"
        ],
        [
          "atom",
          "molecule_id"
        ],
        [
          "molecule",
          "label"
        ],
        [
          "molecule",
          "molecule_id"
        ]
      ],
      "s2_fields": [
        [
          "atom",
          "atom_id"
        ],
        [
          "atom",
          "molecule_id"
        ],
        [
          "molecule",
          "label"
        ],
        [
          "molecule",
          "molecule_id"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.molecule_id, CASE WHEN T2.label = '+' THEN 'carcinogenic' ELSE 'not carcinogenic' END AS carcinogenicity_status FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.molecule_id, CASE WHEN T2.label = '+' THEN 'carcinogenic' ELSE 'not carcinogenic' END AS carcinogenicity_status FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.molecule_id, CASE WHEN T2.label = '+' THEN 'carcinogenic' WHEN T2.label = '-' THEN 'not carcinogenic' ELSE T2.label END AS carcinogenicity_status FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT T1.molecule_id, CASE WHEN T2.label = '+' THEN 'carcinogenic' ELSE 'not carcinogenic' END AS carcinogenic_status FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.molecule_id, CASE WHEN T2.label = '+' THEN 'carcinogenic' ELSE 'not carcinogenic' END AS carcinogenicity_status FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT m.molecule_id, CASE WHEN m.label = '+' THEN 'carcinogenic' WHEN m.label = '-' THEN 'not carcinogenic' ELSE 'unknown' -- In case there are other unexpected labels END AS carcinogenicity_status FROM molecule AS m JOIN atom AS a ON m.molecule_id = a.molecule_id WHERE a.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": false,
          "row_count": 0,
          "exec_error": "incomplete input",
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T2.molecule_id, CASE WHEN T2.label = '+' THEN 'carcinogenic' ELSE 'not carcinogenic' END AS is_carcinogenic FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT m.molecule_id, CASE WHEN m.label = '+' THEN 'Carcinogenic' ELSE 'Not Carcinogenic' END AS carcinogenicity FROM molecule AS m WHERE m.molecule_id = ( SELECT a.molecule_id FROM atom AS a WHERE a.atom_id = 'TR001_10' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.molecule_id, CASE WHEN T2.label = '+' THEN 'carcinogenic' ELSE 'not carcinogenic' END FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.molecule_id, CASE WHEN T2.label = '+' THEN 'carcinogenic' ELSE 'not carcinogenic' END FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.molecule_id, CASE WHEN T2.label = '+' THEN 'carcinogenic' ELSE 'not carcinogenic' END FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.atom_id = 'TR001_10'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 1,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 41.31856632232666,
      "matched_cells": [
        {
          "table": "atom",
          "column": "atom_id",
          "value": "TR001_10",
          "sim": 1.0
        },
        {
          "table": "connected",
          "column": "atom_id2",
          "value": "TR001_10",
          "sim": 1.0
        },
        {
          "table": "connected",
          "column": "atom_id",
          "value": "TR001_10",
          "sim": 1.0
        },
        {
          "table": "molecule",
          "column": "label",
          "value": "+",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "molecule",
        "carcinogenic",
        "atom id",
        "label",
        "molecules"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "atom.atom_id: To find the specific atom with the ID 'TR001_10'.\natom.molecule_id: To identify the molecule that the atom 'TR001_10' belongs to.\nmolecule.label: To determine if the identified molecule is carcinogenic, as indicated by a '+' label.\nmolecule.molecule_id: To link the molecule from the atom table to its carcinogenicity label.",
      "gt_executed_ok": true,
      "gt_row_count": 1,
      "oracle_match": false,
      "unique_sql_count": 7
    },
    {
      "question_id": 304,
      "db_id": "toxicology",
      "difficulty": "challenging",
      "question": "List all carcinogenic molecules and their elements.",
      "evidence": "label = '+' mean molecules are carcinogenic; element = 'cl' means Chlorine; element = 'c' means Carbon; element = 'h' means Hydrogen; element = 'o' means Oxygen, element = 's' means Sulfur; element = 'n' means Nitrogen, element = 'p' means Phosphorus, element = 'na' means Sodium, element = 'br' means Bromine, element = 'f' means Fluorine; element = 'i' means Iodine; element = 'sn' means Tin; element = 'pb' means Lead; element = 'te' means Tellurium; element = 'ca' means Calcium",
      "ground_truth_sql": "SELECT DISTINCT T2.molecule_id, T1.element FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T2.label = '+'",
      "s1_fields": [
        [
          "atom",
          "atom_id"
        ],
        [
          "atom",
          "element"
        ],
        [
          "atom",
          "molecule_id"
        ],
        [
          "molecule",
          "label"
        ],
        [
          "molecule",
          "molecule_id"
        ]
      ],
      "s2_fields": [
        [
          "atom",
          "atom_id"
        ],
        [
          "atom",
          "element"
        ],
        [
          "atom",
          "molecule_id"
        ],
        [
          "molecule",
          "label"
        ],
        [
          "molecule",
          "molecule_id"
        ]
      ],
      "candidates": [
        {
          "generator_id": "reasoning_A1",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.molecule_id, T2.element FROM molecule AS T1 INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.label = '+' ORDER BY T1.molecule_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3692,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A2",
          "schema_used": "s1",
          "schema_format": "ddl",
          "sql": "SELECT T1.molecule_id, T2.element FROM molecule AS T1 INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.label = '+' ORDER BY T1.molecule_id, T2.element",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3692,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A3",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT m.molecule_id, a.element FROM molecule AS m JOIN atom AS a ON m.molecule_id = a.molecule_id WHERE m.label = '+' ORDER BY m.molecule_id, a.element",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3692,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "reasoning_A4",
          "schema_used": "s2",
          "schema_format": "ddl",
          "sql": "SELECT m.molecule_id, a.element FROM molecule AS m JOIN atom AS a ON m.molecule_id = a.molecule_id WHERE m.label = '+'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3692,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "SELECT T1.molecule_id, T2.element FROM molecule AS T1 INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.label = '+' ORDER BY T1.molecule_id, T2.element",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3692,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "standard_B1_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT DISTINCT m.molecule_id, a.element FROM molecule AS m JOIN atom AS a ON m.molecule_id = a.molecule_id WHERE m.label = '+' ORDER BY m.molecule_id, a.element",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 563,
          "exec_error": null,
          "oracle_match": true
        },
        {
          "generator_id": "complex_B2_s1",
          "schema_used": "s1",
          "schema_format": "markdown",
          "sql": "WITH CarcinogenicMolecules AS ( SELECT molecule_id FROM molecule WHERE label = '+' ) SELECT T1.molecule_id, T2.element FROM CarcinogenicMolecules AS T1 JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3692,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "complex_B2_s2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "/* This solution uses a correlated subquery with EXISTS to identify and list the elements of carcinogenic molecules. Instead of joining the two tables directly, this approach iterates through each atom and checks for the existence of a corresponding record in the molecule table that is marked as carcinogenic ('+'). This is a structurally different approach from a direct JOIN, focusing on filtering the 'atom' table based on a condition in the 'molecule' table. */ SELECT a.molecule_id, a.element FROM atom AS a WHERE EXISTS ( SELECT 1 FROM molecule AS m WHERE m.molecule_id = a.molecule_id AND m.label = '+' )",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3692,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C1",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.molecule_id, T2.element FROM molecule AS T1 INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.label = '+'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3692,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C2",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.molecule_id, T2.element FROM molecule AS T1 INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.label = '+'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3692,
          "exec_error": null,
          "oracle_match": false
        },
        {
          "generator_id": "icl_C3",
          "schema_used": "s2",
          "schema_format": "markdown",
          "sql": "SELECT T1.molecule_id , T2.element FROM molecule AS T1 JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.label = '+'",
          "error_flag": false,
          "generator_error": null,
          "executed_ok": true,
          "row_count": 3692,
          "exec_error": null,
          "oracle_match": false
        }
      ],
      "grounding_ok": true,
      "schema_linking_ok": true,
      "error": null,
      "duration_seconds": 40.43903470039368,
      "matched_cells": [
        {
          "table": "molecule",
          "column": "label",
          "value": "+",
          "sim": 1.0
        }
      ],
      "schema_hints": [
        "label",
        "element"
      ],
      "few_shot_count": 8,
      "selection_reasoning": "molecule.label: To filter for carcinogenic molecules, as indicated by the label \"+\".\nmolecule.molecule_id: To uniquely identify each molecule and join with the atom table.\natom.element: To list the chemical elements present in each carcinogenic molecule.\natom.molecule_id: To link atoms and their elements to the corresponding molecules.\nmolecule.molecule_id: To identify the carcinogenic molecules and join to the atom table.\nmolecule.label: To identify which molecules are carcinogenic based on the",
      "gt_executed_ok": true,
      "gt_row_count": 563,
      "oracle_match": true,
      "unique_sql_count": 9
    }
  ]
}