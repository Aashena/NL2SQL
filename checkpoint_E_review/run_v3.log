2026-02-23 21:01:30,375  INFO      checkpoint_e  ======================================================================
2026-02-23 21:01:30,375  INFO      checkpoint_e  Checkpoint E — End-to-End Component Test (v3)
2026-02-23 21:01:30,375  INFO      checkpoint_e  ======================================================================
2026-02-23 21:01:30,375  INFO      checkpoint_e  LLM provider: gemini
2026-02-23 21:01:30,375  INFO      checkpoint_e  Model fast: gemini-2.5-flash
2026-02-23 21:01:30,375  INFO      checkpoint_e  Model powerful: gemini-3-flash-preview
2026-02-23 21:01:30,375  INFO      checkpoint_e  Model reasoning: gemini-2.5-flash
2026-02-23 21:01:30,375  INFO      checkpoint_e  Cache LLM responses: True
2026-02-23 21:01:30,375  INFO      checkpoint_e  Loading BIRD dev data from /Users/mostafa/Documents/workplace/NL2SQL/data/bird/dev/dev.json
2026-02-23 21:01:30,384  INFO      checkpoint_e  Total dev questions: 1534
2026-02-23 21:01:30,384  INFO      checkpoint_e  Sampled 33 questions (3 per DB, 1 per difficulty)
2026-02-23 21:01:30,384  INFO      checkpoint_e  Sampled distribution:
2026-02-23 21:01:30,384  INFO      checkpoint_e    california_schools / challenging: 1
2026-02-23 21:01:30,384  INFO      checkpoint_e    california_schools / moderate: 1
2026-02-23 21:01:30,384  INFO      checkpoint_e    california_schools / simple: 1
2026-02-23 21:01:30,384  INFO      checkpoint_e    card_games / challenging: 1
2026-02-23 21:01:30,384  INFO      checkpoint_e    card_games / moderate: 1
2026-02-23 21:01:30,384  INFO      checkpoint_e    card_games / simple: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    codebase_community / challenging: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    codebase_community / moderate: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    codebase_community / simple: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    debit_card_specializing / challenging: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    debit_card_specializing / moderate: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    debit_card_specializing / simple: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    european_football_2 / challenging: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    european_football_2 / moderate: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    european_football_2 / simple: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    financial / challenging: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    financial / moderate: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    financial / simple: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    formula_1 / challenging: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    formula_1 / moderate: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    formula_1 / simple: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    student_club / challenging: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    student_club / moderate: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    student_club / simple: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    superhero / challenging: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    superhero / moderate: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    superhero / simple: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    thrombosis_prediction / challenging: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    thrombosis_prediction / moderate: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    thrombosis_prediction / simple: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    toxicology / challenging: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    toxicology / moderate: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e    toxicology / simple: 1
2026-02-23 21:01:30,385  INFO      checkpoint_e  Loading ExampleStore from /Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/example_store.faiss
2026-02-23 21:01:30,391  INFO      faiss.loader  Loading faiss.
2026-02-23 21:01:30,429  INFO      faiss.loader  Successfully loaded faiss.
2026-02-23 21:01:30,473  INFO      src.indexing.example_store  ExampleStore loaded: faiss=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/example_store.faiss meta=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/example_store_metadata.json (9428 entries)
2026-02-23 21:01:30,473  INFO      checkpoint_e  ExampleStore loaded with 9428 entries
2026-02-23 21:01:30,473  INFO      checkpoint_e  Pre-loading artifacts for 11 databases: ['california_schools', 'card_games', 'codebase_community', 'debit_card_specializing', 'european_football_2', 'financial', 'formula_1', 'student_club', 'superhero', 'thrombosis_prediction', 'toxicology']
2026-02-23 21:01:30,473  INFO      checkpoint_e    Loading artifacts for california_schools...
2026-02-23 21:01:54,392  INFO      src.indexing.lsh_index  LSHIndex loaded from /Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/california_schools_lsh.pkl (198390 entries)
2026-02-23 21:01:54,401  INFO      src.indexing.faiss_index  FAISSIndex loaded: index=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/california_schools_faiss.index fields=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/california_schools_faiss_fields.json (89 entries)
2026-02-23 21:01:54,404  INFO      checkpoint_e    Loading artifacts for card_games...
2026-02-23 21:06:50,418  INFO      src.indexing.lsh_index  LSHIndex loaded from /Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/card_games_lsh.pkl (563677 entries)
2026-02-23 21:06:50,428  INFO      src.indexing.faiss_index  FAISSIndex loaded: index=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/card_games_faiss.index fields=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/card_games_faiss_fields.json (115 entries)
2026-02-23 21:06:50,432  INFO      checkpoint_e    Loading artifacts for codebase_community...
2026-02-23 21:08:47,099  INFO      src.indexing.lsh_index  LSHIndex loaded from /Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/codebase_community_lsh.pkl (326562 entries)
2026-02-23 21:08:47,126  INFO      src.indexing.faiss_index  FAISSIndex loaded: index=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/codebase_community_faiss.index fields=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/codebase_community_faiss_fields.json (71 entries)
2026-02-23 21:08:47,137  INFO      checkpoint_e    Loading artifacts for debit_card_specializing...
2026-02-23 21:08:47,407  INFO      src.indexing.lsh_index  LSHIndex loaded from /Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/debit_card_specializing_lsh.pkl (1164 entries)
2026-02-23 21:08:47,412  INFO      src.indexing.faiss_index  FAISSIndex loaded: index=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/debit_card_specializing_faiss.index fields=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/debit_card_specializing_faiss_fields.json (21 entries)
2026-02-23 21:08:47,417  INFO      checkpoint_e    Loading artifacts for european_football_2...
2026-02-23 21:09:04,187  INFO      src.indexing.lsh_index  LSHIndex loaded from /Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/european_football_2_lsh.pkl (96901 entries)
2026-02-23 21:09:04,206  INFO      src.indexing.faiss_index  FAISSIndex loaded: index=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/european_football_2_faiss.index fields=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/european_football_2_faiss_fields.json (199 entries)
2026-02-23 21:09:04,210  INFO      checkpoint_e    Loading artifacts for financial...
2026-02-23 21:09:04,982  INFO      src.indexing.lsh_index  LSHIndex loaded from /Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/financial_lsh.pkl (9957 entries)
2026-02-23 21:09:04,987  INFO      src.indexing.faiss_index  FAISSIndex loaded: index=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/financial_faiss.index fields=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/financial_faiss_fields.json (55 entries)
2026-02-23 21:09:04,988  INFO      checkpoint_e    Loading artifacts for formula_1...
2026-02-23 21:11:00,096  INFO      src.indexing.lsh_index  LSHIndex loaded from /Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/formula_1_lsh.pkl (44628 entries)
2026-02-23 21:11:00,121  INFO      src.indexing.faiss_index  FAISSIndex loaded: index=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/formula_1_faiss.index fields=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/formula_1_faiss_fields.json (94 entries)
2026-02-23 21:11:00,130  INFO      checkpoint_e    Loading artifacts for student_club...
2026-02-23 21:11:02,191  INFO      src.indexing.lsh_index  LSHIndex loaded from /Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/student_club_lsh.pkl (21810 entries)
2026-02-23 21:11:02,194  INFO      src.indexing.faiss_index  FAISSIndex loaded: index=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/student_club_faiss.index fields=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/student_club_faiss_fields.json (48 entries)
2026-02-23 21:11:02,196  INFO      checkpoint_e    Loading artifacts for superhero...
2026-02-23 21:11:02,249  INFO      src.indexing.lsh_index  LSHIndex loaded from /Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/superhero_lsh.pkl (1526 entries)
2026-02-23 21:11:02,251  INFO      src.indexing.faiss_index  FAISSIndex loaded: index=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/superhero_faiss.index fields=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/superhero_faiss_fields.json (31 entries)
2026-02-23 21:11:02,252  INFO      checkpoint_e    Loading artifacts for thrombosis_prediction...
2026-02-23 21:11:03,701  INFO      src.indexing.lsh_index  LSHIndex loaded from /Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/thrombosis_prediction_lsh.pkl (7984 entries)
2026-02-23 21:11:03,706  INFO      src.indexing.faiss_index  FAISSIndex loaded: index=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/thrombosis_prediction_faiss.index fields=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/thrombosis_prediction_faiss_fields.json (64 entries)
2026-02-23 21:11:03,708  INFO      checkpoint_e    Loading artifacts for toxicology...
2026-02-23 21:11:06,156  INFO      src.indexing.lsh_index  LSHIndex loaded from /Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/toxicology_lsh.pkl (62916 entries)
2026-02-23 21:11:06,164  INFO      src.indexing.faiss_index  FAISSIndex loaded: index=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/toxicology_faiss.index fields=/Users/mostafa/Documents/workplace/NL2SQL/data/preprocessed/indices/toxicology_faiss_fields.json (11 entries)
2026-02-23 21:11:06,170  INFO      checkpoint_e  [1/33] Processing Q#64 (california_schools, simple): What is the total number of schools with a mailing city in Hickman belonging to 
2026-02-23 21:11:14,541  INFO      src.indexing.example_store  Loaded spaCy model: en_core_web_sm
2026-02-23 21:11:20,545  INFO      sentence_transformers.SentenceTransformer  Use pytorch device_name: mps
2026-02-23 21:11:20,545  INFO      sentence_transformers.SentenceTransformer  Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2026-02-23 21:11:20,883  INFO      httpx  HTTP Request: HEAD https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2/resolve/main/modules.json "HTTP/1.1 307 Temporary Redirect"
2026-02-23 21:11:20,940  INFO      httpx  HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/modules.json "HTTP/1.1 200 OK"
2026-02-23 21:11:21,076  INFO      httpx  HTTP Request: HEAD https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2/resolve/main/config_sentence_transformers.json "HTTP/1.1 307 Temporary Redirect"
2026-02-23 21:11:21,131  INFO      httpx  HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/config_sentence_transformers.json "HTTP/1.1 200 OK"
2026-02-23 21:11:21,256  INFO      httpx  HTTP Request: HEAD https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2/resolve/main/config_sentence_transformers.json "HTTP/1.1 307 Temporary Redirect"
2026-02-23 21:11:21,306  INFO      httpx  HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/config_sentence_transformers.json "HTTP/1.1 200 OK"
2026-02-23 21:11:21,438  INFO      httpx  HTTP Request: HEAD https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2/resolve/main/README.md "HTTP/1.1 307 Temporary Redirect"
2026-02-23 21:11:21,488  INFO      httpx  HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/README.md "HTTP/1.1 200 OK"
2026-02-23 21:11:21,609  INFO      httpx  HTTP Request: HEAD https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2/resolve/main/modules.json "HTTP/1.1 307 Temporary Redirect"
Warning: You are sending unauthenticated requests to the HF Hub. Please set a HF_TOKEN to enable higher rate limits and faster downloads.
2026-02-23 21:11:21,609  WARNING   huggingface_hub.utils._http  Warning: You are sending unauthenticated requests to the HF Hub. Please set a HF_TOKEN to enable higher rate limits and faster downloads.
2026-02-23 21:11:21,673  INFO      httpx  HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/modules.json "HTTP/1.1 200 OK"
2026-02-23 21:11:21,816  INFO      httpx  HTTP Request: HEAD https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2/resolve/main/sentence_bert_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-23 21:11:21,879  INFO      httpx  HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/sentence_bert_config.json "HTTP/1.1 200 OK"
2026-02-23 21:11:22,003  INFO      httpx  HTTP Request: HEAD https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2/resolve/main/adapter_config.json "HTTP/1.1 404 Not Found"
2026-02-23 21:11:22,138  INFO      httpx  HTTP Request: HEAD https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2/resolve/main/config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-23 21:11:22,196  INFO      httpx  HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/config.json "HTTP/1.1 200 OK"
2026-02-23 21:11:22,499  INFO      httpx  HTTP Request: HEAD https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2/resolve/main/config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-23 21:11:22,551  INFO      httpx  HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/config.json "HTTP/1.1 200 OK"
2026-02-23 21:11:22,666  INFO      httpx  HTTP Request: HEAD https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2/resolve/main/tokenizer_config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-23 21:11:22,723  INFO      httpx  HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/tokenizer_config.json "HTTP/1.1 200 OK"
2026-02-23 21:11:22,857  INFO      httpx  HTTP Request: GET https://huggingface.co/api/models/sentence-transformers/all-MiniLM-L6-v2/tree/main/additional_chat_templates?recursive=false&expand=false "HTTP/1.1 404 Not Found"
2026-02-23 21:11:22,996  INFO      httpx  HTTP Request: GET https://huggingface.co/api/models/sentence-transformers/all-MiniLM-L6-v2/tree/main?recursive=true&expand=false "HTTP/1.1 200 OK"
2026-02-23 21:11:23,202  INFO      httpx  HTTP Request: HEAD https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2/resolve/main/1_Pooling/config.json "HTTP/1.1 307 Temporary Redirect"
2026-02-23 21:11:23,258  INFO      httpx  HTTP Request: HEAD https://huggingface.co/api/resolve-cache/models/sentence-transformers/all-MiniLM-L6-v2/c9745ed1d9f207416be6d2e6f8de32d1f16199bf/1_Pooling%2Fconfig.json "HTTP/1.1 200 OK"
2026-02-23 21:11:23,391  INFO      httpx  HTTP Request: GET https://huggingface.co/api/models/sentence-transformers/all-MiniLM-L6-v2 "HTTP/1.1 200 OK"
2026-02-23 21:11:23,736  INFO      src.indexing.faiss_index  Loaded SentenceTransformer model: all-MiniLM-L6-v2
2026-02-23 21:11:25,101  INFO      checkpoint_e    [Grounding] cell_matches=7, few_shot=8, schema_hints=3
2026-02-23 21:12:33,786  INFO      checkpoint_e    [Schema Linking] s1_fields=3, s2_fields=13
2026-02-23 21:12:33,787  INFO      checkpoint_e    [Schema Recall] table_recall: S1=100% S2=100% | col_recall: S1=100% S2=100%
2026-02-23 21:12:59,886  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=3), errors=0
2026-02-23 21:12:59,965  INFO      checkpoint_e    [Oracle Pre-Fix] 11/11 candidates are correct
2026-02-23 21:13:00,015  INFO      checkpoint_e    [Oracle Post-Fix] 11/11 fixed candidates are correct
2026-02-23 21:13:00,015  INFO      checkpoint_e    [Fixing] needed_fix=0, fixed_ok=0, still_failing=0 | orig_success=11/11, post_success=11/11
2026-02-23 21:13:00,044  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=True, final_sql=SELECT COUNT(*) FROM schools WHERE MailCity = 'Hickman' AND ...
2026-02-23 21:13:00,047  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: SELECT COUNT(*) FROM schools WHERE MailCity = 'Hickman' AND ...
2026-02-23 21:13:00,048  INFO      checkpoint_e  [2/33] Processing Q#23 (california_schools, moderate): List the names of schools with more than 30 difference in enrollements between K
2026-02-23 21:13:03,511  INFO      checkpoint_e    [Grounding] cell_matches=1, few_shot=8, schema_hints=4
2026-02-23 21:15:03,524  ERROR     checkpoint_e    [Schema Linking] TIMEOUT after 120s — using full DDL fallback
2026-02-23 21:15:12,433  ERROR     src.generation.icl_generator  ICLGenerator icl_C1 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:15:13,318  ERROR     src.generation.icl_generator  ICLGenerator icl_C2 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:15:19,916  ERROR     src.generation.icl_generator  ICLGenerator icl_C3 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:15:35,571  WARNING   src.generation.standard_generator  StandardAndComplexGenerator complex_B2_s2: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 21:15:35,594  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=0), errors=4
2026-02-23 21:15:36,529  INFO      checkpoint_e    [Oracle Pre-Fix] 5/11 candidates are correct
2026-02-23 21:15:43,598  INFO      checkpoint_e    [Oracle Post-Fix] 9/11 fixed candidates are correct
2026-02-23 21:15:43,599  INFO      checkpoint_e    [Fixing] needed_fix=4, fixed_ok=4, still_failing=0 | orig_success=7/11, post_success=11/11
2026-02-23 21:15:45,969  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:15:45,980  INFO      checkpoint_e    [Selection] method=tournament, clusters=2, oracle_match=True, final_sql=SELECT T2.School, T2.Street FROM frpm AS T1 JOIN schools AS ...
2026-02-23 21:15:45,996  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: SELECT T2.School, T2.Street FROM frpm AS T1 JOIN schools AS ...
2026-02-23 21:15:46,023  INFO      checkpoint_e  [3/33] Processing Q#28 (california_schools, challenging): Consider the average difference between K-12 enrollment and 15-17 enrollment of 
2026-02-23 21:15:51,624  INFO      checkpoint_e    [Grounding] cell_matches=10, few_shot=8, schema_hints=5
2026-02-23 21:17:51,634  ERROR     checkpoint_e    [Schema Linking] TIMEOUT after 120s — using full DDL fallback
2026-02-23 21:17:59,061  ERROR     src.generation.icl_generator  ICLGenerator icl_C1 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:18:01,017  ERROR     src.generation.icl_generator  ICLGenerator icl_C3 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:18:06,480  ERROR     src.generation.icl_generator  ICLGenerator icl_C2 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:18:34,524  WARNING   src.generation.standard_generator  StandardAndComplexGenerator complex_B2_s2: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 21:18:34,530  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=0), errors=4
2026-02-23 21:18:34,710  INFO      checkpoint_e    [Oracle Pre-Fix] 0/11 candidates are correct
2026-02-23 21:18:47,566  INFO      checkpoint_e    [Oracle Post-Fix] 0/11 fixed candidates are correct
2026-02-23 21:18:47,567  INFO      checkpoint_e    [Fixing] needed_fix=5, fixed_ok=2, still_failing=3 | orig_success=6/11, post_success=8/11
2026-02-23 21:18:49,800  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:18:49,804  INFO      checkpoint_e    [Selection] method=tournament, clusters=2, oracle_match=False, final_sql=SELECT T2.School, T2.DOCType FROM frpm AS T1 INNER JOIN scho...
2026-02-23 21:18:49,821  INFO      checkpoint_e    -> WRONG | oracle_pre=False oracle_post=False selector_match=False | final_sql: SELECT T2.School, T2.DOCType FROM frpm AS T1 INNER JOIN scho...
2026-02-23 21:18:49,838  INFO      checkpoint_e  [4/33] Processing Q#463 (card_games, simple): How many translations are there for the set of cards with "Angel of Mercy" in it
2026-02-23 21:18:55,221  INFO      checkpoint_e    [Grounding] cell_matches=3, few_shot=8, schema_hints=2
2026-02-23 21:20:55,259  ERROR     checkpoint_e    [Schema Linking] TIMEOUT after 120s — using full DDL fallback
2026-02-23 21:21:22,380  WARNING   src.generation.icl_generator  ICLGenerator icl_C2: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 21:21:31,114  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=2), errors=1
2026-02-23 21:21:32,248  INFO      checkpoint_e    [Oracle Pre-Fix] 1/11 candidates are correct
2026-02-23 21:21:41,129  INFO      checkpoint_e    [Oracle Post-Fix] 1/11 fixed candidates are correct
2026-02-23 21:21:41,131  INFO      checkpoint_e    [Fixing] needed_fix=2, fixed_ok=2, still_failing=0 | orig_success=9/11, post_success=11/11
2026-02-23 21:21:43,750  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:21:43,872  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:21:43,887  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:21:43,905  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:21:43,919  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:21:43,955  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:21:44,116  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:21:44,179  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:21:44,188  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:21:44,226  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:21:44,714  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:21:44,800  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:21:44,804  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:21:44,816  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:21:44,887  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:21:44,889  INFO      checkpoint_e    [Selection] method=tournament, clusters=6, oracle_match=False, final_sql=SELECT COUNT(T2.id) FROM cards AS T1 JOIN set_translations A...
2026-02-23 21:21:45,425  INFO      checkpoint_e    -> WRONG | oracle_pre=True oracle_post=True selector_match=False | final_sql: SELECT COUNT(T2.id) FROM cards AS T1 JOIN set_translations A...
2026-02-23 21:21:45,434  INFO      checkpoint_e  [5/33] Processing Q#427 (card_games, moderate): What languages are available in the set known as Archenemy on the magic card mar
2026-02-23 21:21:48,568  INFO      checkpoint_e    [Grounding] cell_matches=9, few_shot=8, schema_hints=3
2026-02-23 21:22:49,435  INFO      checkpoint_e    [Schema Linking] s1_fields=6, s2_fields=13
2026-02-23 21:22:49,436  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 21:23:41,637  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=3), errors=0
2026-02-23 21:23:42,778  INFO      checkpoint_e    [Oracle Pre-Fix] 9/11 candidates are correct
2026-02-23 21:24:22,745  INFO      checkpoint_e    [Oracle Post-Fix] 9/11 fixed candidates are correct
2026-02-23 21:24:22,746  INFO      checkpoint_e    [Fixing] needed_fix=2, fixed_ok=0, still_failing=2 | orig_success=9/11, post_success=9/11
2026-02-23 21:24:22,757  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=True, final_sql=SELECT T1.language FROM set_translations AS T1 JOIN sets AS ...
2026-02-23 21:24:22,757  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: SELECT T1.language FROM set_translations AS T1 JOIN sets AS ...
2026-02-23 21:24:22,758  INFO      checkpoint_e  [6/33] Processing Q#431 (card_games, challenging): Which set is not available outside of the United States and has foil cards with 
2026-02-23 21:24:26,771  INFO      checkpoint_e    [Grounding] cell_matches=14, few_shot=8, schema_hints=4
2026-02-23 21:25:47,385  INFO      checkpoint_e    [Schema Linking] s1_fields=8, s2_fields=18
2026-02-23 21:25:47,386  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 21:26:49,336  WARNING   src.generation.icl_generator  ICLGenerator icl_C3: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 21:26:49,337  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=2), errors=1
2026-02-23 21:26:50,572  INFO      checkpoint_e    [Oracle Pre-Fix] 1/11 candidates are correct
2026-02-23 21:27:01,969  INFO      checkpoint_e    [Oracle Post-Fix] 1/11 fixed candidates are correct
2026-02-23 21:27:01,970  INFO      checkpoint_e    [Fixing] needed_fix=3, fixed_ok=0, still_failing=3 | orig_success=8/11, post_success=8/11
2026-02-23 21:27:04,275  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:27:04,283  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:27:04,335  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:27:04,387  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:27:04,388  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:27:04,400  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:27:04,435  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:27:04,795  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:27:04,823  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:27:04,881  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:27:04,882  INFO      checkpoint_e    [Selection] method=tournament, clusters=5, oracle_match=False, final_sql=SELECT DISTINCT T1.id FROM sets AS T1 INNER JOIN cards AS T2...
2026-02-23 21:27:04,975  INFO      checkpoint_e    -> WRONG | oracle_pre=True oracle_post=True selector_match=False | final_sql: SELECT DISTINCT T1.id FROM sets AS T1 INNER JOIN cards AS T2...
2026-02-23 21:27:04,978  INFO      checkpoint_e  [7/33] Processing Q#601 (codebase_community, simple): What is the score and the link type ID for post ID 395?
2026-02-23 21:27:07,110  INFO      checkpoint_e    [Grounding] cell_matches=3, few_shot=8, schema_hints=3
2026-02-23 21:27:50,020  INFO      checkpoint_e    [Schema Linking] s1_fields=9, s2_fields=19
2026-02-23 21:27:50,023  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 21:28:14,770  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=3), errors=0
2026-02-23 21:28:14,799  INFO      checkpoint_e    [Oracle Pre-Fix] 11/11 candidates are correct
2026-02-23 21:28:14,824  INFO      checkpoint_e    [Oracle Post-Fix] 11/11 fixed candidates are correct
2026-02-23 21:28:14,824  INFO      checkpoint_e    [Fixing] needed_fix=0, fixed_ok=0, still_failing=0 | orig_success=11/11, post_success=11/11
2026-02-23 21:28:14,838  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=True, final_sql=SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 JOIN postLin...
2026-02-23 21:28:14,839  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: SELECT T1.Score, T2.LinkTypeId FROM posts AS T1 JOIN postLin...
2026-02-23 21:28:14,841  INFO      checkpoint_e  [8/33] Processing Q#571 (codebase_community, moderate): For the user No.24, how many times is the number of his/her posts compared to hi
2026-02-23 21:28:18,006  INFO      checkpoint_e    [Grounding] cell_matches=1, few_shot=8, schema_hints=4
2026-02-23 21:29:19,138  INFO      checkpoint_e    [Schema Linking] s1_fields=8, s2_fields=18
2026-02-23 21:29:19,143  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 21:30:49,158  ERROR     checkpoint_e    [Generation] TIMEOUT after 90s — no candidates produced
2026-02-23 21:30:49,160  WARNING   checkpoint_e    [Fixing] Skipped (no candidates)
2026-02-23 21:30:49,160  WARNING   checkpoint_e    [Selection] Skipped (no fixed candidates)
2026-02-23 21:30:49,160  INFO      checkpoint_e    -> WRONG | oracle_pre=False oracle_post=False selector_match=False | final_sql: ...
2026-02-23 21:30:49,162  INFO      checkpoint_e  [9/33] Processing Q#586 (codebase_community, challenging): Which user added a bounty amount of 50 to the post title mentioning variance?
2026-02-23 21:30:52,892  INFO      checkpoint_e    [Grounding] cell_matches=4, few_shot=8, schema_hints=3
2026-02-23 21:32:21,769  INFO      checkpoint_e    [Schema Linking] s1_fields=12, s2_fields=19
2026-02-23 21:32:21,771  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 21:32:28,782  ERROR     src.generation.icl_generator  ICLGenerator icl_C3 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:32:30,547  ERROR     src.generation.icl_generator  ICLGenerator icl_C1 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:32:31,852  ERROR     src.generation.icl_generator  ICLGenerator icl_C2 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:32:57,891  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=0), errors=3
2026-02-23 21:32:57,935  INFO      checkpoint_e    [Oracle Pre-Fix] 0/11 candidates are correct
2026-02-23 21:33:01,164  INFO      checkpoint_e    [Oracle Post-Fix] 0/11 fixed candidates are correct
2026-02-23 21:33:01,164  INFO      checkpoint_e    [Fixing] needed_fix=3, fixed_ok=3, still_failing=0 | orig_success=8/11, post_success=11/11
2026-02-23 21:33:01,192  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=False, final_sql=SELECT T1.DisplayName FROM users AS T1 JOIN votes AS T2 ON T...
2026-02-23 21:33:01,194  INFO      checkpoint_e    -> WRONG | oracle_pre=False oracle_post=False selector_match=False | final_sql: SELECT T1.DisplayName FROM users AS T1 JOIN votes AS T2 ON T...
2026-02-23 21:33:01,197  INFO      checkpoint_e  [10/33] Processing Q#1519 (debit_card_specializing, simple): What was the product id of the transaction happened at 2012/8/23 21:20:00?
2026-02-23 21:33:03,671  INFO      checkpoint_e    [Grounding] cell_matches=2, few_shot=8, schema_hints=3
2026-02-23 21:33:54,573  INFO      checkpoint_e    [Schema Linking] s1_fields=4, s2_fields=7
2026-02-23 21:33:54,575  INFO      checkpoint_e    [Schema Recall] table_recall: S1=25% S2=25% | col_recall: S1=60% S2=60%
2026-02-23 21:34:16,965  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=3), errors=0
2026-02-23 21:34:17,041  INFO      checkpoint_e    [Oracle Pre-Fix] 11/11 candidates are correct
2026-02-23 21:34:17,121  INFO      checkpoint_e    [Oracle Post-Fix] 11/11 fixed candidates are correct
2026-02-23 21:34:17,122  INFO      checkpoint_e    [Fixing] needed_fix=0, fixed_ok=0, still_failing=0 | orig_success=11/11, post_success=11/11
2026-02-23 21:34:17,173  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=True, final_sql=SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-...
2026-02-23 21:34:17,178  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: SELECT ProductID FROM transactions_1k WHERE Date = '2012-08-...
2026-02-23 21:34:17,187  INFO      checkpoint_e  [11/33] Processing Q#1474 (debit_card_specializing, moderate): Which customers, paying in CZK, consumed the most gas in 2011?
2026-02-23 21:34:19,941  INFO      checkpoint_e    [Grounding] cell_matches=2, few_shot=8, schema_hints=3
2026-02-23 21:35:17,334  INFO      checkpoint_e    [Schema Linking] s1_fields=5, s2_fields=15
2026-02-23 21:35:17,338  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 21:35:25,713  ERROR     src.generation.icl_generator  ICLGenerator icl_C1 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:35:26,398  ERROR     src.generation.icl_generator  ICLGenerator icl_C2 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:35:26,699  ERROR     src.generation.icl_generator  ICLGenerator icl_C3 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:35:42,445  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=0), errors=3
2026-02-23 21:35:42,464  INFO      checkpoint_e    [Oracle Pre-Fix] 6/11 candidates are correct
2026-02-23 21:35:52,334  INFO      checkpoint_e    [Oracle Post-Fix] 9/11 fixed candidates are correct
2026-02-23 21:35:52,339  INFO      checkpoint_e    [Fixing] needed_fix=3, fixed_ok=3, still_failing=0 | orig_success=8/11, post_success=11/11
2026-02-23 21:35:54,342  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:35:54,362  INFO      checkpoint_e    [Selection] method=tournament, clusters=2, oracle_match=True, final_sql=SELECT T1.CustomerID FROM customers AS T1 JOIN yearmonth AS ...
2026-02-23 21:35:54,366  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: SELECT T1.CustomerID FROM customers AS T1 JOIN yearmonth AS ...
2026-02-23 21:35:54,415  INFO      checkpoint_e  [12/33] Processing Q#1526 (debit_card_specializing, challenging): For the customer who paid 634.8 in 2012/8/25, what was the consumption decrease 
2026-02-23 21:35:57,707  WARNING   src.grounding.context_grounder  Grounding LLM error for question 'For the customer who paid 634.8 in 2012/8/25, what was the c' — falling back to keyword extraction (15 tokens extracted): Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL)
2026-02-23 21:35:58,300  INFO      checkpoint_e    [Grounding] cell_matches=2, few_shot=8, schema_hints=0
2026-02-23 21:36:56,926  INFO      checkpoint_e    [Schema Linking] s1_fields=7, s2_fields=11
2026-02-23 21:36:56,929  INFO      checkpoint_e    [Schema Recall] table_recall: S1=40% S2=40% | col_recall: S1=60% S2=60%
2026-02-23 21:37:04,122  ERROR     src.generation.icl_generator  ICLGenerator icl_C1 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:37:04,262  ERROR     src.generation.icl_generator  ICLGenerator icl_C3 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:37:04,905  ERROR     src.generation.icl_generator  ICLGenerator icl_C2 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:37:21,412  WARNING   src.generation.standard_generator  StandardAndComplexGenerator complex_B2_s1: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 21:37:30,669  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=0), errors=4
2026-02-23 21:37:31,556  INFO      checkpoint_e    [Oracle Pre-Fix] 4/11 candidates are correct
2026-02-23 21:37:45,093  INFO      checkpoint_e    [Oracle Post-Fix] 4/11 fixed candidates are correct
2026-02-23 21:37:45,095  INFO      checkpoint_e    [Fixing] needed_fix=7, fixed_ok=0, still_failing=7 | orig_success=4/11, post_success=4/11
2026-02-23 21:37:45,888  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=True, final_sql=WITH TargetCustomer AS ( SELECT CustomerID FROM transactions...
2026-02-23 21:37:46,044  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: WITH TargetCustomer AS ( SELECT CustomerID FROM transactions...
2026-02-23 21:37:46,054  INFO      checkpoint_e  [13/33] Processing Q#1027 (european_football_2, simple): Indicate the full names of the top 10 players with the highest number of penalti
2026-02-23 21:37:49,320  INFO      checkpoint_e    [Grounding] cell_matches=0, few_shot=8, schema_hints=2
2026-02-23 21:39:30,255  INFO      checkpoint_e    [Schema Linking] s1_fields=8, s2_fields=8
2026-02-23 21:39:30,256  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 21:39:38,072  ERROR     src.generation.icl_generator  ICLGenerator icl_C2 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:39:38,608  ERROR     src.generation.icl_generator  ICLGenerator icl_C3 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:39:39,468  ERROR     src.generation.icl_generator  ICLGenerator icl_C1 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:40:01,812  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=0), errors=3
2026-02-23 21:40:32,690  INFO      checkpoint_e    [Oracle Pre-Fix] 0/11 candidates are correct
2026-02-23 21:41:38,117  INFO      checkpoint_e    [Oracle Post-Fix] 0/11 fixed candidates are correct
2026-02-23 21:41:38,118  INFO      checkpoint_e    [Fixing] needed_fix=4, fixed_ok=4, still_failing=0 | orig_success=7/11, post_success=11/11
2026-02-23 21:41:41,132  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:41:41,139  INFO      checkpoint_e    [Selection] method=tournament, clusters=2, oracle_match=False, final_sql=SELECT T1.player_name FROM Player AS T1 INNER JOIN Player_At...
2026-02-23 21:41:41,265  INFO      checkpoint_e    -> WRONG | oracle_pre=False oracle_post=False selector_match=False | final_sql: SELECT T1.player_name FROM Player AS T1 INNER JOIN Player_At...
2026-02-23 21:41:41,284  INFO      checkpoint_e  [14/33] Processing Q#1025 (european_football_2, moderate): Give the name of the league had the most goals in the 2016 season?
2026-02-23 21:41:45,600  INFO      checkpoint_e    [Grounding] cell_matches=1, few_shot=8, schema_hints=3
2026-02-23 21:43:05,072  INFO      checkpoint_e    [Schema Linking] s1_fields=20, s2_fields=25
2026-02-23 21:43:05,074  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 21:43:51,277  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=3), errors=0
2026-02-23 21:43:52,912  INFO      checkpoint_e    [Oracle Pre-Fix] 11/11 candidates are correct
2026-02-23 21:43:53,434  INFO      checkpoint_e    [Oracle Post-Fix] 11/11 fixed candidates are correct
2026-02-23 21:43:53,434  INFO      checkpoint_e    [Fixing] needed_fix=0, fixed_ok=0, still_failing=0 | orig_success=11/11, post_success=11/11
2026-02-23 21:43:53,617  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=True, final_sql=SELECT T2.name FROM Match AS T1 JOIN League AS T2 ON T1.leag...
2026-02-23 21:43:53,630  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: SELECT T2.name FROM Match AS T1 JOIN League AS T2 ON T1.leag...
2026-02-23 21:43:53,630  INFO      checkpoint_e  [15/33] Processing Q#1031 (european_football_2, challenging): At present, calculate for the player's age who have a sprint speed of no less th
2026-02-23 21:43:56,767  INFO      checkpoint_e    [Grounding] cell_matches=3, few_shot=8, schema_hints=3
2026-02-23 21:44:55,197  INFO      checkpoint_e    [Schema Linking] s1_fields=9, s2_fields=9
2026-02-23 21:44:55,199  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 21:45:01,722  ERROR     src.generation.icl_generator  ICLGenerator icl_C3 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:45:02,982  ERROR     src.generation.icl_generator  ICLGenerator icl_C1 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:45:03,575  ERROR     src.generation.icl_generator  ICLGenerator icl_C2 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:45:29,384  WARNING   src.generation.standard_generator  StandardAndComplexGenerator complex_B2_s1: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 21:45:33,381  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=0), errors=4
2026-02-23 21:45:33,768  INFO      checkpoint_e    [Oracle Pre-Fix] 1/11 candidates are correct
2026-02-23 21:45:45,545  INFO      checkpoint_e    [Oracle Post-Fix] 1/11 fixed candidates are correct
2026-02-23 21:45:45,547  INFO      checkpoint_e    [Fixing] needed_fix=4, fixed_ok=0, still_failing=4 | orig_success=7/11, post_success=7/11
2026-02-23 21:45:47,858  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:45:48,148  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:45:48,202  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:45:48,240  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:45:48,259  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:45:48,293  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:45:48,293  INFO      checkpoint_e    [Selection] method=tournament, clusters=4, oracle_match=False, final_sql=SELECT CAST((julianday('now') - julianday(T1.birthday)) / 36...
2026-02-23 21:45:48,320  INFO      checkpoint_e    -> WRONG | oracle_pre=True oracle_post=True selector_match=False | final_sql: SELECT CAST((julianday('now') - julianday(T1.birthday)) / 36...
2026-02-23 21:45:48,325  INFO      checkpoint_e  [16/33] Processing Q#109 (financial, simple): How many clients opened their accounts in Jesenik branch were women?
2026-02-23 21:45:52,104  WARNING   src.grounding.context_grounder  Grounding LLM error for question 'How many clients opened their accounts in Jesenik branch wer' — falling back to keyword extraction (17 tokens extracted): Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL)
2026-02-23 21:45:52,646  INFO      checkpoint_e    [Grounding] cell_matches=1, few_shot=8, schema_hints=0
2026-02-23 21:47:01,765  INFO      checkpoint_e    [Schema Linking] s1_fields=10, s2_fields=15
2026-02-23 21:47:01,767  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 21:47:29,198  WARNING   src.generation.icl_generator  ICLGenerator icl_C2: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 21:48:10,117  WARNING   src.generation.icl_generator  ICLGenerator icl_C3: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 21:48:10,118  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=1), errors=2
2026-02-23 21:48:10,143  INFO      checkpoint_e    [Oracle Pre-Fix] 0/11 candidates are correct
2026-02-23 21:48:20,720  INFO      checkpoint_e    [Oracle Post-Fix] 0/11 fixed candidates are correct
2026-02-23 21:48:20,722  INFO      checkpoint_e    [Fixing] needed_fix=3, fixed_ok=3, still_failing=0 | orig_success=8/11, post_success=11/11
2026-02-23 21:48:20,749  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=False, final_sql=SELECT COUNT(DISTINCT T1.client_id) FROM client AS T1 JOIN d...
2026-02-23 21:48:20,751  INFO      checkpoint_e    -> WRONG | oracle_pre=False oracle_post=False selector_match=False | final_sql: SELECT COUNT(DISTINCT T1.client_id) FROM client AS T1 JOIN d...
2026-02-23 21:48:20,751  INFO      checkpoint_e  [17/33] Processing Q#135 (financial, moderate): After making a credit card withdrawal, how many account/s with monthly issuance 
2026-02-23 21:48:25,168  INFO      checkpoint_e    [Grounding] cell_matches=7, few_shot=8, schema_hints=3
2026-02-23 21:49:55,125  INFO      checkpoint_e    [Schema Linking] s1_fields=7, s2_fields=17
2026-02-23 21:49:55,127  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 21:50:02,913  ERROR     src.generation.icl_generator  ICLGenerator icl_C1 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:50:03,554  ERROR     src.generation.icl_generator  ICLGenerator icl_C2 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:50:04,006  ERROR     src.generation.icl_generator  ICLGenerator icl_C3 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:50:25,122  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=0), errors=3
2026-02-23 21:50:26,367  INFO      checkpoint_e    [Oracle Pre-Fix] 0/11 candidates are correct
2026-02-23 21:51:00,154  INFO      checkpoint_e    [Oracle Post-Fix] 0/11 fixed candidates are correct
2026-02-23 21:51:00,156  INFO      checkpoint_e    [Fixing] needed_fix=3, fixed_ok=3, still_failing=0 | orig_success=8/11, post_success=11/11
2026-02-23 21:51:01,148  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=False, final_sql=SELECT COUNT(DISTINCT T1.account_id) FROM account AS T1 JOIN...
2026-02-23 21:51:01,227  INFO      checkpoint_e    -> WRONG | oracle_pre=False oracle_post=False selector_match=False | final_sql: SELECT COUNT(DISTINCT T1.account_id) FROM account AS T1 JOIN...
2026-02-23 21:51:01,231  INFO      checkpoint_e  [18/33] Processing Q#149 (financial, challenging): Please list the account types that are not eligible for loans, and the average i
2026-02-23 21:51:04,302  INFO      checkpoint_e    [Grounding] cell_matches=1, few_shot=8, schema_hints=2
2026-02-23 21:52:06,833  WARNING   src.llm.gemini_client  Gemini response has no text or tool output: finish_reason=FinishReason.MAX_TOKENS, safety_ratings=None, parts(thought,has_text)=[]
2026-02-23 21:52:06,838  WARNING   src.llm.gemini_client  MAX_TOKENS hit with no output (max_tokens=8192); retrying with max_tokens=8192
2026-02-23 21:53:04,325  ERROR     checkpoint_e    [Schema Linking] TIMEOUT after 120s — using full DDL fallback
2026-02-23 21:53:11,577  ERROR     src.generation.icl_generator  ICLGenerator icl_C3 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:53:19,211  ERROR     src.generation.icl_generator  ICLGenerator icl_C1 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:53:20,470  ERROR     src.generation.icl_generator  ICLGenerator icl_C2 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 21:53:33,188  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=0), errors=3
2026-02-23 21:53:33,212  INFO      checkpoint_e    [Oracle Pre-Fix] 0/11 candidates are correct
2026-02-23 21:53:44,199  INFO      checkpoint_e    [Oracle Post-Fix] 0/11 fixed candidates are correct
2026-02-23 21:53:44,200  INFO      checkpoint_e    [Fixing] needed_fix=3, fixed_ok=3, still_failing=0 | orig_success=8/11, post_success=11/11
2026-02-23 21:53:44,212  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=False, final_sql=SELECT DISTINCT T1.type FROM disp AS T1 JOIN account AS T2 O...
2026-02-23 21:53:44,213  INFO      checkpoint_e    -> WRONG | oracle_pre=False oracle_post=False selector_match=False | final_sql: SELECT DISTINCT T1.type FROM disp AS T1 JOIN account AS T2 O...
2026-02-23 21:53:44,214  INFO      checkpoint_e  [19/33] Processing Q#953 (formula_1, simple): How many French constructors have a lap number of over 50?
2026-02-23 21:53:47,376  INFO      checkpoint_e    [Grounding] cell_matches=3, few_shot=8, schema_hints=3
2026-02-23 21:55:28,501  INFO      checkpoint_e    [Schema Linking] s1_fields=8, s2_fields=18
2026-02-23 21:55:28,507  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 21:55:58,364  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=3), errors=0
2026-02-23 21:55:58,568  INFO      checkpoint_e    [Oracle Pre-Fix] 9/11 candidates are correct
2026-02-23 21:55:58,691  INFO      checkpoint_e    [Oracle Post-Fix] 9/11 fixed candidates are correct
2026-02-23 21:55:58,692  INFO      checkpoint_e    [Fixing] needed_fix=0, fixed_ok=0, still_failing=0 | orig_success=11/11, post_success=11/11
2026-02-23 21:56:00,846  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:56:00,852  INFO      checkpoint_e    [Selection] method=tournament, clusters=2, oracle_match=True, final_sql=SELECT COUNT(DISTINCT T1.constructorId) FROM constructors AS...
2026-02-23 21:56:00,858  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: SELECT COUNT(DISTINCT T1.constructorId) FROM constructors AS...
2026-02-23 21:56:00,869  INFO      checkpoint_e  [20/33] Processing Q#852 (formula_1, moderate): How many races in the year 2010 are held on grand prixs outside Asia and Europe?
2026-02-23 21:56:03,442  INFO      checkpoint_e    [Grounding] cell_matches=3, few_shot=8, schema_hints=2
2026-02-23 21:57:11,946  INFO      checkpoint_e    [Schema Linking] s1_fields=6, s2_fields=11
2026-02-23 21:57:11,947  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 21:57:39,900  WARNING   src.generation.icl_generator  ICLGenerator icl_C2: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 21:57:39,959  WARNING   src.generation.icl_generator  ICLGenerator icl_C3: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 21:57:48,201  WARNING   src.generation.standard_generator  StandardAndComplexGenerator complex_B2_s1: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 21:58:13,109  WARNING   src.generation.standard_generator  StandardAndComplexGenerator complex_B2_s2: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 21:58:13,111  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=1), errors=4
2026-02-23 21:58:13,121  INFO      checkpoint_e    [Oracle Pre-Fix] 3/11 candidates are correct
2026-02-23 21:58:22,923  INFO      checkpoint_e    [Oracle Post-Fix] 3/11 fixed candidates are correct
2026-02-23 21:58:22,925  INFO      checkpoint_e    [Fixing] needed_fix=4, fixed_ok=4, still_failing=0 | orig_success=7/11, post_success=11/11
2026-02-23 21:58:25,022  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:58:25,080  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:58:25,097  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:58:25,123  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:58:25,149  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:58:25,226  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 21:58:25,227  INFO      checkpoint_e    [Selection] method=tournament, clusters=4, oracle_match=True, final_sql=SELECT COUNT(T1.raceId) FROM races AS T1 INNER JOIN circuits...
2026-02-23 21:58:25,228  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: SELECT COUNT(T1.raceId) FROM races AS T1 INNER JOIN circuits...
2026-02-23 21:58:25,232  INFO      checkpoint_e  [21/33] Processing Q#994 (formula_1, challenging): Which constructor scored most points from Monaco Grand Prix between 1980 and 201
2026-02-23 21:58:27,744  INFO      checkpoint_e    [Grounding] cell_matches=9, few_shot=8, schema_hints=6
2026-02-23 22:00:27,763  ERROR     checkpoint_e    [Schema Linking] TIMEOUT after 120s — using full DDL fallback
2026-02-23 22:01:15,953  WARNING   src.generation.standard_generator  StandardAndComplexGenerator complex_B2_s2: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 22:01:26,374  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=3), errors=1
2026-02-23 22:01:26,438  INFO      checkpoint_e    [Oracle Pre-Fix] 10/11 candidates are correct
2026-02-23 22:01:37,463  INFO      checkpoint_e    [Oracle Post-Fix] 11/11 fixed candidates are correct
2026-02-23 22:01:37,463  INFO      checkpoint_e    [Fixing] needed_fix=1, fixed_ok=1, still_failing=0 | orig_success=10/11, post_success=11/11
2026-02-23 22:01:37,492  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=True, final_sql=SELECT SUM(T1.points), T2.name, T2.nationality FROM construc...
2026-02-23 22:01:37,495  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: SELECT SUM(T1.points), T2.name, T2.nationality FROM construc...
2026-02-23 22:01:37,497  INFO      checkpoint_e  [22/33] Processing Q#1349 (student_club, simple): Provide the total number of the budget amount for "September Speaker" event.
2026-02-23 22:01:40,066  INFO      checkpoint_e    [Grounding] cell_matches=4, few_shot=8, schema_hints=1
2026-02-23 22:03:00,380  INFO      checkpoint_e    [Schema Linking] s1_fields=5, s2_fields=15
2026-02-23 22:03:00,382  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 22:03:26,524  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=3), errors=0
2026-02-23 22:03:26,557  INFO      checkpoint_e    [Oracle Pre-Fix] 11/11 candidates are correct
2026-02-23 22:03:26,580  INFO      checkpoint_e    [Oracle Post-Fix] 11/11 fixed candidates are correct
2026-02-23 22:03:26,580  INFO      checkpoint_e    [Fixing] needed_fix=0, fixed_ok=0, still_failing=0 | orig_success=11/11, post_success=11/11
2026-02-23 22:03:26,587  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=True, final_sql=SELECT SUM(T1.amount) FROM budget AS T1 JOIN event AS T2 ON ...
2026-02-23 22:03:26,587  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: SELECT SUM(T1.amount) FROM budget AS T1 JOIN event AS T2 ON ...
2026-02-23 22:03:26,590  INFO      checkpoint_e  [23/33] Processing Q#1456 (student_club, moderate): List the full name of the top five members who spend the most money in the desce
2026-02-23 22:03:29,327  INFO      checkpoint_e    [Grounding] cell_matches=0, few_shot=8, schema_hints=4
2026-02-23 22:05:06,242  INFO      checkpoint_e    [Schema Linking] s1_fields=9, s2_fields=19
2026-02-23 22:05:06,243  INFO      checkpoint_e    [Schema Recall] table_recall: S1=33% S2=50% | col_recall: S1=71% S2=100%
2026-02-23 22:06:04,644  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=3), errors=0
2026-02-23 22:06:04,653  INFO      checkpoint_e    [Oracle Pre-Fix] 0/11 candidates are correct
2026-02-23 22:06:04,661  INFO      checkpoint_e    [Oracle Post-Fix] 0/11 fixed candidates are correct
2026-02-23 22:06:04,661  INFO      checkpoint_e    [Fixing] needed_fix=0, fixed_ok=0, still_failing=0 | orig_success=11/11, post_success=11/11
2026-02-23 22:06:06,548  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 22:06:06,573  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 22:06:06,588  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 22:06:06,589  INFO      checkpoint_e    [Selection] method=tournament, clusters=3, oracle_match=False, final_sql=SELECT T1.first_name, T1.last_name FROM member AS T1 JOIN ex...
2026-02-23 22:06:06,590  INFO      checkpoint_e    -> WRONG | oracle_pre=False oracle_post=False selector_match=False | final_sql: SELECT T1.first_name, T1.last_name FROM member AS T1 JOIN ex...
2026-02-23 22:06:06,601  INFO      checkpoint_e  [24/33] Processing Q#1464 (student_club, challenging): Write the full names of students who received funds on the date of 9/9/2019 and 
2026-02-23 22:06:09,160  INFO      checkpoint_e    [Grounding] cell_matches=0, few_shot=8, schema_hints=4
2026-02-23 22:07:05,776  INFO      checkpoint_e    [Schema Linking] s1_fields=9, s2_fields=18
2026-02-23 22:07:05,779  INFO      checkpoint_e    [Schema Recall] table_recall: S1=25% S2=25% | col_recall: S1=78% S2=89%
2026-02-23 22:08:02,691  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=3), errors=0
2026-02-23 22:08:02,703  INFO      checkpoint_e    [Oracle Pre-Fix] 11/11 candidates are correct
2026-02-23 22:08:02,712  INFO      checkpoint_e    [Oracle Post-Fix] 11/11 fixed candidates are correct
2026-02-23 22:08:02,712  INFO      checkpoint_e    [Fixing] needed_fix=0, fixed_ok=0, still_failing=0 | orig_success=11/11, post_success=11/11
2026-02-23 22:08:02,717  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=True, final_sql=SELECT T1.first_name, T1.last_name, T2.amount FROM member AS...
2026-02-23 22:08:02,718  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: SELECT T1.first_name, T1.last_name, T2.amount FROM member AS...
2026-02-23 22:08:02,720  INFO      checkpoint_e  [25/33] Processing Q#803 (superhero, simple): What is the power ID of cryokinesis?
2026-02-23 22:08:04,779  INFO      checkpoint_e    [Grounding] cell_matches=1, few_shot=8, schema_hints=2
2026-02-23 22:09:24,987  INFO      checkpoint_e    [Schema Linking] s1_fields=2, s2_fields=4
2026-02-23 22:09:24,989  INFO      checkpoint_e    [Schema Recall] table_recall: S1=100% S2=100% | col_recall: S1=100% S2=100%
2026-02-23 22:10:02,470  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=3), errors=0
2026-02-23 22:10:02,483  INFO      checkpoint_e    [Oracle Pre-Fix] 10/11 candidates are correct
2026-02-23 22:10:04,255  INFO      checkpoint_e    [Oracle Post-Fix] 11/11 fixed candidates are correct
2026-02-23 22:10:04,255  INFO      checkpoint_e    [Fixing] needed_fix=1, fixed_ok=1, still_failing=0 | orig_success=10/11, post_success=11/11
2026-02-23 22:10:04,265  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=True, final_sql=SELECT id FROM superpower WHERE power_name = 'Cryokinesis'...
2026-02-23 22:10:04,266  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: SELECT id FROM superpower WHERE power_name = 'Cryokinesis'...
2026-02-23 22:10:04,267  INFO      checkpoint_e  [26/33] Processing Q#782 (superhero, moderate): List the heroes' names whose eyes and hair colours are both black.
2026-02-23 22:10:06,452  INFO      checkpoint_e    [Grounding] cell_matches=2, few_shot=8, schema_hints=4
2026-02-23 22:12:02,594  INFO      checkpoint_e    [Schema Linking] s1_fields=11, s2_fields=17
2026-02-23 22:12:02,596  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 22:12:36,925  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=3), errors=0
2026-02-23 22:12:36,939  INFO      checkpoint_e    [Oracle Pre-Fix] 11/11 candidates are correct
2026-02-23 22:12:36,952  INFO      checkpoint_e    [Oracle Post-Fix] 11/11 fixed candidates are correct
2026-02-23 22:12:36,952  INFO      checkpoint_e    [Fixing] needed_fix=0, fixed_ok=0, still_failing=0 | orig_success=11/11, post_success=11/11
2026-02-23 22:12:36,959  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=True, final_sql=SELECT T1.superhero_name FROM superhero AS T1 JOIN colour AS...
2026-02-23 22:12:36,959  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: SELECT T1.superhero_name FROM superhero AS T1 JOIN colour AS...
2026-02-23 22:12:36,960  INFO      checkpoint_e  [27/33] Processing Q#773 (superhero, challenging): Which superhero has the same eyes, hair and skin colour? Indicate the publisher 
2026-02-23 22:12:40,343  INFO      checkpoint_e    [Grounding] cell_matches=0, few_shot=8, schema_hints=5
2026-02-23 22:14:40,379  ERROR     checkpoint_e    [Schema Linking] TIMEOUT after 120s — using full DDL fallback
2026-02-23 22:15:25,287  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=3), errors=0
2026-02-23 22:15:25,301  INFO      checkpoint_e    [Oracle Pre-Fix] 9/11 candidates are correct
2026-02-23 22:15:34,073  INFO      checkpoint_e    [Oracle Post-Fix] 10/11 fixed candidates are correct
2026-02-23 22:15:34,073  INFO      checkpoint_e    [Fixing] needed_fix=1, fixed_ok=1, still_failing=0 | orig_success=10/11, post_success=11/11
2026-02-23 22:15:36,336  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 22:15:36,339  INFO      checkpoint_e    [Selection] method=tournament, clusters=2, oracle_match=True, final_sql=SELECT S.superhero_name, P.publisher_name FROM superhero AS ...
2026-02-23 22:15:36,348  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: SELECT S.superhero_name, P.publisher_name FROM superhero AS ...
2026-02-23 22:15:36,365  INFO      checkpoint_e  [28/33] Processing Q#1276 (thrombosis_prediction, simple): For the patients who have an abnormal level of anti-DNA, please list the disease
2026-02-23 22:15:38,515  INFO      checkpoint_e    [Grounding] cell_matches=3, few_shot=8, schema_hints=2
2026-02-23 22:15:44,606  ERROR     src.schema_linking.schema_linker  Schema linker S1 LLM call failed (Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}); falling back to FAISS top-15 as S1.
2026-02-23 22:16:36,049  WARNING   src.schema_linking.schema_linker  Hallucinated field filtered out from S₂: Diagnosis.Diagnosis
2026-02-23 22:16:36,050  WARNING   src.schema_linking.schema_linker  Hallucinated field filtered out from S₂: Diagnosis.ID
2026-02-23 22:16:36,055  INFO      checkpoint_e    [Schema Linking] s1_fields=19, s2_fields=19
2026-02-23 22:16:36,056  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 22:16:44,849  ERROR     src.generation.icl_generator  ICLGenerator icl_C3 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 22:16:46,842  ERROR     src.generation.icl_generator  ICLGenerator icl_C1 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 22:16:48,811  ERROR     src.generation.icl_generator  ICLGenerator icl_C2 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 22:17:22,339  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=0), errors=3
2026-02-23 22:17:22,392  INFO      checkpoint_e    [Oracle Pre-Fix] 1/11 candidates are correct
2026-02-23 22:17:29,990  INFO      checkpoint_e    [Oracle Post-Fix] 3/11 fixed candidates are correct
2026-02-23 22:17:29,990  INFO      checkpoint_e    [Fixing] needed_fix=3, fixed_ok=3, still_failing=0 | orig_success=8/11, post_success=11/11
2026-02-23 22:17:31,913  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 22:17:32,132  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 22:17:32,307  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 22:17:32,319  INFO      checkpoint_e    [Selection] method=tournament, clusters=3, oracle_match=False, final_sql=SELECT DISTINCT T1.Diagnosis FROM Patient AS T1 JOIN Laborat...
2026-02-23 22:17:32,337  INFO      checkpoint_e    -> WRONG | oracle_pre=True oracle_post=True selector_match=False | final_sql: SELECT DISTINCT T1.Diagnosis FROM Patient AS T1 JOIN Laborat...
2026-02-23 22:17:32,369  INFO      checkpoint_e  [29/33] Processing Q#1225 (thrombosis_prediction, moderate): List and group all patients by sex for total bilirubin (T-BIL) level not within 
2026-02-23 22:17:35,762  INFO      checkpoint_e    [Grounding] cell_matches=1, few_shot=8, schema_hints=3
2026-02-23 22:17:42,582  ERROR     src.schema_linking.schema_linker  Schema linker S1 LLM call failed (Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}); falling back to FAISS top-15 as S1.
2026-02-23 22:19:35,807  ERROR     checkpoint_e    [Schema Linking] TIMEOUT after 120s — using full DDL fallback
2026-02-23 22:19:44,151  ERROR     src.generation.icl_generator  ICLGenerator icl_C1 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 22:19:48,623  ERROR     src.generation.icl_generator  ICLGenerator icl_C2 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 22:19:51,534  ERROR     src.generation.icl_generator  ICLGenerator icl_C3 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 22:20:31,424  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=0), errors=3
2026-02-23 22:20:31,527  INFO      checkpoint_e    [Oracle Pre-Fix] 0/11 candidates are correct
2026-02-23 22:20:42,095  INFO      checkpoint_e    [Oracle Post-Fix] 0/11 fixed candidates are correct
2026-02-23 22:20:42,096  INFO      checkpoint_e    [Fixing] needed_fix=3, fixed_ok=3, still_failing=0 | orig_success=8/11, post_success=11/11
2026-02-23 22:20:46,967  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 22:20:46,986  INFO      checkpoint_e    [Selection] method=tournament, clusters=2, oracle_match=False, final_sql=SELECT P.SEX, GROUP_CONCAT(DISTINCT P.ID) FROM Patient AS P ...
2026-02-23 22:20:46,999  INFO      checkpoint_e    -> WRONG | oracle_pre=False oracle_post=False selector_match=False | final_sql: SELECT P.SEX, GROUP_CONCAT(DISTINCT P.ID) FROM Patient AS P ...
2026-02-23 22:20:47,052  INFO      checkpoint_e  [30/33] Processing Q#1295 (thrombosis_prediction, challenging): Among the patients whose total bilirubin is over the normal range, how many of t
2026-02-23 22:20:49,666  INFO      checkpoint_e    [Grounding] cell_matches=2, few_shot=8, schema_hints=2
2026-02-23 22:22:49,694  ERROR     checkpoint_e    [Schema Linking] TIMEOUT after 120s — using full DDL fallback
2026-02-23 22:22:58,121  ERROR     src.generation.icl_generator  ICLGenerator icl_C1 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 22:23:00,417  ERROR     src.generation.icl_generator  ICLGenerator icl_C3 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 22:23:06,383  ERROR     src.generation.icl_generator  ICLGenerator icl_C2 failed: Gemini API call failed after retries: 400 INVALID_ARGUMENT. {'error': {'code': 400, 'message': 'CachedContent can not be used with GenerateContent request setting system_instruction, tools or tool_config.\n\nProposed fix: move those values to CachedContent from GenerateContent request.', 'status': 'INVALID_ARGUMENT'}}
2026-02-23 22:23:40,492  WARNING   src.generation.standard_generator  StandardAndComplexGenerator complex_B2_s2: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 22:23:40,498  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=0), errors=4
2026-02-23 22:23:40,520  INFO      checkpoint_e    [Oracle Pre-Fix] 0/11 candidates are correct
2026-02-23 22:23:49,409  INFO      checkpoint_e    [Oracle Post-Fix] 0/11 fixed candidates are correct
2026-02-23 22:23:49,411  INFO      checkpoint_e    [Fixing] needed_fix=4, fixed_ok=4, still_failing=0 | orig_success=7/11, post_success=11/11
2026-02-23 22:23:49,515  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=False, final_sql=SELECT COUNT(DISTINCT T1.ID) FROM Laboratory AS T1 JOIN Exam...
2026-02-23 22:23:49,515  INFO      checkpoint_e    -> WRONG | oracle_pre=False oracle_post=False selector_match=False | final_sql: SELECT COUNT(DISTINCT T1.ID) FROM Laboratory AS T1 JOIN Exam...
2026-02-23 22:23:49,519  INFO      checkpoint_e  [31/33] Processing Q#195 (toxicology, simple): What is the most common bond type?
2026-02-23 22:23:52,588  INFO      checkpoint_e    [Grounding] cell_matches=0, few_shot=8, schema_hints=1
2026-02-23 22:25:46,984  INFO      checkpoint_e    [Schema Linking] s1_fields=3, s2_fields=9
2026-02-23 22:25:46,986  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 22:26:14,728  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=3), errors=0
2026-02-23 22:26:14,850  INFO      checkpoint_e    [Oracle Pre-Fix] 11/11 candidates are correct
2026-02-23 22:26:14,957  INFO      checkpoint_e    [Oracle Post-Fix] 11/11 fixed candidates are correct
2026-02-23 22:26:14,957  INFO      checkpoint_e    [Fixing] needed_fix=0, fixed_ok=0, still_failing=0 | orig_success=11/11, post_success=11/11
2026-02-23 22:26:15,074  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=True, final_sql=SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT...
2026-02-23 22:26:15,081  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: SELECT bond_type FROM bond GROUP BY bond_type ORDER BY COUNT...
2026-02-23 22:26:15,093  INFO      checkpoint_e  [32/33] Processing Q#237 (toxicology, moderate): Which molecule does the atom TR001_10 belong to? Please state whether this molec
2026-02-23 22:26:18,639  INFO      checkpoint_e    [Grounding] cell_matches=4, few_shot=8, schema_hints=4
2026-02-23 22:27:57,919  INFO      checkpoint_e    [Schema Linking] s1_fields=4, s2_fields=9
2026-02-23 22:27:57,921  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 22:28:46,585  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=3), errors=0
2026-02-23 22:28:46,602  INFO      checkpoint_e    [Oracle Pre-Fix] 11/11 candidates are correct
2026-02-23 22:28:46,610  INFO      checkpoint_e    [Oracle Post-Fix] 11/11 fixed candidates are correct
2026-02-23 22:28:46,610  INFO      checkpoint_e    [Fixing] needed_fix=0, fixed_ok=0, still_failing=0 | orig_success=11/11, post_success=11/11
2026-02-23 22:28:46,615  INFO      checkpoint_e    [Selection] method=fast_path, clusters=1, oracle_match=True, final_sql=SELECT T1.molecule_id, IIF(T2.label = '+', 'YES', 'NO') FROM...
2026-02-23 22:28:46,615  INFO      checkpoint_e    -> CORRECT | oracle_pre=True oracle_post=True selector_match=True | final_sql: SELECT T1.molecule_id, IIF(T2.label = '+', 'YES', 'NO') FROM...
2026-02-23 22:28:46,617  INFO      checkpoint_e  [33/33] Processing Q#304 (toxicology, challenging): List all carcinogenic molecules and their elements.
2026-02-23 22:28:50,082  INFO      checkpoint_e    [Grounding] cell_matches=2, few_shot=8, schema_hints=2
2026-02-23 22:30:06,106  INFO      checkpoint_e    [Schema Linking] s1_fields=5, s2_fields=10
2026-02-23 22:30:06,111  INFO      checkpoint_e    [Schema Recall] table_recall: S1=50% S2=50% | col_recall: S1=100% S2=100%
2026-02-23 22:30:33,038  WARNING   src.generation.icl_generator  ICLGenerator icl_C2: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 22:30:33,696  WARNING   src.generation.standard_generator  StandardAndComplexGenerator complex_B2_s2: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 22:30:36,140  WARNING   src.generation.icl_generator  ICLGenerator icl_C1: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 22:30:49,967  WARNING   src.generation.standard_generator  StandardAndComplexGenerator complex_B2_s1: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 22:31:13,286  WARNING   src.generation.icl_generator  ICLGenerator icl_C3: response truncated at MAX_TOKENS (partial text discarded)
2026-02-23 22:31:13,379  INFO      checkpoint_e    [Generation] total=11 (reasoning=4, standard=2, complex=2, icl=0), errors=5
2026-02-23 22:31:15,681  INFO      checkpoint_e    [Oracle Pre-Fix] 1/11 candidates are correct
2026-02-23 22:31:27,449  INFO      checkpoint_e    [Oracle Post-Fix] 1/11 fixed candidates are correct
2026-02-23 22:31:27,450  INFO      checkpoint_e    [Fixing] needed_fix=5, fixed_ok=5, still_failing=0 | orig_success=6/11, post_success=11/11
2026-02-23 22:31:29,454  WARNING   src.selection.adaptive_selector  Pairwise comparison failed: Gemini candidate has no content (finish_reason=MALFORMED_FUNCTION_CALL); defaulting to A.
2026-02-23 22:31:29,460  INFO      checkpoint_e    [Selection] method=tournament, clusters=2, oracle_match=False, final_sql=SELECT T1.molecule_id, T2.element FROM molecule AS T1 INNER ...
2026-02-23 22:31:29,471  INFO      checkpoint_e    -> WRONG | oracle_pre=True oracle_post=True selector_match=False | final_sql: SELECT T1.molecule_id, T2.element FROM molecule AS T1 INNER ...

================================================================================
CHECKPOINT E — RESULTS SUMMARY (v3)
================================================================================
Total questions: 33
Correct: 18/33 (54.5%)
Elapsed time: 5399.1s (163.6s per question)

--- Accuracy by Difficulty ---
  simple      : 7/11 (63.6%)
  moderate    : 7/11 (63.6%)
  challenging : 4/11 (36.4%)

--- Accuracy by Database ---
  california_schools                 : 2/3 (66.7%)  [##.]
  card_games                         : 1/3 (33.3%)  [#..]
  codebase_community                 : 1/3 (33.3%)  [#..]
  debit_card_specializing            : 3/3 (100.0%)  [###]
  european_football_2                : 1/3 (33.3%)  [#..]
  financial                          : 0/3 (0.0%)  [...]
  formula_1                          : 3/3 (100.0%)  [###]
  student_club                       : 2/3 (66.7%)  [##.]
  superhero                          : 3/3 (100.0%)  [###]
  thrombosis_prediction              : 0/3 (0.0%)  [...]
  toxicology                         : 2/3 (66.7%)  [##.]

--- Oracle Performance ---
  Questions with gold SQL executable:   33/33
  Oracle (pre-fix, any correct cand):  23/33 (69.7%)
  Oracle (post-fix, any correct cand): 23/33 (69.7%)
  Selector precision (when oracle achievable): 18/23 (78.3%)

--- Query Fixer Performance ---
  Total candidates generated:       352
  Original success (pre-fix):       284/352 (80.7%)
  Post-fix success:                 333/352 (94.6%)
  Candidates needing fix:           68
  Successfully fixed:               49/68 (72.1%)
  Still failing after fix:          19/352

--- Schema Linker Recall ---
  Avg table recall  — S1: 51.7%  S2: 52.2%
  Avg column recall — S1: 74.8%  S2: 76.0%
  S1 complete (all gold tables+cols): 3/33
  S2 complete (all gold tables+cols): 3/33

--- Per-Question Summary ---
    #  DB                                       Q#  Diff           Ground   Schema   Gen   Fix   Sel  OracleP  OracleF  SelMatch  Correct
  ----------------------------------------------------------------------------------------------------------------------------------
    1  california_schools                       64  simple             OK       OK    OK    OK    OK        Y        Y         Y  YES
    2  california_schools                       23  moderate           OK      ERR    OK    OK    OK        Y        Y         Y  YES
    3  california_schools                       28  challenging        OK      ERR    OK    OK    OK        N        N         N  NO
    4  card_games                              463  simple             OK      ERR    OK    OK    OK        Y        Y         N  NO
    5  card_games                              427  moderate           OK       OK    OK    OK    OK        Y        Y         Y  YES
    6  card_games                              431  challenging        OK       OK    OK    OK    OK        Y        Y         N  NO
    7  codebase_community                      601  simple             OK       OK    OK    OK    OK        Y        Y         Y  YES
    8  codebase_community                      571  moderate           OK       OK   ERR   ERR   ERR        N        N         N  NO
    9  codebase_community                      586  challenging        OK       OK    OK    OK    OK        N        N         N  NO
   10  debit_card_specializing                1519  simple             OK       OK    OK    OK    OK        Y        Y         Y  YES
   11  debit_card_specializing                1474  moderate           OK       OK    OK    OK    OK        Y        Y         Y  YES
   12  debit_card_specializing                1526  challenging        OK       OK    OK    OK    OK        Y        Y         Y  YES
   13  european_football_2                    1027  simple             OK       OK    OK    OK    OK        N        N         N  NO
   14  european_football_2                    1025  moderate           OK       OK    OK    OK    OK        Y        Y         Y  YES
   15  european_football_2                    1031  challenging        OK       OK    OK    OK    OK        Y        Y         N  NO
   16  financial                               109  simple             OK       OK    OK    OK    OK        N        N         N  NO
   17  financial                               135  moderate           OK       OK    OK    OK    OK        N        N         N  NO
   18  financial                               149  challenging        OK      ERR    OK    OK    OK        N        N         N  NO
   19  formula_1                               953  simple             OK       OK    OK    OK    OK        Y        Y         Y  YES
   20  formula_1                               852  moderate           OK       OK    OK    OK    OK        Y        Y         Y  YES
   21  formula_1                               994  challenging        OK      ERR    OK    OK    OK        Y        Y         Y  YES
   22  student_club                           1349  simple             OK       OK    OK    OK    OK        Y        Y         Y  YES
   23  student_club                           1456  moderate           OK       OK    OK    OK    OK        N        N         N  NO
   24  student_club                           1464  challenging        OK       OK    OK    OK    OK        Y        Y         Y  YES
   25  superhero                               803  simple             OK       OK    OK    OK    OK        Y        Y         Y  YES
   26  superhero                               782  moderate           OK       OK    OK    OK    OK        Y        Y         Y  YES
   27  superhero                               773  challenging        OK      ERR    OK    OK    OK        Y        Y         Y  YES
   28  thrombosis_prediction                  1276  simple             OK       OK    OK    OK    OK        Y        Y         N  NO
   29  thrombosis_prediction                  1225  moderate           OK      ERR    OK    OK    OK        N        N         N  NO
   30  thrombosis_prediction                  1295  challenging        OK      ERR    OK    OK    OK        N        N         N  NO
   31  toxicology                              195  simple             OK       OK    OK    OK    OK        Y        Y         Y  YES
   32  toxicology                              237  moderate           OK       OK    OK    OK    OK        Y        Y         Y  YES
   33  toxicology                              304  challenging        OK       OK    OK    OK    OK        Y        Y         N  NO

--- Stage Failure Counts (wrong answers) ---
  schema_linking_timeout                  : 5
  generation_timeout                      : 1

Results saved to: /Users/mostafa/Documents/workplace/NL2SQL/checkpoint_E_review/checkpoint_e_results.json

Inspection report saved to: /Users/mostafa/Documents/workplace/NL2SQL/checkpoint_E_review/inspection_report.md
